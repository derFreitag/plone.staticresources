define("mockup-patterns-inlinevalidation",["jquery","pat-base"],function(e,t){"use strict";return t.extend({name:"inlinevalidation",trigger:".pat-inlinevalidation",parser:"mockup",render_error:function(t,n){var i=e("div.fieldErrorBox",t);""!==n?(t.addClass("error"),i.html(n)):(t.removeClass("error"),i.html(""))},append_url_path:function(e,t){var n,i,a=e.split(/\?/);for("/"!==(i=a[0])[i.length-1]&&(i+="/"),i+=t,n=1;n<a.length;n+=1)i+="?"+a[n];return i},queue:function(t,n){void 0===n&&(n=t,t="fx"),e(window).queue(t,n)},validate_archetypes_field:function(t){var n=e(t),i=n.closest(".field"),a=i.attr("data-uid"),o=i.attr("data-fieldname"),r=n.val();n.prop("multiple")&&null===r&&(r=e([]).serialize());var s,l=e.param({uid:a,fname:o,value:r},s=!0);i&&a&&o&&this.queue(e.proxy(function(t){e.ajax({type:"POST",url:e("base").attr("href")+"/at_validate_field?"+l,iframe:!1,success:e.proxy(function(e){this.render_error(i,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},validate_formlib_field:function(t){var n=e(t).closest(".field"),i=n.closest("form").clone(),a=n.attr("data-fieldname");i.find("input[type=file]").remove(),this.queue(e.proxy(function(t){i.ajaxSubmit({url:this.append_url_path(i.attr("action"),"@@formlib_validate_field"),data:{fname:a},iframe:!1,success:e.proxy(function(e){this.render_error(n,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},validate_z3cform_field:function(t){var n=e(t),i=n.closest(".field"),a=i.closest("form").clone(),o=n.closest("fieldset").attr("data-fieldset"),r=i.attr("data-fieldname");a.find("input[type=file]").remove(),r&&this.queue(e.proxy(function(t){a.ajaxSubmit({url:this.append_url_path(a.attr("action"),"@@z3cform_validate_field"),data:{fname:r,fset:o},iframe:!1,success:e.proxy(function(e){this.render_error(i,e.errmsg),t()},this),error:function(){t()},dataType:"json"})},this))},init:function(){this.$el.find('input[type="text"], input[type="password"], input[type="checkbox"], select, textarea').on("blur",e.proxy(function(e){"archetypes"===this.options.type?this.validate_archetypes_field(e.target):"z3c.form"===this.options.type?this.validate_z3cform_field(e.target):"formlib"===this.options.type&&this.validate_formlib_field(e.target)},this))}})}),function(e){define("resource-plone-app-jquerytools-js",["jquery"],function(){return function(){!function(e){function t(t,a){var o,r,s,l=this,c=t.add(l),d=e(window),u=e.tools.expose&&(a.mask||a.expose),h=Math.random().toString().slice(10);u&&("string"==typeof u&&(u={color:u}),u.closeOnClick=u.closeOnEsc=!1);var p=a.target||t.attr("rel");if(!(r=p?e(p):t).length)throw"Could not find Overlay: "+p;t&&-1==t.index(r)&&t.click(function(e){return l.load(e),e.preventDefault()}),e.extend(l,{load:function(t){if(l.isOpened())return l;var o=i[a.effect];if(!o)throw'Overlay: cannot find effect : "'+a.effect+'"';if(a.oneInstance&&e.each(n,function(){this.close(t)}),t=t||e.Event(),t.type="onBeforeLoad",c.trigger(t),t.isDefaultPrevented())return l;s=!0,u&&e(r).expose(u);var p=a.top,f=a.left,m=r.outerWidth(!0),g=r.outerHeight(!0);return"string"==typeof p&&(p="center"==p?Math.max((d.height()-g)/2,0):parseInt(p,10)/100*d.height()),"center"==f&&(f=Math.max((d.width()-m)/2,0)),o[0].call(l,{top:p,left:f},function(){s&&(t.type="onLoad",c.trigger(t))}),u&&a.closeOnClick&&e.mask.getMask().one("click",l.close),a.closeOnClick&&e(document).on("click."+h,function(t){e(t.target).parents(r).length||l.close(t)}),a.closeOnEsc&&e(document).on("keydown."+h,function(e){27==e.keyCode&&l.close(e)}),l},close:function(t){return l.isOpened()?(t=t||e.Event(),t.type="onBeforeClose",c.trigger(t),t.isDefaultPrevented()?void 0:(s=!1,i[a.effect][1].call(l,function(){t.type="onClose",c.trigger(t)}),e(document).off("click."+h+" keydown."+h),u&&e.mask.close(),l)):l},getOverlay:function(){return r},getTrigger:function(){return t},getClosers:function(){return o},isOpened:function(){return s},getConf:function(){return a}}),e.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(t,n){e.isFunction(a[n])&&e(l).on(n,a[n]),l[n]=function(t){return t&&e(l).on(n,t),l}}),(o=r.find(a.close||".close")).length||a.close||(o=e('<a class="close"></a>'),r.prepend(o)),o.click(function(e){l.close(e)}),a.load&&l.load()}e.tools=e.tools||{version:"@VERSION"},e.tools.overlay={addEffect:function(e,t,n){i[e]=[t,n]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!/msie/.test(navigator.userAgent.toLowerCase())||navigator.appVersion>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var n=[],i={};e.tools.overlay.addEffect("default",function(t,n){var i=this.getConf(),a=e(window);i.fixed||(t.top+=a.scrollTop(),t.left+=a.scrollLeft()),t.position=i.fixed?"fixed":"absolute",this.getOverlay().css(t).fadeIn(i.speed,n)},function(e){this.getOverlay().fadeOut(this.getConf().closeSpeed,e)}),e.fn.overlay=function(i){var a=this.data("overlay");return a||(e.isFunction(i)&&(i={onBeforeLoad:i}),i=e.extend(!0,{},e.tools.overlay.conf,i),this.each(function(){a=new t(e(this),i),n.push(a),e(this).data("overlay",a)}),i.api?a:this)}}(jQuery),function(e){function t(t,n){var i=e(n);return i.length<2?i:t.parent().find(n)}function n(n,a){var o=this,r=n.add(o),s=n.children(),l=0,c=a.vertical;if(i||(i=o),s.length>1&&(s=e(a.items,n)),a.size>1&&(a.circular=!1),e.extend(o,{getConf:function(){return a},getIndex:function(){return l},getSize:function(){return o.getItems().size()},getNaviButtons:function(){return p.add(f)},getRoot:function(){return n},getItemWrap:function(){return s},getItems:function(){return s.find(a.item).not("."+a.clonedClass)},move:function(e,t){return o.seekTo(l+e,t)},next:function(e){return o.move(a.size,e)},prev:function(e){return o.move(-a.size,e)},begin:function(e){return o.seekTo(0,e)},end:function(e){return o.seekTo(o.getSize()-1,e)},focus:function(){return i=o,o},addItem:function(t){return t=e(t),a.circular?(s.children().last().before(t),s.children().first().replaceWith(t.clone().addClass(a.clonedClass))):(s.append(t),f.removeClass("disabled")),r.trigger("onAddItem",[t]),o},seekTo:function(t,n,d){if(t.jquery||(t*=1),a.circular&&0===t&&-1==l&&0!==n)return o;if(!a.circular&&t<0||t>o.getSize()||t<-1)return o;var u=t;t.jquery?t=o.getItems().index(t):u=o.getItems().eq(t);var h=e.Event("onBeforeSeek");if(!d&&(r.trigger(h,[t,n]),h.isDefaultPrevented()||!u.length))return o;var p=c?{top:-u.position().top}:{left:-u.position().left};return l=t,i=o,void 0===n&&(n=a.speed),s.animate(p,n,a.easing,d||function(){r.trigger("onSeek",[t])}),o}}),e.each(["onBeforeSeek","onSeek","onAddItem"],function(t,n){e.isFunction(a[n])&&e(o).on(n,a[n]),o[n]=function(t){return t&&e(o).on(n,t),o}}),a.circular){var d=o.getItems().slice(-1).clone().prependTo(s),u=o.getItems().eq(1).clone().appendTo(s);d.add(u).addClass(a.clonedClass),o.onBeforeSeek(function(e,t,n){if(!e.isDefaultPrevented())return-1==t?(o.seekTo(d,n,function(){o.end(0)}),e.preventDefault()):void(t==o.getSize()&&o.seekTo(u,n,function(){o.begin(0)}))});var h=n.parents().add(n).filter(function(){if("none"===e(this).css("display"))return!0});h.length?(h.show(),o.seekTo(0,0,function(){}),h.hide()):o.seekTo(0,0,function(){})}var p=t(n,a.prev).click(function(e){e.stopPropagation(),o.prev()}),f=t(n,a.next).click(function(e){e.stopPropagation(),o.next()});if(a.circular||(o.onBeforeSeek(function(e,t){setTimeout(function(){e.isDefaultPrevented()||(p.toggleClass(a.disabledClass,t<=0),f.toggleClass(a.disabledClass,t>=o.getSize()-1))},1)}),a.initialIndex||p.addClass(a.disabledClass)),o.getSize()<2&&p.add(f).addClass(a.disabledClass),a.mousewheel&&e.fn.mousewheel&&n.mousewheel(function(e,t){if(a.mousewheel)return o.move(t<0?1:-1,a.wheelSpeed||50),!1}),a.touch){var m={};s[0].ontouchstart=function(e){var t=e.touches[0];m.x=t.clientX,m.y=t.clientY},s[0].ontouchmove=function(e){if(1==e.touches.length&&!s.is(":animated")){var t=e.touches[0],n=m.x-t.clientX,i=m.y-t.clientY;o[c&&i>0||!c&&n>0?"next":"prev"](),e.preventDefault()}}}a.keyboard&&e(document).on("keydown.scrollable",function(t){if(!(!a.keyboard||t.altKey||t.ctrlKey||t.metaKey||e(t.target).is(":input")||"static"!=a.keyboard&&i!=o)){var n=t.keyCode;return!c||38!=n&&40!=n?c||37!=n&&39!=n?void 0:(o.move(37==n?-1:1),t.preventDefault()):(o.move(38==n?-1:1),t.preventDefault())}}),a.initialIndex&&o.seekTo(a.initialIndex,0,function(){})}e.tools=e.tools||{version:"@VERSION"},e.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var i;e.fn.scrollable=function(t){var i=this.data("scrollable");return i||(t=e.extend({},e.tools.scrollable.conf,t),this.each(function(){i=new n(e(this),t),e(this).data("scrollable",i)}),t.api?i:this)}}(jQuery),function(e){function t(t,n,i){var o,r=this,s=t.add(this),l=t.find(i.tabs),c=n.jquery?n:t.children(n);l.length||(l=t.children()),c.length||(c=t.parent().find(n)),c.length||(c=e(n)),e.extend(this,{click:function(n,c){var d=l.eq(n),u=!t.data("tabs");if("string"==typeof n&&n.replace("#","")&&(d=l.filter('[href*="'+n.replace("#","")+'"]'),n=Math.max(l.index(d),0)),i.rotate){var h=l.length-1;if(n<0)return r.click(h,c);if(n>h)return r.click(0,c)}if(!d.length){if(o>=0)return r;n=i.initialIndex,d=l.eq(n)}if(n===o)return r;if(c=c||e.Event(),c.type="onBeforeClick",s.trigger(c,[n]),!c.isDefaultPrevented()){var p=u?i.initialEffect&&i.effect||"default":i.effect;return a[p].call(r,n,function(){o=n,c.type="onClick",s.trigger(c,[n])}),l.removeClass(i.current),d.addClass(i.current),r}},getConf:function(){return i},getTabs:function(){return l},getPanes:function(){return c},getCurrentPane:function(){return c.eq(o)},getCurrentTab:function(){return l.eq(o)},getIndex:function(){return o},next:function(){return r.click(o+1)},prev:function(){return r.click(o-1)},destroy:function(){return l.off(i.event).removeClass(i.current),c.find('a[href^="#"]').off("click.T"),r}}),e.each("onBeforeClick,onClick".split(","),function(t,n){e.isFunction(i[n])&&e(r).on(n,i[n]),r[n]=function(t){return t&&e(r).on(n,t),r}}),i.history&&e.fn.history&&(e.tools.history.init(l),i.event="history"),l.each(function(t){e(this).on(i.event,function(e){return r.click(t,e),e.preventDefault()})}),c.find('a[href^="#"]').on("click.T",function(t){r.click(e(this).attr("href"),t)}),location.hash&&"a"==i.tabs&&t.find('[href="'+location.hash+'"]').length?r.click(location.hash):(0===i.initialIndex||i.initialIndex>0)&&r.click(i.initialIndex)}e.tools=e.tools||{version:"@VERSION"},e.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialEffect:!1,initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(e,t){a[e]=t}};var n,i,a={default:function(e,t){this.getPanes().hide().eq(e).show(),t.call()},fade:function(e,t){var n=this.getConf(),i=n.fadeOutSpeed,a=this.getPanes();i?a.fadeOut(i):a.hide(),a.eq(e).fadeIn(n.fadeInSpeed,t)},slide:function(e,t){var n=this.getConf();this.getPanes().slideUp(n.slideUpSpeed),this.getPanes().eq(e).slideDown(n.slideDownSpeed,t)},ajax:function(e,t){this.getPanes().eq(0).load(this.getTabs().eq(e).attr("href"),t)}};e.tools.tabs.addEffect("horizontal",function(t,a){if(!n){var o=this.getPanes().eq(t),r=this.getCurrentPane();i||(i=this.getPanes().eq(0).width()),n=!0,o.show(),r.animate({width:0},{step:function(e){o.css("width",i-e)},complete:function(){e(this).hide(),a.call(),n=!1}}),r.length||(a.call(),n=!1)}}),e.fn.tabs=function(n,i){var a=this.data("tabs");return a&&(a.destroy(),this.removeData("tabs")),e.isFunction(i)&&(i={onBeforeClick:i}),i=e.extend({},e.tools.tabs.conf,i),this.each(function(){a=new t(e(this),n,i),e(this).data("tabs",a)}),i.api?a:this}}(jQuery),function(e){function t(e){if(e){var t=i.contentWindow.document;t.open().close(),t.location.hash=e}}var n,i,a,o;e.tools=e.tools||{version:"@VERSION"},e.tools.history={init:function(r){o||(e.browser.msie&&e.browser.version<"8"?i||(i=e("<iframe/>").attr("src","javascript:false;").hide().get(0),e("body").append(i),setInterval(function(){var t=i.contentWindow.document.location.hash;n!==t&&e(window).trigger("hash",t)},100),t(location.hash||"#")):setInterval(function(){var t=location.hash;t!==n&&e(window).trigger("hash",t)},100),a=a?a.add(r):r,r.click(function(n){var a=e(this).attr("href");if(i&&t(a),"#"!=a.slice(0,1))return location.href="#"+a,n.preventDefault()}),o=!0)}},e(window).on("hash",function(t,i){i?a.filter(function(){var t=e(this).attr("href");return t==i||t==i.replace("#","")}).trigger("history",[i]):a.eq(0).trigger("history",[i]),n=i}),e.fn.history=function(t){return e.tools.history.init(this),this.on("history",t)}}(jQuery),function(e){function t(){if(/msie/.test(navigator.userAgent.toLowerCase())){var t=e(document).height(),n=e(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t-n<20?n:t]}return[e(document).width(),e(document).height()]}function n(t){if(t)return t.call(e.mask)}e.tools=e.tools||{version:"@VERSION"};var i;i=e.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var a,o,r,s,l;e.mask={load:function(c,d){if(r)return this;"string"==typeof c&&(c={color:c}),c=c||s,s=c=e.extend(e.extend({},i.conf),c),(a=e("#"+c.maskId)).length||(a=e("<div/>").attr("id",c.maskId),e("body").append(a));var u=t();return a.css({position:"absolute",top:0,left:0,width:u[0],height:u[1],display:"none",opacity:c.startOpacity,zIndex:c.zIndex}),c.color&&a.css("backgroundColor",c.color),!1===n(c.onBeforeLoad)?this:(c.closeOnEsc&&e(document).on("keydown.mask",function(t){27==t.keyCode&&e.mask.close(t)}),c.closeOnClick&&a.on("click.mask",function(t){e.mask.close(t)}),e(window).on("resize.mask",function(){e.mask.fit()}),d&&d.length&&(l=d.eq(0).css("zIndex"),e.each(d,function(){var t=e(this);/relative|absolute|fixed/i.test(t.css("position"))||t.css("position","relative")}),o=d.css({zIndex:Math.max(c.zIndex+1,"auto"==l?0:l)})),a.css({display:"block"}).fadeTo(c.loadSpeed,c.opacity,function(){e.mask.fit(),n(c.onLoad),r="full"}),r=!0,this)},close:function(){if(r){if(!1===n(s.onBeforeClose))return this;a.fadeOut(s.closeSpeed,function(){o&&o.css({zIndex:l}),r=!1,n(s.onClose)}),e(document).off("keydown.mask"),a.off("click.mask"),e(window).off("resize.mask")}return this},fit:function(){if(r){var e=t();a.css({width:e[0],height:e[1]})}},getMask:function(){return a},isLoaded:function(e){return e?"full"==r:r},getConf:function(){return s},getExposed:function(){return o}},e.fn.mask=function(t){return e.mask.load(t),this},e.fn.expose=function(t){return e.mask.load(t,this),this}}(jQuery),function(e){function t(t,n,i){var a=i.relative?t.position().top:t.offset().top,o=i.relative?t.position().left:t.offset().left,r=i.position[0];a-=n.outerHeight()-i.offset[0],o+=t.outerWidth()+i.offset[1],/iPad/i.test(navigator.userAgent)&&(a-=e(window).scrollTop());var s=n.outerHeight()+t.outerHeight();"center"==r&&(a+=s/2),"bottom"==r&&(a+=s),r=i.position[1];var l=n.outerWidth()+t.outerWidth();return"center"==r&&(o-=l/2),"left"==r&&(o-=l),{top:a,left:o}}function n(n,a){var o,r,s=this,l=n.add(s),c=0,d=0,u=n.attr("title"),h=n.attr("data-tooltip"),p=i[a.effect],f=n.is(":input"),m=f&&n.is(":checkbox, :radio, select, :button, :submit"),g=n.attr("type"),v=a.events[g]||a.events[f?m?"widget":"input":"def"];if(!p)throw'Nonexistent effect "'+a.effect+'"';if(2!=(v=v.split(/,\s*/)).length)throw"Tooltip: bad events configuration for "+g;n.on(v[0],function(e){clearTimeout(c),a.predelay?d=setTimeout(function(){s.show(e)},a.predelay):s.show(e)}).on(v[1],function(e){clearTimeout(d),a.delay?c=setTimeout(function(){s.hide(e)},a.delay):s.hide(e)}),u&&a.cancelDefault&&(n.removeAttr("title"),n.data("title",u)),e.extend(s,{show:function(i){if(!o&&(h?o=e(h):a.tip?o=e(a.tip).eq(0):u?o=e(a.layout).addClass(a.tipClass).appendTo(document.body).hide().append(u):((o=n.find("."+a.tipClass)).length||(o=n.next()),o.length||(o=n.parent().next())),!o.length))throw"Cannot find tooltip for "+n;if(s.isShown())return s;o.stop(!0,!0);var f=t(n,o,a);if(a.tip&&o.html(n.data("title")),i=e.Event(),i.type="onBeforeShow",l.trigger(i,[f]),i.isDefaultPrevented())return s;f=t(n,o,a),o.css({position:"absolute",top:f.top,left:f.left}),r=!0,p[0].call(s,function(){i.type="onShow",r="full",l.trigger(i)});var m=a.events.tooltip.split(/,\s*/);return o.data("__set")||(o.off(m[0]).on(m[0],function(){clearTimeout(c),clearTimeout(d)}),m[1]&&!n.is("input:not(:checkbox, :radio), textarea")&&o.off(m[1]).on(m[1],function(e){e.relatedTarget!=n[0]&&n.trigger(v[1].split(" ")[0])}),a.tip||o.data("__set",!0)),s},hide:function(t){return o&&s.isShown()?(t=e.Event(),t.type="onBeforeHide",l.trigger(t),t.isDefaultPrevented()?void 0:(r=!1,i[a.effect][1].call(s,function(){t.type="onHide",l.trigger(t)}),s)):s},isShown:function(e){return e?"full"==r:r},getConf:function(){return a},getTip:function(){return o},getTrigger:function(){return n}}),e.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(t,n){e.isFunction(a[n])&&e(s).on(n,a[n]),s[n]=function(t){return t&&e(s).on(n,t),s}})}e.tools=e.tools||{version:"@VERSION"},e.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(e,t,n){i[e]=[t,n]}};var i={toggle:[function(e){var t=this.getConf(),n=this.getTip(),i=t.opacity;i<1&&n.css({opacity:i}),n.show(),e.call()},function(e){this.getTip().hide(),e.call()}],fade:[function(e){var t=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||t.fadeIE?this.getTip().fadeTo(t.fadeInSpeed,t.opacity,e):(this.getTip().show(),e())},function(e){var t=this.getConf();!/msie/.test(navigator.userAgent.toLowerCase())||t.fadeIE?this.getTip().fadeOut(t.fadeOutSpeed,e):(this.getTip().hide(),e())}]};e.fn.tooltip=function(t){var i=this.data("tooltip");return i||("string"==typeof(t=e.extend(!0,{},e.tools.tooltip.conf,t)).position&&(t.position=t.position.split(/,?\s/)),this.each(function(){i=new n(e(this),t),e(this).data("tooltip",i)}),t.api?i:this)}}(jQuery)}.apply(e,arguments)})}(this),function(e){define("resource-plone-app-jquerytools-dateinput-js",["jquery"],function(){return function(){!function(e,t){function n(e,t){return new Date(e,t+1,0).getDate()}function i(e,t){for(e=""+e,t=t||2;e.length<t;)e="0"+e;return e}function a(e,t,n,a){var o=t.getDate(),r=t.getDay(),s=t.getMonth(),l=t.getFullYear(),c={d:o,dd:i(o),ddd:p[a].shortDays[r],dddd:p[a].days[r],m:s+1,mm:i(s+1),mmm:p[a].shortMonths[s],mmmm:p[a].months[s],yy:String(l).slice(2),yyyy:l},d=u[e](n,t,c,a);return f.html(d).html()}function o(e){return parseInt(e,10)}function r(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()==t.getMonth()&&e.getDate()==t.getDate()}function s(e){if(e!==t){if(e.constructor==Date)return e;if("string"==typeof e){var n=e.split("-");if(3==n.length)return new Date(o(n[0]),o(n[1])-1,o(n[2]));if(!/^-?\d+$/.test(e))return;e=o(e)}var i=new Date;return i.setDate(i.getDate()+e),i}}function l(i,l){function c(t,n,o){return i.attr("readonly")?void x.hide(o):($=t,v=t.getFullYear(),y=t.getMonth(),b=t.getDate(),o||(o=e.Event("api")),"click"!=o.type||/msie/.test(navigator.userAgent.toLowerCase())||i.focus(),o.type="beforeChange",P.trigger(o,[t]),void(o.isDefaultPrevented()||(i.val(a(n.formatter,t,n.format,n.lang)),o.type="change",o.target=i[0],P.trigger(o),i.data("date",t),x.hide(o))))}function u(t){t.type="onShow",P.trigger(t),e(document).on("keydown.d",function(t){if(t.ctrlKey)return!0;var n=t.keyCode;if(8==n||46==n)return i.val(""),x.hide(t);if(27==n||9==n)return x.hide(t);if(e(h).index(n)>=0){if(!w)return x.show(t),t.preventDefault();var a=e("#"+C.weeks+" a"),o=e("."+C.focus),r=a.index(o);return o.removeClass(C.focus),74==n||40==n?r+=7:75==n||38==n?r-=7:76==n||39==n?r+=1:(72==n||37==n)&&(r-=1),r>41?(x.addMonth(),o=e("#"+C.weeks+" a:eq("+(r-42)+")")):0>r?(x.addMonth(-1),o=e("#"+C.weeks+" a:eq("+(r+42)+")")):o=a.eq(r),o.addClass(C.focus),t.preventDefault()}return 34==n?x.addMonth():33==n?x.addMonth(-1):36==n?x.today():(13==n&&(e(t.target).is("select")||e("."+C.focus).click()),e([16,17,18,9]).index(n)>=0)}),e(document).on("click.d",function(t){var n=t.target;n.id==C.root||e(n).parents("#"+C.root).length||n==i[0]||f&&n==f[0]||x.hide(t)})}var f,m,g,v,y,b,w,k,x=this,T=new Date,S=T.getFullYear(),C=l.css,E=p[l.lang],D=e("#"+C.root),O=D.find("#"+C.title),$=i.attr("data-value")||l.value||i.val(),A=i.attr("min")||l.min,I=i.attr("max")||l.max;if(0===A&&(A="0"),$=s($)||T,A=s(A||new Date(S+l.yearRange[0],1,1)),I=s(I||new Date(S+l.yearRange[1]+1,1,-1)),!E)throw"Dateinput: invalid language: "+l.lang;if("date"==i.attr("type")){var M=(k=i.clone()).wrap("<div/>").parent().html(),R=e(M.replace(/type/i,"type=text data-orig-type"));l.value&&R.val(l.value),i.replaceWith(R),i=R}i.addClass(C.input);var P=i.add(x);if(!D.length){if((D=e("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",C.root)).children().eq(0).attr("id",C.head).end().eq(1).attr("id",C.body).children().eq(0).attr("id",C.days).end().eq(1).attr("id",C.weeks).end().end().end().find("a").eq(0).attr("id",C.prev).end().eq(1).attr("id",C.next),O=D.find("#"+C.head).find("div").attr("id",C.title),l.selectors){var N=e("<select/>").attr("id",C.month),j=e("<select/>").attr("id",C.year);O.html(N.add(j))}for(var _=D.find("#"+C.days),F=0;7>F;F++)_.append(e("<span/>").text(E.shortDays[(F+l.firstDay)%7]));e("body").append(D)}l.trigger&&(f=e("<a/>").attr("href","#").addClass(C.trigger).click(function(e){return l.toggle?x.toggle():x.show(),e.preventDefault()}).insertAfter(i));var U=D.find("#"+C.weeks);j=D.find("#"+C.year),N=D.find("#"+C.month),e.extend(x,{show:function(t){if(!i.attr("disabled")&&!w&&(t=t||e.Event(),t.type="onBeforeShow",P.trigger(t),!t.isDefaultPrevented())){e.each(d,function(){this.hide()}),w=!0,N.off("change").change(function(){x.setValue(o(j.val()),o(e(this).val()))}),j.off("change").change(function(){x.setValue(o(e(this).val()),o(N.val()))}),m=D.find("#"+C.prev).off("click").click(function(){return m.hasClass(C.disabled)||x.addMonth(-1),!1}),g=D.find("#"+C.next).off("click").click(function(){return g.hasClass(C.disabled)||x.addMonth(),!1}),x.setValue($);var n=i.offset();return/iPad/i.test(navigator.userAgent)&&(n.top-=e(window).scrollTop()),D.css({top:n.top+i.outerHeight(!0)+l.offset[0],left:n.left+l.offset[1]}),l.speed?D.show(l.speed,function(){u(t)}):(D.show(),u(t)),x}},setValue:function(i,a,d){var u=o(a)>=-1?new Date(o(i),o(a),o(d==t||isNaN(d)?1:d)):i||$;if(A>u?u=A:u>I&&(u=I),"string"==typeof i&&(u=s(i)),i=u.getFullYear(),a=u.getMonth(),d=u.getDate(),-1==a?(a=11,i--):12==a&&(a=0,i++),!w)return c(u,l),x;y=a,v=i,b=d;var h,p=new Date(i,a,1-l.firstDay).getDay(),f=n(i,a),k=n(i,a-1);if(l.selectors){N.empty(),e.each(E.months,function(t,n){A<new Date(i,t+1,1)&&I>new Date(i,t,0)&&N.append(e("<option/>").html(n).attr("value",t))}),j.empty();for(var S=T.getFullYear(),D=S+l.yearRange[0];D<S+l.yearRange[1];D++)A<new Date(D+1,0,1)&&I>new Date(D,0,0)&&j.append(e("<option/>").text(D));N.val(a),j.val(i)}else O.html(E.months[a]+" "+i);U.empty(),m.add(g).removeClass(C.disabled);for(var M,R,P=p?0:-7;(p?42:35)>P;P++)M=e("<a/>"),P%7==0&&(h=e("<div/>").addClass(C.week),U.append(h)),p>P?(M.addClass(C.off),R=k-p+P+1,u=new Date(i,a-1,R)):P>=p+f?(M.addClass(C.off),R=P-f-p+1,u=new Date(i,a+1,R)):(R=P-p+1,u=new Date(i,a,R),r($,u)?M.attr("id",C.current).addClass(C.focus):r(T,u)&&M.attr("id",C.today)),A&&A>u&&M.add(m).addClass(C.disabled),I&&u>I&&M.add(g).addClass(C.disabled),M.attr("href","#"+R).text(R).data("date",u),h.append(M);return U.find("a").click(function(t){var n=e(this);return n.hasClass(C.disabled)||(e("#"+C.current).removeAttr("id"),n.attr("id",C.current),c(n.data("date"),l,t)),!1}),C.sunday&&U.find("."+C.week).each(function(){var t=l.firstDay?7-l.firstDay:0;e(this).children().slice(t,t+1).addClass(C.sunday)}),x},setMin:function(e,t){return A=s(e),t&&A>$&&x.setValue(A),x},setMax:function(e,t){return I=s(e),t&&$>I&&x.setValue(I),x},today:function(){return x.setValue(T)},addDay:function(e){return this.setValue(v,y,b+(e||1))},addMonth:function(e){var t=y+(e||1),i=n(v,t),a=i>=b?b:i;return this.setValue(v,t,a)},addYear:function(e){return this.setValue(v+(e||1),y,b)},destroy:function(){i.add(document).off("click.d keydown.d"),D.add(f).remove(),i.removeData("dateinput").removeClass(C.input),k&&i.replaceWith(k)},hide:function(t){if(w){if(t=e.Event(),t.type="onHide",P.trigger(t),t.isDefaultPrevented())return;e(document).off("click.d keydown.d"),D.hide(),w=!1}return x},toggle:function(){return x.isOpen()?x.hide():x.show()},getConf:function(){return l},getInput:function(){return i},getCalendar:function(){return D},getValue:function(e){return e?a(l.formatter,$,e,l.lang):$},isOpen:function(){return w}}),e.each(["onBeforeShow","onShow","change","onHide"],function(t,n){e.isFunction(l[n])&&e(x).on(n,l[n]),x[n]=function(t){return t&&e(x).on(n,t),x}}),l.editable||i.on("focus.d click.d",x.show).keydown(function(t){var n=t.keyCode;return!w&&e(h).index(n)>=0?(x.show(t),t.preventDefault()):((8==n||46==n)&&i.val(""),!!(t.shiftKey||t.ctrlKey||t.altKey||9==n)||t.preventDefault())}),s(i.val())&&c($,l)}e.tools=e.tools||{version:"@VERSION"};var c,d=[],u={},h=[75,76,38,39,74,72,40,37],p={};(c=e.tools.dateinput={conf:{format:"mm/dd/yy",formatter:"default",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:t,max:t,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},addFormatter:function(e,t){u[e]=t},localize:function(t,n){e.each(n,function(e,t){n[e]=t.split(",")}),p[t]=n}}).localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var f=e("<a/>");c.addFormatter("default",function(e,t,n){return e.replace(/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,function(e){return e in n?n[e]:e})}),c.addFormatter("prefixed",function(e,t,n){return e.replace(/%(d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*')/g,function(e,t){return t in n?n[t]:e})}),e.expr[":"].date=function(t){var n=t.getAttribute("type");return n&&"date"==n||!!e(t).data("dateinput")},e.fn.dateinput=function(t){if(this.data("dateinput"))return this;t=e.extend(!0,{},c.conf,t),e.each(t.css,function(e,n){n||"prefix"==e||(t.css[e]=(t.css.prefix||"")+(n||e))});var n;return this.each(function(){var i=new l(e(this),t);d.push(i);var a=i.getInput().data("dateinput",i);n=n?n.add(a):a}),n||this}}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery.tmpl",["jquery"],function(){return function(){!function(e,t){function n(t,n,i,a){var o={data:a||(n?n.data:{}),_wrap:n?n._wrap:null,tmpl:null,parent:n||null,nodes:[],calls:d,nest:u,wrap:h,html:p,update:f};return t&&e.extend(o,t,{nodes:[],parent:n}),i&&(o.tmpl=i,o._ctnt=o._ctnt||o.tmpl(e,o),o.key=++x,(S.length?w:b)[x]=o),o}function i(t,n,o){var r,s=o?e.map(o,function(e){return"string"==typeof e?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+v+'="'+t.key+'" $2'):e:i(e,t,e._ctnt)}):t;return n?s:((s=s.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,n,i,o){c(r=e(i).get()),n&&(r=a(n).concat(r)),o&&(r=r.concat(a(o)))}),r||a(s))}function a(t){var n=document.createElement("div");return n.innerHTML=t,e.makeArray(n.childNodes)}function o(t){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+e.trim(t).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,n,i,a,o,r,l){var c,d,u,h=e.tmpl.tag[i];if(!h)throw"Template command not found: "+i;return c=h._default||[],r&&!/\w$/.test(o)&&(o+=r,r=""),o?(o=s(o),l=l?","+s(l)+")":r?")":"",d=r?o.indexOf(".")>-1?o+r:"("+o+").call($item"+l:o,u=r?d:"(typeof("+o+")==='function'?("+o+").call($item):("+o+"))"):u=d=c.$1||"null",a=s(a),"');"+h[n?"close":"open"].split("$notnull_1").join(o?"typeof("+o+")!=='undefined' && ("+o+")!=null":"true").split("$1a").join(u).split("$1").join(d).split("$2").join(a?a.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(e,t,n,i){return(i=i?","+i+")":n?")":"")?"("+t+").call($item"+i:e}):c.$2||"")+"_.push('"})+"');}return _;")}function r(t,n){t._wrap=i(t,!0,e.isArray(n)?n:[y.test(n)?n:e(n).html()]).join("")}function s(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function l(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function c(t){function i(t){function i(e){r=d[e+=c]=d[e]||n(r,b[r.parent.key+c]||r.parent,null,!0)}var a,o,r,s,l=t;if(s=t.getAttribute(v)){for(;l.parentNode&&1===(l=l.parentNode).nodeType&&!(a=l.getAttribute(v)););a!==s&&(l=l.parentNode?11===l.nodeType?0:l.getAttribute(v)||0:0,(r=b[s])||(r=w[s],(r=n(r,b[l]||w[l],null,!0)).key=++x,b[x]=r),T&&i(s)),t.removeAttribute(v)}else T&&(r=e.data(t,"tmplItem"))&&(i(r.key),b[r.key]=r,l=(l=e.data(t.parentNode,"tmplItem"))?l.key:0);if(r){for(o=r;o&&o.key!=l;)o.nodes.push(t),o=o.parent;delete r._ctnt,delete r._wrap,e.data(t,"tmplItem",r)}}var a,o,r,s,l,c="_"+T,d={};for(r=0,s=t.length;r<s;r++)if(1===(a=t[r]).nodeType){for(l=(o=a.getElementsByTagName("*")).length-1;l>=0;l--)i(o[l]);i(a)}}function d(e,t,n,i){if(!e)return S.pop();S.push({_:e,tmpl:t,item:this,data:n,options:i})}function u(t,n,i){return e.tmpl(e.template(t),n,i,this)}function h(t,n){var i=t.options||{};return i.wrapped=n,e.tmpl(e.template(t.tmpl),t.data,i,t.item)}function p(t,n){var i=this._wrap;return e.map(e(e.isArray(i)?i.join(""):i).filter(t||"*"),function(e){return n?e.innerText||e.textContent:e.outerHTML||l(e)})}function f(){var t=this.nodes;e.tmpl(null,null,null,this).insertBefore(t[0]),e(t).remove()}var m,g=e.fn.domManip,v="_tmplitem",y=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,b={},w={},k={key:0,data:{}},x=0,T=0,S=[];e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,n){e.fn[t]=function(i){var a,o,r,s,l=[],c=e(i),d=1===this.length&&this[0].parentNode;if(m=b||{},d&&11===d.nodeType&&1===d.childNodes.length&&1===c.length)c[n](this[0]),l=this;else{for(o=0,r=c.length;o<r;o++)T=o,a=(o>0?this.clone(!0):this).get(),e.fn[n].apply(e(c[o]),a),l=l.concat(a);T=0,l=this.pushStack(l,t,c.selector)}return s=m,m=null,e.tmpl.complete(s),l}}),e.fn.extend({tmpl:function(t,n,i){return e.tmpl(this[0],t,n,i)},tmplItem:function(){return e.tmplItem(this[0])},template:function(t){return e.template(t,this[0])},domManip:function(t,n,i,a){if(t[0]&&t[0].nodeType){for(var o,r=e.makeArray(arguments),s=t.length,l=0;l<s&&!(o=e.data(t[l++],"tmplItem")););s>1&&(r[0]=[e.makeArray(t)]),o&&T&&(r[2]=function(t){e.tmpl.afterManip(this,t,i)}),g.apply(this,r)}else g.apply(this,arguments);return T=0,m||e.tmpl.complete(b),this}}),e.extend({tmpl:function(t,a,o,s){var l,c=!s;if(c)s=k,t=e.template[t]||e.template(null,t),w={};else if(!t)return t=s.tmpl,b[s.key]=s,s.nodes=[],s.wrapped&&r(s,s.wrapped),e(i(s,null,s.tmpl(e,s)));return t?("function"==typeof a&&(a=a.call(s||{})),o&&o.wrapped&&r(o,o.wrapped),l=e.isArray(a)?e.map(a,function(e){return e?n(o,s,t,e):null}):[n(o,s,t,a)],c?e(i(s,null,l)):l):[]},tmplItem:function(t){var n;for(t instanceof e&&(t=t[0]);t&&1===t.nodeType&&!(n=e.data(t,"tmplItem"))&&(t=t.parentNode););return n||k},template:function(t,n){return n?("string"==typeof n?n=o(n):n instanceof e&&(n=n[0]||{}),n.nodeType&&(n=e.data(n,"tmpl")||e.data(n,"tmpl",o(n.innerHTML))),"string"==typeof t?e.template[t]=n:n):t?"string"!=typeof t?e.template(null,t):e.template[t]||e.template(null,y.test(t)?t:e(t)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),e.extend(e.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(e){b={}},afterManip:function(t,n,i){var a=11===n.nodeType?e.makeArray(n.childNodes):1===n.nodeType?[n]:[];i.call(t,n),c(a),T++}})}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery.recurrenceinput",["jquery","resource-plone-app-jquerytools-js","resource-plone-app-jquerytools-dateinput-js","jquery.tmpl"],function(){return function(){!function(e){function t(e,t){for(e=e.toString(),t=t||2;e.length<t;)e="0"+e;return e}function n(e,n,i){var a=e.getDate(),o=e.getDay(),r=e.getMonth(),s=e.getFullYear(),l={d:a,dd:t(a),ddd:i.i18n.shortWeekdays[o],dddd:i.i18n.weekdays[o],m:r+1,mm:t(r+1),mmm:i.i18n.shortMonths[r],mmmm:i.i18n.months[r],yy:String(s).slice(2),yyyy:s};return n.replace(f,function(e){return l.hasOwnProperty(e)?l[e]:e.slice(1,e.length-1)})}function i(t,i,a){var o,r,s,l,c,d,u,h,p,f,m,g,v=t.find("select[name=rirtemplate]").val(),y=i.rtemplate[v],b=y.rrule,w=i.i18n.rtemplate[v];for(l=0;l<y.fields.length;l++)switch((o=t.find("#"+y.fields[l])).attr("id")){case"ridailyinterval":"1"!==(m=o.find("input[name=ridailyinterval]").val())&&(b+=";INTERVAL="+m),w=m+" "+i.i18n.dailyInterval2;break;case"riweeklyinterval":"1"!==(m=o.find("input[name=riweeklyinterval]").val())&&(b+=";INTERVAL="+m),w=m+" "+i.i18n.weeklyInterval2;break;case"riweeklyweekdays":for(r="",s="",c=0;c<i.weekdays.length;c++)o.find("input[name=riweeklyweekdays"+i.weekdays[c]+"]").is(":checked")&&(r&&(r+=",",s+=", "),r+=i.weekdays[c],s+=i.i18n.weekdays[c]);r&&(b+=";BYDAY="+r,w+=" "+i.i18n.weeklyWeekdaysHuman+" "+s);break;case"rimonthlyinterval":"1"!==(m=o.find("input[name=rimonthlyinterval]").val())&&(b+=";INTERVAL="+m),w=m+" "+i.i18n.monthlyInterval2;break;case"rimonthlyoptions":switch(e("input[name=rimonthlytype]:checked",t).val()){case"DAYOFMONTH":b+=";BYMONTHDAY="+(h=e("select[name=rimonthlydayofmonthday]",t).val()),w+=", "+i.i18n.monthlyDayOfMonth1Human+" "+h+" "+i.i18n.monthlyDayOfMonth2;break;case"WEEKDAYOFMONTH":d=e("select[name=rimonthlyweekdayofmonthindex]",t).val(),h=e("select[name=rimonthlyweekdayofmonth]",t).val(),e.inArray(h,["MO","TU","WE","TH","FR","SA","SU"])>-1&&(b+=";BYDAY="+d+h,w+=", "+i.i18n.monthlyWeekdayOfMonth1Human+" ",w+=" "+i.i18n.orderIndexes[e.inArray(d,i.orderIndexes)],w+=" "+i.i18n.monthlyWeekdayOfMonth2,w+=" "+i.i18n.weekdays[e.inArray(h,i.weekdays)],w+=" "+i.i18n.monthlyDayOfMonth2)}break;case"riyearlyinterval":"1"!==(m=o.find("input[name=riyearlyinterval]").val())&&(b+=";INTERVAL="+m),w=m+" "+i.i18n.yearlyInterval2;break;case"riyearlyoptions":switch(e("input[name=riyearlyType]:checked",t).val()){case"DAYOFMONTH":b+=";BYMONTH="+(p=e("select[name=riyearlydayofmonthmonth]",t).val()),b+=";BYMONTHDAY="+(h=e("select[name=riyearlydayofmonthday]",t).val()),w+=", "+i.i18n.yearlyDayOfMonth1Human+" "+i.i18n.months[p-1]+" "+h;break;case"WEEKDAYOFMONTH":d=e("select[name=riyearlyweekdayofmonthindex]",t).val(),h=e("select[name=riyearlyweekdayofmonthday]",t).val(),b+=";BYMONTH="+(p=e("select[name=riyearlyweekdayofmonthmonth]",t).val()),e.inArray(h,["MO","TU","WE","TH","FR","SA","SU"])>-1&&(b+=";BYDAY="+d+h,w+=", "+i.i18n.yearlyWeekdayOfMonth1Human,w+=" "+i.i18n.orderIndexes[e.inArray(d,i.orderIndexes)],w+=" "+i.i18n.yearlyWeekdayOfMonth2,w+=" "+i.i18n.weekdays[e.inArray(h,i.weekdays)],w+=" "+i.i18n.yearlyWeekdayOfMonth3,w+=" "+i.i18n.months[p-1],w+=" "+i.i18n.yearlyWeekdayOfMonth4)}break;case"rirangeoptions":switch(t.find("input[name=rirangetype]:checked").val()){case"BYOCCURRENCES":b+=";COUNT="+(g=t.find("input[name=rirangebyoccurrencesvalue]").val()),w+=", "+i.i18n.rangeByOccurrences1Human,w+=" "+g,w+=" "+i.i18n.rangeByOccurrences2;break;case"BYENDDATE":b+=";UNTIL="+(o=t.find("input[name=rirangebyenddatecalendar]")).data("dateinput").getValue("yyyymmdd")+"T000000",!0===a&&(b+="Z"),w+=", "+i.i18n.rangeByEndDateHuman,w+=" "+o.data("dateinput").getValue(i.i18n.longDateFormat)}}if(void 0!==t.ical.RDATE&&t.ical.RDATE.length>0){for(t.ical.RDATE.sort(),u=[],l=0;l<t.ical.RDATE.length;l++)""!==t.ical.RDATE[l]&&(f=parseInt(t.ical.RDATE[l].substring(0,4),10),p=parseInt(t.ical.RDATE[l].substring(4,6),10)-1,h=parseInt(t.ical.RDATE[l].substring(6,8),10),u.push(n(new Date(f,p,h),i.i18n.longDateFormat,i)));0!==u.length&&(w=w+i.i18n.including+" "+u.join("; "))}if(void 0!==t.ical.EXDATE&&t.ical.EXDATE.length>0){for(t.ical.EXDATE.sort(),u=[],l=0;l<t.ical.EXDATE.length;l++)""!==t.ical.EXDATE[l]&&(f=parseInt(t.ical.EXDATE[l].substring(0,4),10),p=parseInt(t.ical.EXDATE[l].substring(4,6),10)-1,h=parseInt(t.ical.EXDATE[l].substring(6,8),10),u.push(n(new Date(f,p,h),i.i18n.longDateFormat,i)));0!==u.length&&(w=w+i.i18n.except+" "+u.join("; "))}return b="RRULE:"+b,void 0!==t.ical.EXDATE&&""!==t.ical.EXDATE.join()&&(b=b+"\nEXDATE:"+(u=e.map(t.ical.EXDATE,function(e){return 8===e.length&&(e+="T000000"),!0===a&&(e+="Z"),e}))),void 0!==t.ical.RDATE&&""!==t.ical.RDATE.join()&&(b=b+"\nRDATE:"+(u=e.map(t.ical.RDATE,function(e){return 8===e.length&&(e+="T000000"),!0===a&&(e+="Z"),e}))),{result:b,description:w}}function a(e){var t={},n=e.indexOf(":"),i=e.substring(0,n);return t.value=e.substring(n+1),-1!==i.indexOf(";")?(n=i.indexOf(";"),t.parameters=i.substring(n+1),t.property=i.substring(0,n)):(t.parameters=null,t.property=i),t}function o(e){var t,n=[],i=e.split(",");for(t in i)i.hasOwnProperty(t)&&(-1!==i[t].indexOf("Z")?n.push(i[t].substring(0,15)):n.push(i[t]));return n}function r(e){var t,n=[],i={},r=null;for((n=e.split("\n")).reverse();;){if(n.length>0){if(" "===(t=n.pop()).charAt(0)||"\t"===t.charAt(0)){r+=t;continue}}else t="";if(null!==r&&("RDATE"===(r=a(r)).property||"EXDATE"===r.property?i[r.property]=o(r.value):i[r.property]=r.value),""===(r=t))break}return i}function s(t,n,i,a){var o,s,l,c,d,u,h,p,f,m,g,v,y,b,w,k,x,T,S,C,E,D=[];if(t.ical=r(i),void 0===t.ical.RRULE){if(D.push(n.i18n.noRule),!a)return-1}else{v=(s=/INTERVAL=([0-9]+);?/.exec(t.ical.RRULE))?s[1]:"1",y=(s=/BYDAY=([^;]+);?/.exec(t.ical.RRULE))?s[1]:"",w=(s=/BYMONTHDAY=([^;]+);?/.exec(t.ical.RRULE))?s[1].split(","):null,b=(s=/BYMONTH=([^;]+);?/.exec(t.ical.RRULE))?s[1].split(","):null,k=(s=/COUNT=([0-9]+);?/.exec(t.ical.RRULE))?s[1]:null,x=(s=/UNTIL=([0-9T]+);?/.exec(t.ical.RRULE))?s[1]:null,(s=/BYSETPOS=([^;]+);?/.exec(t.ical.RRULE))&&D.push(n.i18n.bysetpos),l="",c=null;for(o in n.rtemplate)n.rtemplate.hasOwnProperty(o)&&(d=n.rtemplate[o],0===t.ical.RRULE.indexOf(d.rrule)&&t.ical.RRULE.length>l.length&&(l=t.ical.RRULE,c=o));if(l)d=n.rtemplate[c],t.find("select[name=rirtemplate]").val(c);else{for(d in n.rtemplate)if(n.rtemplate.hasOwnProperty(d)){d=n.rtemplate[d];break}D.push(n.i18n.noTemplateMatch)}for(o=0;o<d.fields.length;o++)switch((m=t.find("#"+d.fields[o])).attr("id")){case"ridailyinterval":m.find("input[name=ridailyinterval]").val(v);break;case"riweeklyinterval":m.find("input[name=riweeklyinterval]").val(v);break;case"riweeklyweekdays":for(y=y.split(","),u=0;u<n.weekdays.length;u++)T=n.weekdays[u],(h=m.find("input[name=riweeklyweekdays"+T+"]")).attr("checked",-1!==e.inArray(T,y));break;case"rimonthlyinterval":m.find("input[name=rimonthlyinterval]").val(v);break;case"rimonthlyoptions":var O="DAYOFMONTH";for(w&&(O="DAYOFMONTH",w.length>1&&(D.push(n.i18n.multipleDayOfMonth),w=w[0]),m.find("select[name=rimonthlydayofmonthday]").val(w)),y&&(O="WEEKDAYOFMONTH",-1!==y.indexOf(",")&&(D.push(n.i18n.multipleDayOfMonth),y=y.split(",")[0]),"+"!==(p=y.slice(0,-2)).charAt(0)&&"-"!==p.charAt(0)&&(p="+"+p),E=y.slice(-2),m.find("select[name=rimonthlyweekdayofmonthindex]").val(p),m.find("select[name=rimonthlyweekdayofmonth]").val(E)),f=m.find("input[name=rimonthlytype]"),p=0;p<f.length;p++)g=f[p],e(g).attr("checked",g.value===O);break;case"riyearlyinterval":m.find("input[name=riyearlyinterval]").val(v);break;case"riyearlyoptions":var $="DAYOFMONTH";for(w&&($="DAYOFMONTH",w.length>1&&(D.push(n.i18n.multipleDayOfMonth),w=w[0]),m.find("select[name=riyearlydayofmonthmonth]").val(b),m.find("select[name=riyearlydayofmonthday]").val(w)),y&&($="WEEKDAYOFMONTH",-1!==y.indexOf(",")&&(D.push(n.i18n.multipleDayOfMonth),y=y.split(",")[0]),"+"!==(p=y.slice(0,-2)).charAt(0)&&"-"!==p.charAt(0)&&(p="+"+p),E=y.slice(-2),m.find("select[name=riyearlyweekdayofmonthindex]").val(p),m.find("select[name=riyearlyweekdayofmonthday]").val(E),m.find("select[name=riyearlyweekdayofmonthmonth]").val(b)),f=m.find("input[name=riyearlyType]"),p=0;p<f.length;p++)g=f[p],e(g).attr("checked",g.value===$);break;case"rirangeoptions":var A="NOENDDATE";for(k&&(A="BYOCCURRENCES",m.find("input[name=rirangebyoccurrencesvalue]").val(k)),x&&(A="BYENDDATE",h=m.find("input[name=rirangebyenddatecalendar]"),C=x.slice(0,4),S=x.slice(4,6),S=parseInt(S,10)-1,T=x.slice(6,8),h.data("dateinput").setValue(new Date(C,S,T))),f=m.find("input[name=rirangetype]"),p=0;p<f.length;p++)g=f[p],e(g).attr("checked",g.value===A)}}var I=t.find("#messagearea");return 0!==D.length?(I.text(n.i18n.unsupportedFeatures+" "+D.join("; ")),I.show(),1):(I.text(""),I.hide(),0)}function l(t,a){function o(e){var n;x.find(".rifield").hide();var i=e.val();if(i){var a=t.rtemplate[i];for(n=0;n<a.fields.length;n++)x.find("#"+a.fields[n]).show()}}function r(t){t.preventDefault(),void 0===x.ical.EXDATE&&(x.ical.EXDATE=[]),x.ical.EXDATE.push(this.attributes.date.value);var n=e(this);n.attr("class","exdate"),n.parent().parent().addClass("exdate"),n.unbind(t),n.click(l)}function l(t){t.preventDefault(),x.ical.EXDATE.splice(e.inArray(this.attributes.date.value,x.ical.EXDATE),1);var n=e(this);n.attr("class","rrule"),n.parent().parent().removeClass("exdate"),n.unbind(t),n.click(r)}function c(t){t.preventDefault(),x.ical.RDATE.splice(e.inArray(this.attributes.date.value,x.ical.RDATE),1),e(this).parent().parent().hide("slow",function(){e(this).remove()})}function u(i,a,o,s){var d;(d=(s?T:x).find(".rioccurrences")).hide();var h,p,f,m={year:h=i.getFullYear(),month:p=i.getMonth()+1,day:f=i.getDate(),rrule:a,format:t.i18n.longDateFormat,start:o},g={url:t.ajaxURL,async:!1,type:"post",dataType:"json",contentType:t.ajaxContentType,cache:!1,data:m,success:function(o,h,p){var f,m;m=s?T:x,o.readOnly=s,o.i18n=t.i18n;var g,v,y,b,w,k;for(k in o.occurrences)o.occurrences.hasOwnProperty(k)&&(v=(g=o.occurrences[k]).date,y=parseInt(v.substring(0,4),10),b=parseInt(v.substring(4,6),10)-1,w=parseInt(v.substring(6,8),10),g.formattedDate=n(new Date(y,b,w),t.i18n.longDateFormat,t));f=e.tmpl("occurrenceTmpl",o),(d=m.find(".rioccurrences")).replaceWith(f),m.find(".rioccurrences .batching a").click(function(e){e.preventDefault(),u(i,a,this.attributes.start.value,s)}),s||(m.find(".rioccurrences .action a.rrule").click(r),m.find(".rioccurrences .action a.exdate").click(l),m.find(".rioccurrences .action a.rdate").click(c)),m.find(".rioccurrences").show()},error:function(e,t,n){alert(t)}};e.ajax(g)}function h(t){var n=e(t);return n.length||(n=e("#"+t)),n.length||(n=e("input[name='"+t+"']")),n}function p(){var e,n,i,a,o=null;if(t.startField){if(!(e=h(t.startField)).length)return null;(o=e.data("dateinput"))?o=o.getValue():""===(o=e.val())&&(o=e.text()),"string"==typeof o&&(o=o.replace(" ","T")),o=new Date(o)}else if(t.startFieldYear&&t.startFieldMonth&&t.startFieldDay){if(n=h(t.startFieldYear),i=h(t.startFieldMonth),a=h(t.startFieldDay),!n.length&&!i.length&&!a.length)return null;o=new Date(n.val(),i.val()-1,a.val())}return null===o?null:isNaN(o)?null:o}function f(e){var t,n;return t=e.find("input[name=rirangebyenddatecalendar]"),n=t.data("dateinput"),n=n?n.getValue():t.val(),n=new Date(n),isNaN(n)||""===t.val()?null:n}function m(e,t){var n,i;return n=t.find("input[name="+e+"]"),i=n.val(),isNaN(i)||-1!==i.toString().indexOf(".")||""===n.val()?null:i}function g(e){var n,a,r;e&&s(x,t,e,!0),null!==(n=p())?(x.find("select[name=rimonthlydayofmonthday]").val(n.getDate()),a=t.orderIndexes[Math.floor((n.getDate()-1)/7)],r=t.weekdays[n.getDay()],x.find("select[name=rimonthlyweekdayofmonthindex]").val(a),x.find("select[name=rimonthlyweekdayofmonth]").val(r),x.find("select[name=riyearlydayofmonthmonth]").val(n.getMonth()+1),x.find("select[name=riyearlydayofmonthday]").val(n.getDate()),x.find("select[name=riyearlyweekdayofmonthindex]").val(a),x.find("select[name=riyearlyweekdayofmonthday]").val(r),x.find("select[name=riyearlyweekdayofmonthmonth]").val(n.getMonth()+1),u(n,i(x,t,!1).result,0,!1),x.find("div.rioccurrencesactions").show()):x.find("div.rioccurrencesactions").hide(),o(x.find("select[name=rirtemplate]"))}function v(){var e=i(x,t,!1);T.find("label[class=ridisplay]").text(t.i18n.displayActivate+" "+e.description),a.val(e.result).change();var n=p();null!==n&&u(n,i(x,t,!1).result,0,!0),T.find('button[name="riedit"]').text(t.i18n.edit_rules),T.find('button[name="ridelete"]').show()}function y(){T.find("label[class=ridisplay]").text(t.i18n.displayUnactivate),a.val("").change(),T.find(".rioccurrences").hide(),T.find('button[name="riedit"]').text(t.i18n.add_rules),T.find('button[name="ridelete"]').hide()}function b(e){var n,i,a,o;if(n=p(),(o=e.find("#messagearea")).text(""),o.hide(),e.find(".riaddoccurrence div.errorarea").text("").hide(),"block"===e.find("#ridailyinterval").css("display")&&(!(a=m("ridailyinterval",e))||a<1||a>1e3))return o.text(t.i18n.noRepeatEvery).show(),!1;if("block"===e.find("#riweeklyinterval").css("display")&&(!(a=m("riweeklyinterval",e))||a<1||a>1e3))return o.text(t.i18n.noRepeatEvery).show(),!1;if("block"===e.find("#rimonthlyinterval").css("display")){if(!(a=m("rimonthlyinterval",e))||a<1||a>1e3)return o.text(t.i18n.noRepeatEvery).show(),!1;if(0===e.find("#rimonthlyoptions input:checked").length)return o.text(t.i18n.noRepeatOn).show(),!1}if("block"===e.find("#riyearlyinterval").css("display")){if(!(a=m("riyearlyinterval",e))||a<1||a>1e3)return o.text(t.i18n.noRepeatEvery).show(),!1;if(0===e.find("#riyearlyoptions input:checked").length)return o.text(t.i18n.noRepeatOn).show(),!1}if(e.find('input[value="BYOCCURRENCES"]:visible:checked').length>0&&(!(a=m("rirangebyoccurrencesvalue",e))||a<1||a>1e3))return o.text(t.i18n.noEndAfterNOccurrences).show(),!1;if(e.find('input[value="BYENDDATE"]:visible:checked').length>0){if(!(i=f(e)))return o.text(t.i18n.noEndDate).show(),!1;if(i<n)return o.text(t.i18n.pastEndDate).show(),!1}return!0}function w(e){e.preventDefault(),b(x)&&(x.overlay().close(),v())}function k(){var e;e=p(),b(x)&&u(e,i(x,t,!1).result,0,!1)}var x,T,S,C,E=this,D=[];for(C=0;C<7;C++)(S=C+t.firstDay)>6&&(S-=7),D.push(S);e.extend(t,{orderIndexes:["+1","+2","+3","+4","-1"],weekdays:["SU","MO","TU","WE","TH","FR","SA"],orderedWeekdays:D}),T=e.tmpl("displayTmpl",t),(x=e.tmpl("formTmpl",t)).overlay(t.formOverlay).hide(),x.ical={RDATE:[],EXDATE:[]},e.tools.dateinput.localize(t.lang,{months:d[t.lang].months.join(),shortMonths:d[t.lang].shortMonths.join(),days:d[t.lang].weekdays.join(),shortDays:d[t.lang].shortWeekdays.join()}),x.find("input[name=rirangebyenddatecalendar]").dateinput({selectors:!0,lang:t.lang,format:t.i18n.shortDateFormat,firstDay:t.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),a.val()&&(-1===s(x,t,a.val(),!1)?T.find("label[class=ridisplay]").text(t.i18n.noRule):v()),T.find("button[name=ridelete]").click(function(e){e.preventDefault(),y()}),T.find("button[name=riedit]").click(function(e){g(a.val()),e.preventDefault(),x.overlay().load()}),x.find("div.riaddoccurrence input#adddate").dateinput({selectors:!0,lang:t.lang,format:t.i18n.shortDateFormat,firstDay:t.firstDay,yearRange:[-5,10]}).data("dateinput").setValue(new Date),x.find("input#addaction").click(function(n){n.preventDefault();var i=x.find(".riaddoccurrence input#adddate").data("dateinput"),a=i.getValue("yyyymmddT000000");void 0===x.ical.RDATE&&(x.ical.RDATE=[]);var o=x.find(".riaddoccurrence div.errorarea");if(o.text(""),o.hide(),-1===e.inArray(a,x.ical.RDATE)){x.ical.RDATE.push(a);var r=['<div class="occurrence rdate" style="display: none;">','<span class="rdate">',i.getValue(t.i18n.longDateFormat),'<span class="rlabel">'+t.i18n.additionalDate+"</span>","</span>",'<span class="action">','<a date="'+a+'" href="#" class="rdate" >',"Include","</a>","</span>","</div>"].join("\n");x.find("div.rioccurrences").prepend(r),e(x.find("div.rioccurrences div")[0]).slideDown(),e(x.find("div.rioccurrences .action a.rdate")[0]).click(c)}else o.text(t.i18n.alreadyAdded).show()}),x.find("a.rirefreshbutton").click(function(e){e.preventDefault(),k()}),x.find("select[name=rirtemplate]").change(function(t){o(e(this))}),x.find("select").change(function(t){e(this).parent().find("> input").click().change()}),x.find("input[name=rirangebyoccurrencesvalue]").change(function(t){e(this).parent().find("input[name=rirangetype]").click().change()}),x.find("input[name=rirangebyenddatecalendar]").change(function(){e(this).parent().find("input[name=rirangetype]").click(),0!==x.find(".rioccurrencesactions:visible").length&&k()}),x.find("input:radio, .riweeklyweekday > input, input[name=ridailyinterval], input[name=riweeklyinterval], input[name=rimonthlyinterval], input[name=riyearlyinterval]").change(function(e){0!==x.find(".rioccurrencesactions:visible").length&&k()}),x.find(".ricancelbutton").click(function(e){e.preventDefault(),x.overlay().close()}),x.find(".risavebutton").click(w),e.extend(E,{display:T,form:x,loadData:g,save:w})}e.tools=e.tools||{version:"@VERSION"};var c,d={};(c=e.tools.recurrenceinput={conf:{lang:"en",readOnly:!1,firstDay:0,startField:null,startFieldYear:null,startFieldMonth:null,startFieldDay:null,ajaxURL:null,ajaxContentType:"application/json; charset=utf8",ributtonExtraClass:"",hasRepeatForeverButton:!0,formOverlay:{speed:"fast",fixed:!1},template:{form:"#jquery-recurrenceinput-form-tmpl",display:"#jquery-recurrenceinput-display-tmpl"},rtemplate:{daily:{rrule:"FREQ=DAILY",fields:["ridailyinterval","rirangeoptions"]},mondayfriday:{rrule:"FREQ=WEEKLY;BYDAY=MO,FR",fields:["rirangeoptions"]},weekdays:{rrule:"FREQ=WEEKLY;BYDAY=MO,TU,WE,TH,FR",fields:["rirangeoptions"]},weekly:{rrule:"FREQ=WEEKLY",fields:["riweeklyinterval","riweeklyweekdays","rirangeoptions"]},monthly:{rrule:"FREQ=MONTHLY",fields:["rimonthlyinterval","rimonthlyoptions","rirangeoptions"]},yearly:{rrule:"FREQ=YEARLY",fields:["riyearlyinterval","riyearlyoptions","rirangeoptions"]}}},localize:function(e,t){d[e]=t},setTemplates:function(e,t){var n,i;c.conf.rtemplate=e;for(n in t)if(t.hasOwnProperty(n))for(i in t[n])t[n].hasOwnProperty(i)&&(d[n].rtemplate[i]=t[n][i])}}).localize("en",{displayUnactivate:"Does not repeat",displayActivate:"Repeats every",add_rules:"Add",edit_rules:"Edit",delete_rules:"Delete",add:"Add",refresh:"Refresh",title:"Repeat",preview:"Selected dates",addDate:"Add date",recurrenceType:"Repeats:",dailyInterval1:"Repeat every:",dailyInterval2:"days",weeklyInterval1:"Repeat every:",weeklyInterval2:"week(s)",weeklyWeekdays:"Repeat on:",weeklyWeekdaysHuman:"on:",monthlyInterval1:"Repeat every:",monthlyInterval2:"month(s)",monthlyDayOfMonth1:"Day",monthlyDayOfMonth1Human:"on day",monthlyDayOfMonth2:"of the month",monthlyDayOfMonth3:"month(s)",monthlyWeekdayOfMonth1:"The",monthlyWeekdayOfMonth1Human:"on the",monthlyWeekdayOfMonth2:"",monthlyWeekdayOfMonth3:"of the month",monthlyRepeatOn:"Repeat on:",yearlyInterval1:"Repeat every:",yearlyInterval2:"year(s)",yearlyDayOfMonth1:"Every",yearlyDayOfMonth1Human:"on",yearlyDayOfMonth2:"",yearlyDayOfMonth3:"",yearlyWeekdayOfMonth1:"The",yearlyWeekdayOfMonth1Human:"on the",yearlyWeekdayOfMonth2:"",yearlyWeekdayOfMonth3:"of",yearlyWeekdayOfMonth4:"",yearlyRepeatOn:"Repeat on:",range:"End recurrence:",rangeNoEnd:"Never",rangeByOccurrences1:"After",rangeByOccurrences1Human:"ends after",rangeByOccurrences2:"occurrence(s)",rangeByEndDate:"On",rangeByEndDateHuman:"ends on",including:", and also",except:", except for",cancel:"Cancel",save:"Save",recurrenceStart:"Start of the recurrence",additionalDate:"Additional date",include:"Include",exclude:"Exclude",remove:"Remove",orderIndexes:["first","second","third","fourth","last"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortWeekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],longDateFormat:"mmmm dd, yyyy",shortDateFormat:"mm/dd/yyyy",unsupportedFeatures:"Warning: This event uses recurrence features not supported by this widget. Saving the recurrence may change the recurrence in unintended ways:",noTemplateMatch:"No matching recurrence template",multipleDayOfMonth:"This widget does not support multiple days in monthly or yearly recurrence",bysetpos:"BYSETPOS is not supported",noRule:"No RRULE in RRULE data",noRepeatEvery:'Error: The "Repeat every"-field must be between 1 and 1000',noEndDate:"Error: End date is not set. Please set a correct value",noRepeatOn:'Error: "Repeat on"-value must be selected',pastEndDate:"Error: End date cannot be before start date",noEndAfterNOccurrences:'Error: The "After N occurrences"-field must be between 1 and 1000',alreadyAdded:"This date was already added",rtemplate:{daily:"Daily",mondayfriday:"Monday and Friday",weekdays:"Weekday",weekly:"Weekly",monthly:"Monthly",yearly:"Yearly"}});var u=['<div class="rioccurrences">',"{{each occurrences}}",'<div class="occurrence ${occurrences[$index].type}">',"<span>","${occurrences[$index].formattedDate}",'{{if occurrences[$index].type === "start"}}','<span class="rlabel">${i18n.recurrenceStart}</span>',"{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<span class="rlabel">${i18n.additionalDate}</span>',"{{/if}}","</span>","{{if !readOnly}}",'<span class="action">','{{if occurrences[$index].type === "rrule"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.exclude}">',"${i18n.exclude}","</a>","{{/if}}",'{{if occurrences[$index].type === "rdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.remove}" >',"${i18n.remove}","</a>","{{/if}}",'{{if occurrences[$index].type === "exdate"}}','<a date="${occurrences[$index].date}" href="#"','class="${occurrences[$index].type}" title="${i18n.include}">',"${i18n.include}","</a>","{{/if}}","</span>","{{/if}}","</div>","{{/each}}",'<div class="batching">',"{{each batch.batches}}",'{{if $index === batch.currentBatch}}<span class="current">{{/if}}','<a href="#" start="${batch.batches[$index][0]}">[${batch.batches[$index][0]} - ${batch.batches[$index][1]}]</a>',"{{if $index === batch.currentBatch}}</span>{{/if}}","{{/each}}","</div></div>"].join("\n");e.template("occurrenceTmpl",u);var h=['<div class="ridisplay">','<div class="rimain">',"{{if !readOnly}}",'<button name="riedit">${i18n.add_rules}</button>','<button name="ridelete" style="display:none">${i18n.delete_rules}</button>',"{{/if}}",'<label class="ridisplay">${i18n.displayUnactivate}</label>',"</div>",'<div class="rioccurrences" style="display:none" /></div>'].join("\n");e.template("displayTmpl",h);var p=['<div class="riform">',"<form>","<h1>${i18n.title}</h1>",'<div id="messagearea" style="display: none;">',"</div>",'<div id="rirtemplate">','<label for="${name}rtemplate" class="label">',"${i18n.recurrenceType}","</label>",'<select id="rirtemplate" name="rirtemplate" class="field">',"{{each rtemplate}}",'<option value="${$index}">${i18n.rtemplate[$index]}</value>',"{{/each}}","</select>","<div>",'<div id="riformfields">','<div id="ridailyinterval" class="rifield">','<label for="${name}dailyinterval" class="label">',"${i18n.dailyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="ridailyinterval"','id="${name}dailyinterval" />',"${i18n.dailyInterval2}","</div>","</div>",'<div id="riweeklyinterval" class="rifield">','<label for="${name}weeklyinterval" class="label">',"${i18n.weeklyInterval1}","</label>",'<div class="field">','<input type="text" size="2"','value="1"','name="riweeklyinterval"','id="${name}weeklyinterval"/>',"${i18n.weeklyInterval2}","</div>","</div>",'<div id="riweeklyweekdays" class="rifield">','<label for="${name}weeklyinterval" class="label">${i18n.weeklyWeekdays}</label>','<div class="field">',"{{each orderedWeekdays}}",'<div class="riweeklyweekday">','<input type="checkbox"','name="riweeklyweekdays${weekdays[$value]}"','id="${name}weeklyWeekdays${weekdays[$value]}"','value="${weekdays[$value]}" />','<label for="${name}weeklyWeekdays${weekdays[$value]}">${i18n.shortWeekdays[$value]}</label>',"</div>","{{/each}}","</div>","</div>",'<div id="rimonthlyinterval" class="rifield">','<label for="rimonthlyinterval" class="label">${i18n.monthlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="rimonthlyinterval"/>',"${i18n.monthlyInterval2}","</div>","</div>",'<div id="rimonthlyoptions" class="rifield">','<label for="rimonthlytype" class="label">${i18n.monthlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:DAYOFMONTH" />','<label for="${name}monthlytype:DAYOFMONTH">',"${i18n.monthlyDayOfMonth1}","</label>",'<select name="rimonthlydayofmonthday"','id="${name}monthlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyDayOfMonth2}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="rimonthlytype"','id="${name}monthlytype:WEEKDAYOFMONTH" />','<label for="${name}monthlytype:WEEKDAYOFMONTH">',"${i18n.monthlyWeekdayOfMonth1}","</label>",'<select name="rimonthlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth2}",'<select name="rimonthlyweekdayofmonth">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.monthlyWeekdayOfMonth3}","</div>","</div>","</div>",'<div id="riyearlyinterval" class="rifield">','<label for="riyearlyinterval" class="label">${i18n.yearlyInterval1}</label>','<div class="field">','<input type="text" size="2"','value="1" ','name="riyearlyinterval"/>',"${i18n.yearlyInterval2}","</div>","</div>",'<div id="riyearlyoptions" class="rifield">','<label for="riyearlyType" class="label">${i18n.yearlyRepeatOn}</label>','<div class="field">',"<div>","<input",'type="radio"','value="DAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:DAYOFMONTH" />','<label for="${name}yearlytype:DAYOFMONTH">',"${i18n.yearlyDayOfMonth1}","</label>",'<select name="riyearlydayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth2}",'<select name="riyearlydayofmonthday">',"{{each [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,","18,19,20,21,22,23,24,25,26,27,28,29,30,31]}}",'<option value="${$value}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyDayOfMonth3}","</div>","<div>","<input",'type="radio"','value="WEEKDAYOFMONTH"','name="riyearlyType"','id="${name}yearlytype:WEEKDAYOFMONTH"/>','<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth1}","</label>",'<select name="riyearlyweekdayofmonthindex">',"{{each i18n.orderIndexes}}",'<option value="${orderIndexes[$index]}">${$value}</option>',"{{/each}}","</select>",'<label for="${name}yearlytype:WEEKDAYOFMONTH">',"${i18n.yearlyWeekdayOfMonth2}","</label>",'<select name="riyearlyweekdayofmonthday">',"{{each orderedWeekdays}}",'<option value="${weekdays[$value]}">${i18n.weekdays[$value]}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth3}",'<select name="riyearlyweekdayofmonthmonth">',"{{each i18n.months}}",'<option value="${$index+1}">${$value}</option>',"{{/each}}","</select>","${i18n.yearlyWeekdayOfMonth4}","</div>","</div>","</div>",'<div id="rirangeoptions" class="rifield">','<label class="label">${i18n.range}</label>','<div class="field">',"{{if hasRepeatForeverButton}}","<div>","<input",'type="radio"','value="NOENDDATE"','name="rirangetype"','id="${name}rangetype:NOENDDATE"/>','<label for="${name}rangetype:NOENDDATE">',"${i18n.rangeNoEnd}","</label>","</div>","{{/if}}","<div>","<input",'type="radio"','checked="checked"','value="BYOCCURRENCES"','name="rirangetype"','id="${name}rangetype:BYOCCURRENCES"/>','<label for="${name}rangetype:BYOCCURRENCES">',"${i18n.rangeByOccurrences1}","</label>","<input",'type="text" size="3"','value="7"','name="rirangebyoccurrencesvalue" />',"${i18n.rangeByOccurrences2}","</div>","<div>","<input",'type="radio"','value="BYENDDATE"','name="rirangetype"','id="${name}rangetype:BYENDDATE"/>','<label for="${name}rangetype:BYENDDATE">',"${i18n.rangeByEndDate}","</label>","<input",'type="date"','name="rirangebyenddatecalendar" />',"</div>","</div>","</div>","</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.preview}</h2>",'<span class="refreshbutton action">','<a class="rirefreshbutton" href="#" title="${i18n.refresh}">',"${i18n.refresh}","</a>","</span>","</div>","</div>",'<div class="rioccurrences">',"</div>",'<div class="rioccurrencesactions">','<div class="rioccurancesheader">',"<h2>${i18n.addDate}</h2>","</div>",'<div class="riaddoccurrence">','<div class="errorarea"></div>','<input type="date" name="adddate" id="adddate" />','<input type="button" name="addaction" id="addaction" value="${i18n.add}">',"</div>","</div>",'<div class="ributtons">',"<input",'type="submit"','class="ricancelbutton ${ributtonExtraClass}"','value="${i18n.cancel}" />',"<input",'type="submit"','class="risavebutton ${ributtonExtraClass}"','value="${i18n.save}" />',"</div>","</form></div>"].join("\n");e.template("formTmpl",p);var f=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g;e.fn.recurrenceinput=function(t){if(this.data("recurrenceinput"))return this.data("recurrenceinput");var n=e.extend({},c.conf);e.extend(n,t),e.extend(n,{i18n:d[n.lang],name:this.attr("name")});var i=new l(n,this);return i.form.appendTo("body"),this.after(i.display),this.hide(),this.data("recurrenceinput",i),i}}(jQuery)}.apply(e,arguments)})}(this),define("mockup-patterns-recurrence",["jquery","pat-base","jquery.recurrenceinput"],function(e,t){"use strict";return t.extend({name:"recurrence",trigger:".pat-recurrence",parser:"mockup",defaults:{language:"en",localization:null,configuration:{}},init:function(){this.$el.addClass("recurrence-widget"),this.options.localization&&e.tools.recurrenceinput.localize(this.options.language,this.options.localization),this.$el.recurrenceinput(this.options.configuration)}})}),function(e){define("select2",[],function(){return function(){!function(e){void 0===e.fn.each2&&e.extend(e.fn,{each2:function(t){for(var n=e([0]),i=-1,a=this.length;++i<a&&(n.context=n[0]=this[i])&&!1!==t.call(n[0],i,n););return this}})}(jQuery),function(e,t){"use strict";function n(t){var n=e(document.createTextNode(""));t.before(n),n.before(t),n.remove()}function i(e){return e.replace(/[^\u0000-\u007E]/g,function(e){return U[e]||e})}function a(e,t){for(var n=0,i=t.length;n<i;n+=1)if(r(e,t[n]))return n;return-1}function o(){var t=e(F);t.appendTo(document.body);var n={width:t.width()-t[0].clientWidth,height:t.height()-t[0].clientHeight};return t.remove(),n}function r(e,n){return e===n||e!==t&&n!==t&&(null!==e&&null!==n&&(e.constructor===String?e+""==n+"":n.constructor===String&&n+""==e+""))}function s(e,t,n){var i,a,o;if(null===e||e.length<1)return[];for(a=0,o=(i=e.split(t)).length;a<o;a+=1)i[a]=n(i[a]);return i}function l(e){return e.outerWidth(!1)-e.width()}function c(n){var i="keyup-change-value";n.on("keydown",function(){e.data(n,i)===t&&e.data(n,i,n.val())}),n.on("keyup",function(){var a=e.data(n,i);a!==t&&n.val()!==a&&(e.removeData(n,i),n.trigger("keyup-change"))})}function d(n){n.on("mousemove",function(n){var i=j;i!==t&&i.x===n.pageX&&i.y===n.pageY||e(n.target).trigger("mousemove-filtered",n)})}function u(e,n,i){i=i||t;var a;return function(){var t=arguments;window.clearTimeout(a),a=window.setTimeout(function(){n.apply(i,t)},e)}}function h(e,t){var n=u(e,function(e){t.trigger("scroll-debounced",e)});t.on("scroll",function(e){a(e.target,t.get())>=0&&n(e)})}function p(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,n=e[0],i=e.val().length;e.focus(),(n.offsetWidth>0||n.offsetHeight>0)&&n===document.activeElement&&(n.setSelectionRange?n.setSelectionRange(i,i):n.createTextRange&&((t=n.createTextRange()).collapse(!1),t.select()))},0)}function f(t){var n=0,i=0;if("selectionStart"in(t=e(t)[0]))n=t.selectionStart,i=t.selectionEnd-n;else if("selection"in document){t.focus();var a=document.selection.createRange();i=document.selection.createRange().text.length,a.moveStart("character",-t.value.length),n=a.text.length-i}return{offset:n,length:i}}function m(e){e.preventDefault(),e.stopPropagation()}function g(e){e.preventDefault(),e.stopImmediatePropagation()}function v(t){if(!R){var n=t[0].currentStyle||window.getComputedStyle(t[0],null);(R=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,letterSpacing:n.letterSpacing,textTransform:n.textTransform,whiteSpace:"nowrap"})).attr("class","select2-sizer"),e(document.body).append(R)}return R.text(t.val()),R.width()}function y(t,n,i){var a,o,r=[];(a=e.trim(t.attr("class")))&&e((a=""+a).split(/\s+/)).each2(function(){0===this.indexOf("select2-")&&r.push(this)}),(a=e.trim(n.attr("class")))&&e((a=""+a).split(/\s+/)).each2(function(){0!==this.indexOf("select2-")&&(o=i(this))&&r.push(o)}),t.attr("class",r.join(" "))}function b(e,t,n,a){var o=i(e.toUpperCase()).indexOf(i(t.toUpperCase())),r=t.length;o<0?n.push(a(e)):(n.push(a(e.substring(0,o))),n.push("<span class='select2-match'>"),n.push(a(e.substring(o,o+r))),n.push("</span>"),n.push(a(e.substring(o+r,e.length))))}function w(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e]})}function k(n){var i,a=null,o=n.quietMillis||100,r=n.url,s=this;return function(l){window.clearTimeout(i),i=window.setTimeout(function(){var i=n.data,o=r,c=n.transport||e.fn.select2.ajaxDefaults.transport,d={type:n.type||"GET",cache:n.cache||!1,jsonpCallback:n.jsonpCallback||t,dataType:n.dataType||"json"},u=e.extend({},e.fn.select2.ajaxDefaults.params,d);i=i?i.call(s,l.term,l.page,l.context):null,o="function"==typeof o?o.call(s,l.term,l.page,l.context):o,a&&"function"==typeof a.abort&&a.abort(),n.params&&(e.isFunction(n.params)?e.extend(u,n.params.call(s)):e.extend(u,n.params)),e.extend(u,{url:o,dataType:n.dataType,data:i,success:function(e){var t=n.results(e,l.page,l);l.callback(t)},error:function(e,t,n){var i={hasError:!0,jqXHR:e,textStatus:t,errorThrown:n};l.callback(i)}}),a=c.call(s,u)},o)}}function x(t){var n,i,a=t,o=function(e){return""+e.text};e.isArray(a)&&(a={results:i=a}),!1===e.isFunction(a)&&(i=a,a=function(){return i});var r=a();return r.text&&(o=r.text,e.isFunction(o)||(n=r.text,o=function(e){return e[n]})),function(t){var n,i=t.term,r={results:[]};""!==i?(n=function(a,r){var s,l;if((a=a[0]).children){s={};for(l in a)a.hasOwnProperty(l)&&(s[l]=a[l]);s.children=[],e(a.children).each2(function(e,t){n(t,s.children)}),(s.children.length||t.matcher(i,o(s),a))&&r.push(s)}else t.matcher(i,o(a),a)&&r.push(a)},e(a().results).each2(function(e,t){n(t,r.results)}),t.callback(r)):t.callback(a())}}function T(n){var i=e.isFunction(n);return function(a){var o=a.term,r={results:[]},s=i?n(a):n;e.isArray(s)&&(e(s).each(function(){var e=this.text!==t,n=e?this.text:this;(""===o||a.matcher(o,n))&&r.results.push(e?this:{id:this,text:this})}),a.callback(r))}}function S(t,n){if(e.isFunction(t))return!0;if(!t)return!1;if("string"==typeof t)return!0;throw new Error(n+" must be a string, function, or falsy value")}function C(t,n){if(e.isFunction(t)){var i=Array.prototype.slice.call(arguments,2);return t.apply(n,i)}return t}function E(t){var n=0;return e.each(t,function(e,t){t.children?n+=E(t.children):n++}),n}function D(){var t=this;e.each(arguments,function(e,n){t[n].remove(),t[n]=null})}function O(t,n){var i=function(){};return i.prototype=new t,i.prototype.constructor=i,i.prototype.parent=t.prototype,i.prototype=e.extend(i.prototype,n),i}if(window.Select2===t){var $,A,I,M,R,P,N,j={x:0,y:0},_={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case _.LEFT:case _.RIGHT:case _.UP:case _.DOWN:return!0}return!1},isControl:function(e){switch(e.which){case _.SHIFT:case _.CTRL:case _.ALT:return!0}return!!e.metaKey},isFunctionKey:function(e){return(e=e.which?e.which:e)>=112&&e<=123}},F="<div class='select2-measure-scrollbar'></div>",U={"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"};P=e(document),M=function(){var e=1;return function(){return e++}}(),A=O($=O(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(n){var i,a;this.opts=n=this.prepareOpts(n),this.id=n.id,n.element.data("select2")!==t&&null!==n.element.data("select2")&&n.element.data("select2").destroy(),this.container=this.createContainer(),this.liveRegion=e(".select2-hidden-accessible"),0==this.liveRegion.length&&(this.liveRegion=e("<span>",{role:"status","aria-live":"polite"}).addClass("select2-hidden-accessible").appendTo(document.body)),this.containerId="s2id_"+(n.element.attr("id")||"autogen"+M()),this.containerEventName=this.containerId.replace(/([.])/g,"_").replace(/([;&,\-\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.container.attr("title",n.element.attr("title")),this.body=e(document.body),y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.attr("style",n.element.attr("style")),this.container.css(C(n.containerCss,this.opts.element)),this.container.addClass(C(n.containerCssClass,this.opts.element)),this.elementTabIndex=this.opts.element.attr("tabindex"),this.opts.element.data("select2",this).attr("tabindex","-1").before(this.container).on("click.select2",m),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(C(n.dropdownCssClass,this.opts.element)),this.dropdown.data("select2",this),this.dropdown.on("click",m),this.results=i=this.container.find(".select2-results"),this.search=a=this.container.find("input.select2-input"),this.queryCount=0,this.resultsPage=0,this.context=null,this.initContainer(),this.container.on("click",m),d(this.results),this.dropdown.on("mousemove-filtered",".select2-results",this.bind(this.highlightUnderEvent)),this.dropdown.on("touchstart touchmove touchend",".select2-results",this.bind(function(e){this._touchEvent=!0,this.highlightUnderEvent(e)})),this.dropdown.on("touchmove",".select2-results",this.bind(this.touchMoved)),this.dropdown.on("touchstart touchend",".select2-results",this.bind(this.clearTouchMoved)),this.dropdown.on("click",this.bind(function(e){this._touchEvent&&(this._touchEvent=!1,this.selectHighlighted())})),h(80,this.results),this.dropdown.on("scroll-debounced",".select2-results",this.bind(this.loadMoreIfNeeded)),e(this.container).on("change",".select2-input",function(e){e.stopPropagation()}),e(this.dropdown).on("change",".select2-input",function(e){e.stopPropagation()}),e.fn.mousewheel&&i.mousewheel(function(e,t,n,a){var o=i.scrollTop();a>0&&o-a<=0?(i.scrollTop(0),m(e)):a<0&&i.get(0).scrollHeight-i.scrollTop()+a<=i.height()&&(i.scrollTop(i.get(0).scrollHeight-i.height()),m(e))}),c(a),a.on("keyup-change input paste",this.bind(this.updateResults)),a.on("focus",function(){a.addClass("select2-focused")}),a.on("blur",function(){a.removeClass("select2-focused")}),this.dropdown.on("mouseup",".select2-results",this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.on("click mouseup mousedown touchstart touchend focusin",function(e){e.stopPropagation()}),this.lastSearchTerm=t,e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),null!==n.maximumInputLength&&this.search.attr("maxlength",n.maximumInputLength);var r=n.element.prop("disabled");r===t&&(r=!1),this.enable(!r);var s=n.element.prop("readonly");s===t&&(s=!1),this.readonly(s),N=N||o(),this.autofocus=n.element.prop("autofocus"),n.element.prop("autofocus",!1),this.autofocus&&this.focus(),this.search.attr("placeholder",n.searchInputPlaceholder)},destroy:function(){var e=this.opts.element,n=e.data("select2"),i=this;this.close(),e.length&&e[0].detachEvent&&i._sync&&e.each(function(){i._sync&&this.detachEvent("onpropertychange",i._sync)}),this.propertyObserver&&(this.propertyObserver.disconnect(),this.propertyObserver=null),this._sync=null,n!==t&&(n.container.remove(),n.liveRegion.remove(),n.dropdown.remove(),e.removeData("select2").off(".select2"),e.is("input[type='hidden']")?e.css("display",""):(e.show().prop("autofocus",this.autofocus||!1),this.elementTabIndex?e.attr({tabindex:this.elementTabIndex}):e.removeAttr("tabindex"),e.show())),D.call(this,"container","liveRegion","dropdown","results","search")},optionToData:function(e){return e.is("option")?{id:e.prop("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:e.prop("disabled"),locked:r(e.attr("locked"),"locked")||r(e.data("locked"),!0)}:e.is("optgroup")?{text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")}:void 0},prepareOpts:function(n){var i,a,o,l,c=this;if("select"===(i=n.element).get(0).tagName.toLowerCase()&&(this.select=a=n.element),a&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in n)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),n.debug=n.debug||e.fn.select2.defaults.debug,n.debug&&console&&console.warn&&(null!=n.id&&console.warn("Select2: The `id` option has been removed in Select2 4.0.0, consider renaming your `id` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=n.text&&console.warn("Select2: The `text` option has been removed in Select2 4.0.0, consider renaming your `text` property or mapping the property before your data makes it to Select2. You can read more at https://select2.github.io/announcements-4.0.html#changed-id"),null!=n.sortResults&&console.warn("Select2: the `sortResults` option has been renamed to `sorter` in Select2 4.0.0. "),null!=n.selectOnBlur&&console.warn("Select2: The `selectOnBlur` option has been renamed to `selectOnClose` in Select2 4.0.0."),null!=n.ajax&&null!=n.ajax.results&&console.warn("Select2: The `ajax.results` option has been renamed to `ajax.processResults` in Select2 4.0.0."),null!=n.formatNoResults&&console.warn("Select2: The `formatNoResults` option has been renamed to `language.noResults` in Select2 4.0.0."),null!=n.formatSearching&&console.warn("Select2: The `formatSearching` option has been renamed to `language.searching` in Select2 4.0.0."),null!=n.formatInputTooShort&&console.warn("Select2: The `formatInputTooShort` option has been renamed to `language.inputTooShort` in Select2 4.0.0."),null!=n.formatInputTooLong&&console.warn("Select2: The `formatInputTooLong` option has been renamed to `language.inputTooLong` in Select2 4.0.0."),null!=n.formatLoading&&console.warn("Select2: The `formatLoading` option has been renamed to `language.loadingMore` in Select2 4.0.0."),null!=n.formatSelectionTooBig&&console.warn("Select2: The `formatSelectionTooBig` option has been renamed to `language.maximumSelected` in Select2 4.0.0."),n.element.data("select2Tags")&&console.warn("Select2: The `data-select2-tags` attribute has been renamed to `data-tags` in Select2 4.0.0.")),null!=n.element.data("tags")){var d=n.element.data("tags");e.isArray(d)||(d=[]),n.element.data("select2Tags",d)}if(null!=n.sorter&&(n.sortResults=n.sorter),null!=n.selectOnClose&&(n.selectOnBlur=n.selectOnClose),null!=n.ajax&&e.isFunction(n.ajax.processResults)&&(n.ajax.results=n.ajax.processResults),null!=n.language){var u=n.language;e.isFunction(u.noMatches)&&(n.formatNoMatches=u.noMatches),e.isFunction(u.searching)&&(n.formatSearching=u.searching),e.isFunction(u.inputTooShort)&&(n.formatInputTooShort=u.inputTooShort),e.isFunction(u.inputTooLong)&&(n.formatInputTooLong=u.inputTooLong),e.isFunction(u.loadingMore)&&(n.formatLoading=u.loadingMore),e.isFunction(u.maximumSelected)&&(n.formatSelectionTooBig=u.maximumSelected)}if("function"!=typeof(n=e.extend({},{populateResults:function(i,a,o){var r,s=this.opts.id,l=this.liveRegion;(r=function(i,a,d){var u,h,p,f,m,g,v,y,b,w,k=[];for(u=0,h=(i=n.sortResults(i,a,o)).length;u<h;u+=1)f=!(m=!0===(p=i[u]).disabled)&&s(p)!==t,g=p.children&&p.children.length>0,(v=e("<li></li>")).addClass("select2-results-dept-"+d),v.addClass("select2-result"),v.addClass(f?"select2-result-selectable":"select2-result-unselectable"),m&&v.addClass("select2-disabled"),g&&v.addClass("select2-result-with-children"),v.addClass(c.opts.formatResultCssClass(p)),v.attr("role","presentation"),(y=e(document.createElement("div"))).addClass("select2-result-label"),y.attr("id","select2-result-label-"+M()),y.attr("role","option"),(w=n.formatResult(p,y,o,c.opts.escapeMarkup))!==t&&(y.html(w),v.append(y)),g&&((b=e("<ul></ul>")).addClass("select2-result-sub"),r(p.children,b,d+1),v.append(b)),v.data("select2-data",p),k.push(v[0]);a.append(k),l.text(n.formatMatches(i.length))})(a,i,0)}},e.fn.select2.defaults,n)).id&&(o=n.id,n.id=function(e){return e[o]}),e.isArray(n.element.data("select2Tags"))){if("tags"in n)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+n.element.attr("id");n.tags=n.element.data("select2Tags")}if(a?(n.query=this.bind(function(e){var n,a,o,r={results:[],more:!1},s=e.term;o=function(t,n){var i;t.is("option")?e.matcher(s,t.text(),t)&&n.push(c.optionToData(t)):t.is("optgroup")&&(i=c.optionToData(t),t.children().each2(function(e,t){o(t,i.children)}),i.children.length>0&&n.push(i))},n=i.children(),this.getPlaceholder()!==t&&n.length>0&&(a=this.getPlaceholderOption())&&(n=n.not(a)),n.each2(function(e,t){o(t,r.results)}),e.callback(r)}),n.id=function(e){return e.id}):"query"in n||("ajax"in n?((l=n.element.data("ajax-url"))&&l.length>0&&(n.ajax.url=l),n.query=k.call(n.element,n.ajax)):"data"in n?n.query=x(n.data):"tags"in n&&(n.query=T(n.tags),n.createSearchChoice===t&&(n.createSearchChoice=function(t){return{id:e.trim(t),text:e.trim(t)}}),n.initSelection===t&&(n.initSelection=function(t,i){var a=[];e(s(t.val(),n.separator,n.transformVal)).each(function(){var t={id:this,text:this},i=n.tags;e.isFunction(i)&&(i=i()),e(i).each(function(){if(r(this.id,t.id))return t=this,!1}),a.push(t)}),i(a)}))),"function"!=typeof n.query)throw"query function not defined for Select2 "+n.element.attr("id");if("top"===n.createSearchChoicePosition)n.createSearchChoicePosition=function(e,t){e.unshift(t)};else if("bottom"===n.createSearchChoicePosition)n.createSearchChoicePosition=function(e,t){e.push(t)};else if("function"!=typeof n.createSearchChoicePosition)throw"invalid createSearchChoicePosition option must be 'top', 'bottom' or a custom function";return n},monitorSource:function(){var n,i=this.opts.element,a=this;i.on("change.select2",this.bind(function(e){!0!==this.opts.element.data("select2-change-triggered")&&this.initSelection()})),this._sync=this.bind(function(){var e=i.prop("disabled");e===t&&(e=!1),this.enable(!e);var n=i.prop("readonly");n===t&&(n=!1),this.readonly(n),this.container&&(y(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(C(this.opts.containerCssClass,this.opts.element))),this.dropdown&&(y(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(C(this.opts.dropdownCssClass,this.opts.element)))}),i.length&&i[0].attachEvent&&i.each(function(){this.attachEvent("onpropertychange",a._sync)}),(n=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)!==t&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new n(function(t){e.each(t,a._sync)}),this.propertyObserver.observe(i.get(0),{attributes:!0,subtree:!1}))},triggerSelect:function(t){var n=e.Event("select2-selecting",{val:this.id(t),object:t,choice:t});return this.opts.element.trigger(n),!n.isDefaultPrevented()},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},isInterfaceEnabled:function(){return!0===this.enabledInterface},enableInterface:function(){var e=this._enabled&&!this._readonly,t=!e;return e!==this.enabledInterface&&(this.container.toggleClass("select2-container-disabled",t),this.close(),this.enabledInterface=e,!0)},enable:function(e){e===t&&(e=!0),this._enabled!==e&&(this._enabled=e,this.opts.element.prop("disabled",!e),this.enableInterface())},disable:function(){this.enable(!1)},readonly:function(e){e===t&&(e=!1),this._readonly!==e&&(this._readonly=e,this.opts.element.prop("readonly",e),this.enableInterface())},opened:function(){return!!this.container&&this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,n,i,a,o,r=this.dropdown,s=this.container,l=s.offset(),c=s.outerHeight(!1),d=s.outerWidth(!1),u=r.outerHeight(!1),h=e(window),p=h.width(),f=h.height(),m=h.scrollLeft()+p,g=h.scrollTop()+f,v=l.top+c,y=l.left,b=v+u<=g,w=l.top-u>=h.scrollTop(),k=r.outerWidth(!1);r.hasClass("select2-drop-above")?(n=!0,!w&&b&&(i=!0,n=!1)):(n=!1,!b&&w&&(i=!0,n=!0)),i&&(r.hide(),l=this.container.offset(),c=this.container.outerHeight(!1),d=this.container.outerWidth(!1),u=r.outerHeight(!1),m=h.scrollLeft()+p,g=h.scrollTop()+f,v=l.top+c,y=l.left,k=r.outerWidth(!1),r.show(),this.focusSearch()),this.opts.dropdownAutoWidth?(o=e(".select2-results",r)[0],r.addClass("select2-drop-auto-width"),r.css("width",""),(k=r.outerWidth(!1)+(o.scrollHeight===o.clientHeight?0:N.width))>d?d=k:k=d,u=r.outerHeight(!1)):this.container.removeClass("select2-drop-auto-width"),"static"!==this.body.css("position")&&(v-=(t=this.body.offset()).top,y-=t.left),!(y+k<=m)&&l.left+m+s.outerWidth(!1)>k&&(y=l.left+this.container.outerWidth(!1)-k),a={left:y,width:d},n?(this.container.addClass("select2-drop-above"),r.addClass("select2-drop-above"),u=r.outerHeight(!1),a.top=l.top-u,a.bottom="auto"):(a.top=v,a.bottom="auto",this.container.removeClass("select2-drop-above"),r.removeClass("select2-drop-above")),a=e.extend(a,C(this.opts.dropdownCss,this.opts.element)),r.css(a)},shouldOpen:function(){var t;return!this.opened()&&(!1!==this._enabled&&!0!==this._readonly&&(t=e.Event("select2-opening"),this.opts.element.trigger(t),!t.isDefaultPrevented()))},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return!!this.shouldOpen()&&(this.opening(),P.on("mousemove.select2Event",function(e){j.x=e.pageX,j.y=e.pageY}),!0)},opening:function(){var t,i=this.containerEventName,a="scroll."+i,o="resize."+i,r="orientationchange."+i;this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.clearDropdownAlignmentPreference(),this.dropdown[0]!==this.body.children().last()[0]&&this.dropdown.detach().appendTo(this.body),0===(t=e("#select2-drop-mask")).length&&((t=e(document.createElement("div"))).attr("id","select2-drop-mask").attr("class","select2-drop-mask"),t.hide(),t.appendTo(this.body),t.on("mousedown touchstart click",function(i){n(t);var a,o=e("#select2-drop");o.length>0&&((a=o.data("select2")).opts.selectOnBlur&&a.selectHighlighted({noFocus:!0}),a.close(),i.preventDefault(),i.stopPropagation())})),this.dropdown.prev()[0]!==t[0]&&this.dropdown.before(t),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),t.show(),this.positionDropdown(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active");var s=this;this.container.parents().add(window).each(function(){e(this).on(o+" "+a+" "+r,function(e){s.opened()&&s.positionDropdown()})})},close:function(){if(this.opened()){var t=this.containerEventName,n="scroll."+t,i="resize."+t,a="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).off(n).off(i).off(a)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open").removeClass("select2-container-active"),this.results.empty(),P.off("mousemove.select2Event"),this.clearSearch(),this.search.removeClass("select2-active"),this.search.removeAttr("aria-activedescendant"),this.opts.element.trigger(e.Event("select2-close"))}},externalSearch:function(e){this.open(),this.search.val(e),this.updateResults(!1)},clearSearch:function(){},prefillNextSearchTerm:function(){if(""!==this.search.val())return!1;var e=this.opts.nextSearchTerm(this.data(),this.lastSearchTerm);return e!==t&&(this.search.val(e),this.search.select(),!0)},getMaximumSelectionSize:function(){return C(this.opts.maximumSelectionSize,this.opts.element)},ensureHighlightVisible:function(){var t,n,i,a,o,r,s,l,c=this.results;(n=this.highlight())<0||(0!=n?(t=this.findHighlightableChoices().find(".select2-result-label"),a=(l=((i=e(t[n])).offset()||{}).top||0)+i.outerHeight(!0),n===t.length-1&&(s=c.find("li.select2-more-results")).length>0&&(a=s.offset().top+s.outerHeight(!0)),a>(o=c.offset().top+c.outerHeight(!1))&&c.scrollTop(c.scrollTop()+(a-o)),(r=l-c.offset().top)<0&&"none"!=i.css("display")&&c.scrollTop(c.scrollTop()+r)):c.scrollTop(0))},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-disabled):not(.select2-selected)")},moveHighlight:function(t){for(var n=this.findHighlightableChoices(),i=this.highlight();i>-1&&i<n.length;){var a=e(n[i+=t]);if(a.hasClass("select2-result-selectable")&&!a.hasClass("select2-disabled")&&!a.hasClass("select2-selected")){this.highlight(i);break}}},highlight:function(t){var n,i,o=this.findHighlightableChoices();if(0===arguments.length)return a(o.filter(".select2-highlighted")[0],o.get());t>=o.length&&(t=o.length-1),t<0&&(t=0),this.removeHighlight(),(n=e(o[t])).addClass("select2-highlighted"),this.search.attr("aria-activedescendant",n.find(".select2-result-label").attr("id")),this.ensureHighlightVisible(),this.liveRegion.text(n.text()),(i=n.data("select2-data"))&&this.opts.element.trigger({type:"select2-highlight",val:this.id(i),choice:i})},removeHighlight:function(){this.results.find(".select2-highlighted").removeClass("select2-highlighted")},touchMoved:function(){this._touchMoved=!0},clearTouchMoved:function(){this._touchMoved=!1},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var n=e(t.target).closest(".select2-result-selectable");if(n.length>0&&!n.is(".select2-highlighted")){var i=this.findHighlightableChoices();this.highlight(i.index(n))}else 0==n.length&&this.removeHighlight()},loadMoreIfNeeded:function(){var e=this.results,t=e.find("li.select2-more-results"),n=this.resultsPage+1,i=this,a=this.search.val(),o=this.context;0!==t.length&&t.offset().top-e.offset().top-e.height()<=this.opts.loadMorePadding&&(t.addClass("select2-active"),this.opts.query({element:this.opts.element,term:a,page:n,context:o,matcher:this.opts.matcher,callback:this.bind(function(r){i.opened()&&(i.opts.populateResults.call(this,e,r.results,{term:a,page:n,context:o}),i.postprocessResults(r,!1,!1),!0===r.more?(t.detach().appendTo(e).html(i.opts.escapeMarkup(C(i.opts.formatLoadMore,i.opts.element,n+1))),window.setTimeout(function(){i.loadMoreIfNeeded()},10)):t.remove(),i.positionDropdown(),i.resultsPage=n,i.context=r.context,this.opts.element.trigger({type:"select2-loaded",items:r}))})}))},tokenize:function(){},updateResults:function(n){function i(){c.removeClass("select2-active"),h.positionDropdown(),d.find(".select2-no-results,.select2-selection-limit,.select2-searching").length?h.liveRegion.text(d.text()):h.liveRegion.text(h.opts.formatMatches(d.find('.select2-result-selectable:not(".select2-selected")').length))}function a(e){d.html(e),i()}var o,s,l,c=this.search,d=this.results,u=this.opts,h=this,p=c.val(),f=e.data(this.container,"select2-last-term");if((!0===n||!f||!r(p,f))&&(e.data(this.container,"select2-last-term",p),!0===n||!1!==this.showSearchInput&&this.opened())){l=++this.queryCount;var m=this.getMaximumSelectionSize();if(!(m>=1&&(o=this.data(),e.isArray(o)&&o.length>=m&&S(u.formatSelectionTooBig,"formatSelectionTooBig"))))return c.val().length<u.minimumInputLength?(a(S(u.formatInputTooShort,"formatInputTooShort")?"<li class='select2-no-results'>"+C(u.formatInputTooShort,u.element,c.val(),u.minimumInputLength)+"</li>":""),void(n&&this.showSearch&&this.showSearch(!0))):void(u.maximumInputLength&&c.val().length>u.maximumInputLength?a(S(u.formatInputTooLong,"formatInputTooLong")?"<li class='select2-no-results'>"+C(u.formatInputTooLong,u.element,c.val(),u.maximumInputLength)+"</li>":""):(u.formatSearching&&0===this.findHighlightableChoices().length&&a("<li class='select2-searching'>"+C(u.formatSearching,u.element)+"</li>"),c.addClass("select2-active"),this.removeHighlight(),(s=this.tokenize())!=t&&null!=s&&c.val(s),this.resultsPage=1,u.query({element:u.element,term:c.val(),page:this.resultsPage,context:null,matcher:u.matcher,callback:this.bind(function(o){var s;if(l==this.queryCount)if(this.opened())if(o.hasError!==t&&S(u.formatAjaxError,"formatAjaxError"))a("<li class='select2-ajax-error'>"+C(u.formatAjaxError,u.element,o.jqXHR,o.textStatus,o.errorThrown)+"</li>");else{if(this.context=o.context===t?null:o.context,this.opts.createSearchChoice&&""!==c.val()&&(s=this.opts.createSearchChoice.call(h,c.val(),o.results))!==t&&null!==s&&h.id(s)!==t&&null!==h.id(s)&&0===e(o.results).filter(function(){return r(h.id(this),h.id(s))}).length&&this.opts.createSearchChoicePosition(o.results,s),0===o.results.length&&S(u.formatNoMatches,"formatNoMatches"))return a("<li class='select2-no-results'>"+C(u.formatNoMatches,u.element,c.val())+"</li>"),void(this.showSearch&&this.showSearch(c.val()));d.empty(),h.opts.populateResults.call(this,d,o.results,{term:c.val(),page:this.resultsPage,context:null}),!0===o.more&&S(u.formatLoadMore,"formatLoadMore")&&(d.append("<li class='select2-more-results'>"+u.escapeMarkup(C(u.formatLoadMore,u.element,this.resultsPage))+"</li>"),window.setTimeout(function(){h.loadMoreIfNeeded()},10)),this.postprocessResults(o,n),i(),this.opts.element.trigger({type:"select2-loaded",items:o})}else this.search.removeClass("select2-active")})})));a("<li class='select2-selection-limit'>"+C(u.formatSelectionTooBig,u.element,m)+"</li>")}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){p(this.search)},selectHighlighted:function(e){if(this._touchMoved)this.clearTouchMoved();else{var t=this.highlight(),n=this.results.find(".select2-highlighted").closest(".select2-result").data("select2-data");n?(this.highlight(t),this.onSelect(n,e)):e&&e.noFocus&&this.close()}},getPlaceholder:function(){var e;return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder||((e=this.getPlaceholderOption())!==t?e.text():t)},getPlaceholderOption:function(){if(this.select){var n=this.select.children("option").first();if(this.opts.placeholderOption!==t)return"first"===this.opts.placeholderOption&&n||"function"==typeof this.opts.placeholderOption&&this.opts.placeholderOption(this.select);if(""===e.trim(n.text())&&""===n.val())return n}},initContainerWidth:function(){var t=function(){var t,n,i,a,o,r;if("off"===this.opts.width)return null;if("element"===this.opts.width)return 0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px";if("copy"===this.opts.width||"resolve"===this.opts.width){if("string"==typeof(t=this.opts.element.attr("style")))for(a=0,o=(n=t.split(";")).length;a<o;a+=1)if(r=n[a].replace(/\s/g,""),null!==(i=r.match(/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i))&&i.length>=1)return i[1];return"resolve"===this.opts.width?(t=this.opts.element.css("width")).indexOf("%")>0?t:0===this.opts.element.outerWidth(!1)?"auto":this.opts.element.outerWidth(!1)+"px":null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}.call(this);null!==t&&this.container.css("width",t)}}),{createContainer:function(){return e(document.createElement("div")).attr({class:"select2-container"}).html(["<a href='javascript:void(0)' class='select2-choice' tabindex='-1'>","   <span class='select2-chosen'>&#160;</span><abbr class='select2-search-choice-close'></abbr>","   <span class='select2-arrow' role='presentation'><b role='presentation'></b></span>","</a>","<label for='' class='select2-offscreen'></label>","<input class='select2-focusser select2-offscreen' type='text' aria-haspopup='true' role='button' />","<div class='select2-drop select2-display-none'>","   <div class='select2-search'>","       <label for='' class='select2-offscreen'></label>","       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input' role='combobox' aria-expanded='true'","       aria-autocomplete='list' />","   </div>","   <ul class='select2-results' role='listbox'>","   </ul>","</div>"].join(""))},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.focusser.prop("disabled",!this.isInterfaceEnabled())},opening:function(){var t,n,i;this.opts.minimumResultsForSearch>=0&&this.showSearch(!0),this.parent.opening.apply(this,arguments),!1!==this.showSearchInput&&this.search.val(this.focusser.val()),this.opts.shouldFocusInput(this)&&(this.search.focus(),(t=this.search.get(0)).createTextRange?((n=t.createTextRange()).collapse(!1),n.select()):t.setSelectionRange&&(i=this.search.val().length,t.setSelectionRange(i,i))),this.prefillNextSearchTerm(),this.focusser.prop("disabled",!0).val(""),this.updateResults(!0),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},focus:function(){this.opened()?this.close():(this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.prop("disabled",!1),this.opts.shouldFocusInput(this)&&this.focusser.focus()},destroy:function(){e("label[for='"+this.focusser.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),D.call(this,"selection","focusser")},initContainer:function(){var t,i,a=this.container,o=this.dropdown,r=M();this.opts.minimumResultsForSearch<0?this.showSearch(!1):this.showSearch(!0),this.selection=t=a.find(".select2-choice"),this.focusser=a.find(".select2-focusser"),t.find(".select2-chosen").attr("id","select2-chosen-"+r),this.focusser.attr("aria-labelledby","select2-chosen-"+r),this.results.attr("id","select2-results-"+r),this.search.attr("aria-owns","select2-results-"+r),this.focusser.attr("id","s2id_autogen"+r),i=e("label[for='"+this.opts.element.attr("id")+"']"),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.focusser.prev().text(i.text()).attr("for",this.focusser.attr("id"));var s=this.opts.element.attr("title");this.opts.element.attr("title",s||i.text()),this.focusser.attr("tabindex",this.elementTabIndex),this.search.attr("id",this.focusser.attr("id")+"_search"),this.search.prev().text(e("label[for='"+this.focusser.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&229!=e.keyCode)if(e.which!==_.PAGE_UP&&e.which!==_.PAGE_DOWN)switch(e.which){case _.UP:case _.DOWN:return this.moveHighlight(e.which===_.UP?-1:1),void m(e);case _.ENTER:return this.selectHighlighted(),void m(e);case _.TAB:return void this.selectHighlighted({noFocus:!0});case _.ESC:return this.cancel(e),void m(e)}else m(e)})),this.search.on("blur",this.bind(function(e){document.activeElement===this.body.get(0)&&window.setTimeout(this.bind(function(){this.opened()&&this.results&&this.results.length>1&&this.search.focus()}),0)})),this.focusser.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()&&e.which!==_.TAB&&!_.isControl(e)&&!_.isFunctionKey(e)&&e.which!==_.ESC){if(!1!==this.opts.openOnEnter||e.which!==_.ENTER){if(e.which==_.DOWN||e.which==_.UP||e.which==_.ENTER&&this.opts.openOnEnter){if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return;return this.open(),void m(e)}return e.which==_.DELETE||e.which==_.BACKSPACE?(this.opts.allowClear&&this.clear(),void m(e)):void 0}m(e)}})),c(this.focusser),this.focusser.on("keyup-change input",this.bind(function(e){if(this.opts.minimumResultsForSearch>=0){if(e.stopPropagation(),this.opened())return;this.open()}})),t.on("mousedown touchstart","abbr",this.bind(function(e){this.isInterfaceEnabled()&&(this.clear(),g(e),this.close(),this.selection&&this.selection.focus())})),t.on("mousedown touchstart",this.bind(function(i){n(t),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.opened()?this.close():this.isInterfaceEnabled()&&this.open(),m(i)})),o.on("mousedown touchstart",this.bind(function(){this.opts.shouldFocusInput(this)&&this.search.focus()})),t.on("focus",this.bind(function(e){m(e)})),this.focusser.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})).on("blur",this.bind(function(){this.opened()||(this.container.removeClass("select2-container-active"),this.opts.element.trigger(e.Event("select2-blur")))})),this.search.on("focus",this.bind(function(){this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.opts.element.hide(),this.setPlaceholder()},clear:function(t){var n=this.selection.data("select2-data");if(n){var i=e.Event("select2-clearing");if(this.opts.element.trigger(i),i.isDefaultPrevented())return;var a=this.getPlaceholderOption();this.opts.element.val(a?a.val():""),this.selection.find(".select2-chosen").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),!1!==t&&(this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}))}},initSelection:function(){if(this.isPlaceholderOptionSelected())this.updateSelection(null),this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.setPlaceholder(),e.lastSearchTerm=e.search.val())})}},isPlaceholderOptionSelected:function(){var e;return this.getPlaceholder()!==t&&((e=this.getPlaceholderOption())!==t&&e.prop("selected")||""===this.opts.element.val()||this.opts.element.val()===t||null===this.opts.element.val())},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=e.find("option").filter(function(){return this.selected&&!this.disabled});t(n.optionToData(i))}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var a=n.val(),o=null;t.query({matcher:function(e,n,i){var s=r(a,t.id(i));return s&&(o=i),s},callback:e.isFunction(i)?function(){i(o)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.getPlaceholderOption()===t?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.isPlaceholderOptionSelected()&&e!==t){if(this.select&&this.getPlaceholderOption()===t)return;this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.container.removeClass("select2-allowclear")}},postprocessResults:function(e,t,n){var i=0,a=this;if(this.findHighlightableChoices().each2(function(e,t){if(r(a.id(t.data("select2-data")),a.opts.element.val()))return i=e,!1}),!1!==n&&(!0===t&&i>=0?this.highlight(i):this.highlight(0)),!0===t){var o=this.opts.minimumResultsForSearch;o>=0&&this.showSearch(E(e.results)>=o)}},showSearch:function(t){this.showSearchInput!==t&&(this.showSearchInput=t,this.dropdown.find(".select2-search").toggleClass("select2-search-hidden",!t),this.dropdown.find(".select2-search").toggleClass("select2-offscreen",!t),e(this.dropdown,this.container).toggleClass("select2-with-searchbox",t))},onSelect:function(e,t){if(this.triggerSelect(e)){var n=this.opts.element.val(),i=this.data();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"select2-selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.close(),t&&t.noFocus||!this.opts.shouldFocusInput(this)||this.focusser.focus(),r(n,this.id(e))||this.triggerChange({added:e,removed:i})}},updateSelection:function(e){var n,i,a=this.selection.find(".select2-chosen");this.selection.data("select2-data",e),a.empty(),null!==e&&(n=this.opts.formatSelection(e,a,this.opts.escapeMarkup)),n!==t&&a.append(n),(i=this.opts.formatSelectionCssClass(e,a))!==t&&a.addClass(i),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.container.addClass("select2-allowclear")},val:function(){var e,n=!1,i=null,a=this,o=this.data();if(0===arguments.length)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(n=arguments[1],this.opts.debug&&console&&console.warn&&console.warn('Select2: The second option to `select2("val")` is not supported in Select2 4.0.0. The `change` event will always be triggered in 4.0.0.')),this.select)this.opts.debug&&console&&console.warn&&console.warn('Select2: Setting the value on a <select> using `select2("val")` is no longer supported in 4.0.0. You can use the `.val(newValue).trigger("change")` method provided by jQuery instead.'),this.select.val(e).find("option").filter(function(){return this.selected}).each2(function(e,t){return i=a.optionToData(t),!1}),this.updateSelection(i),this.setPlaceholder(),n&&this.triggerChange({added:i,removed:o});else{if(!e&&0!==e)return void this.clear(n);if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){a.opts.element.val(e?a.id(e):""),a.updateSelection(e),a.setPlaceholder(),n&&a.triggerChange({added:e,removed:o})})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var n,i=!1;if(0===arguments.length)return(n=this.selection.data("select2-data"))==t&&(n=null),n;this.opts.debug&&console&&console.warn&&console.warn('Select2: The `select2("data")` method can no longer set selected values in 4.0.0, consider using the `.val()` method instead.'),arguments.length>1&&(i=arguments[1]),e?(n=this.data(),this.opts.element.val(e?this.id(e):""),this.updateSelection(e),i&&this.triggerChange({added:e,removed:n})):this.clear(i)}}),I=O($,{createContainer:function(){return e(document.createElement("div")).attr({class:"select2-container select2-container-multi"}).html(["<ul class='select2-choices'>","  <li class='select2-search-field'>","    <label for='' class='select2-offscreen'></label>","    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi select2-display-none'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""))},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments),n=this;return"select"===t.element.get(0).tagName.toLowerCase()?t.initSelection=function(e,t){var i=[];e.find("option").filter(function(){return this.selected&&!this.disabled}).each2(function(e,t){i.push(n.optionToData(t))}),t(i)}:"data"in t&&(t.initSelection=t.initSelection||function(n,i){var a=s(n.val(),t.separator,t.transformVal),o=[];t.query({matcher:function(n,i,s){var l=e.grep(a,function(e){return r(e,t.id(s))}).length;return l&&o.push(s),l},callback:e.isFunction(i)?function(){for(var e=[],n=0;n<a.length;n++)for(var s=a[n],l=0;l<o.length;l++){var c=o[l];if(r(s,t.id(c))){e.push(c),o.splice(l,1);break}}i(e)}:e.noop})}),t},selectChoice:function(e){var t=this.container.find(".select2-search-choice-focus");t.length&&e&&e[0]==t[0]||(t.length&&this.opts.element.trigger("choice-deselected",t),t.removeClass("select2-search-choice-focus"),e&&e.length&&(this.close(),e.addClass("select2-search-choice-focus"),this.opts.element.trigger("choice-selected",e)))},destroy:function(){e("label[for='"+this.search.attr("id")+"']").attr("for",this.opts.element.attr("id")),this.parent.destroy.apply(this,arguments),D.call(this,"searchContainer","selection")},initContainer:function(){var t,n=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(n);var i=this;this.selection.on("click",".select2-container:not(.select2-container-disabled) .select2-search-choice:not(.select2-locked)",function(t){i.search[0].focus(),i.selectChoice(e(this))}),this.search.attr("id","s2id_autogen"+M()),this.search.prev().text(e("label[for='"+this.opts.element.attr("id")+"']").text()).attr("for",this.search.attr("id")),this.opts.element.on("focus.select2",this.bind(function(){this.focus()})),this.search.on("input paste",this.bind(function(){this.search.attr("placeholder")&&0==this.search.val().length||this.isInterfaceEnabled()&&(this.opened()||this.open())})),this.search.attr("tabindex",this.elementTabIndex),this.keydowns=0,this.search.on("keydown",this.bind(function(e){if(this.isInterfaceEnabled()){++this.keydowns;var n=t.find(".select2-search-choice-focus"),i=n.prev(".select2-search-choice:not(.select2-locked)"),a=n.next(".select2-search-choice:not(.select2-locked)"),o=f(this.search);if(n.length&&(e.which==_.LEFT||e.which==_.RIGHT||e.which==_.BACKSPACE||e.which==_.DELETE||e.which==_.ENTER)){var r=n;return e.which==_.LEFT&&i.length?r=i:e.which==_.RIGHT?r=a.length?a:null:e.which===_.BACKSPACE?this.unselect(n.first())&&(this.search.width(10),r=i.length?i:a):e.which==_.DELETE?this.unselect(n.first())&&(this.search.width(10),r=a.length?a:null):e.which==_.ENTER&&(r=null),this.selectChoice(r),m(e),void(r&&r.length||this.open())}if((e.which===_.BACKSPACE&&1==this.keydowns||e.which==_.LEFT)&&0==o.offset&&!o.length)return this.selectChoice(t.find(".select2-search-choice:not(.select2-locked)").last()),void m(e);if(this.selectChoice(null),this.opened())switch(e.which){case _.UP:case _.DOWN:return this.moveHighlight(e.which===_.UP?-1:1),void m(e);case _.ENTER:return this.selectHighlighted(),void m(e);case _.TAB:return this.selectHighlighted({noFocus:!0}),void this.close();case _.ESC:return this.cancel(e),void m(e)}if(e.which!==_.TAB&&!_.isControl(e)&&!_.isFunctionKey(e)&&e.which!==_.BACKSPACE&&e.which!==_.ESC){if(e.which===_.ENTER){if(!1===this.opts.openOnEnter)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),e.which!==_.PAGE_UP&&e.which!==_.PAGE_DOWN||m(e),e.which===_.ENTER&&m(e)}}})),this.search.on("keyup",this.bind(function(e){this.keydowns=0,this.resizeSearch()})),this.search.on("blur",this.bind(function(t){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.selectChoice(null),this.opened()||this.clearSearch(),t.stopImmediatePropagation(),this.opts.element.trigger(e.Event("select2-blur"))})),this.container.on("click",n,this.bind(function(t){this.isInterfaceEnabled()&&(e(t.target).closest(".select2-search-choice").length>0||(this.selectChoice(null),this.clearPlaceholder(),this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.on("focus",n,this.bind(function(){this.isInterfaceEnabled()&&(this.container.hasClass("select2-container-active")||this.opts.element.trigger(e.Event("select2-focus")),this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.opts.element.hide(),this.clearSearch()},enableInterface:function(){this.parent.enableInterface.apply(this,arguments)&&this.search.prop("disabled",!this.isInterfaceEnabled())},initSelection:function(){if(""===this.opts.element.val()&&""===this.opts.element.text()&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||""!==this.opts.element.val()){var e=this;this.opts.initSelection.call(null,this.opts.element,function(n){n!==t&&null!==n&&(e.updateSelection(n),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder(),n=this.getMaxSearchWidth();e!==t&&0===this.getVal().length&&!1===this.search.hasClass("select2-focused")?(this.search.val(e).addClass("select2-default"),this.search.width(n>0?n:this.container.css("width"))):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.prefillNextSearchTerm(),this.updateResults(!0),this.opts.shouldFocusInput(this)&&this.search.focus(),this.opts.element.trigger(e.Event("select2-open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var n={},i=[],a=this;e(t).each(function(){a.id(this)in n||(n[a.id(this)]=0,i.push(this))}),this.selection.find(".select2-search-choice").remove(),this.addSelectedChoice(i),a.postprocessResults()},tokenize:function(){var e=this.search.val();null!=(e=this.opts.tokenizer.call(this,e,this.data(),this.bind(this.onSelect),this.opts))&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.triggerSelect(e)&&""!==e.text&&(this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.lastSearchTerm=this.search.val(),this.clearSearch(),this.updateResults(),!this.select&&this.opts.closeOnSelect||this.postprocessResults(e,!1,!0===this.opts.closeOnSelect),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()?this.updateResults(!0):this.prefillNextSearchTerm()&&this.updateResults(),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch())},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(t){var n=this.getVal(),i=this;e(t).each(function(){n.push(i.createChoice(this))}),this.setVal(n)},createChoice:function(n){var i,a,o=!n.locked,r=e("<li class='select2-search-choice'>    <div></div>    <a href='#' class='select2-search-choice-close' tabindex='-1'></a></li>"),s=e("<li class='select2-search-choice select2-locked'><div></div></li>"),l=o?r:s,c=this.id(n);return(i=this.opts.formatSelection(n,l.find("div"),this.opts.escapeMarkup))!=t&&l.find("div").replaceWith(e("<div></div>").html(i)),(a=this.opts.formatSelectionCssClass(n,l.find("div")))!=t&&l.addClass(a),o&&l.find(".select2-search-choice-close").on("mousedown",m).on("click dblclick",this.bind(function(t){this.isInterfaceEnabled()&&(this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),m(t),this.close(),this.focusSearch())})).on("focus",this.bind(function(){this.isInterfaceEnabled()&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),l.data("select2-data",n),l.insertBefore(this.searchContainer),c},unselect:function(t){var n,i,o=this.getVal();if(0===(t=t.closest(".select2-search-choice")).length)throw"Invalid argument: "+t+". Must be .select2-search-choice";if(n=t.data("select2-data")){var r=e.Event("select2-removing");if(r.val=this.id(n),r.choice=n,this.opts.element.trigger(r),r.isDefaultPrevented())return!1;for(;(i=a(this.id(n),o))>=0;)o.splice(i,1),this.setVal(o),this.select&&this.postprocessResults();return t.remove(),this.opts.element.trigger({type:"select2-removed",val:this.id(n),choice:n}),this.triggerChange({removed:n}),!0}},postprocessResults:function(e,t,n){var i=this.getVal(),o=this.results.find(".select2-result"),r=this.results.find(".select2-result-with-children"),s=this;o.each2(function(e,t){a(s.id(t.data("select2-data")),i)>=0&&(t.addClass("select2-selected"),t.find(".select2-result-selectable").addClass("select2-selected"))}),r.each2(function(e,t){t.is(".select2-result-selectable")||0!==t.find(".select2-result-selectable:not(.select2-selected)").length||t.addClass("select2-selected")}),-1==this.highlight()&&!1!==n&&!0===this.opts.closeOnSelect&&s.highlight(0),!this.opts.createSearchChoice&&!o.filter(".select2-result:not(.select2-selected)").length>0&&(!e||e&&!e.more&&0===this.results.find(".select2-no-results").length)&&S(s.opts.formatNoMatches,"formatNoMatches")&&this.results.append("<li class='select2-no-results'>"+C(s.opts.formatNoMatches,s.opts.element,s.search.val())+"</li>")},getMaxSearchWidth:function(){return this.selection.width()-l(this.search)},resizeSearch:function(){var e,t,n,i,a=l(this.search);e=v(this.search)+10,t=this.search.offset().left,(i=(n=this.selection.width())-(t-this.selection.offset().left)-a)<e&&(i=n-a),i<40&&(i=n-a),i<=0&&(i=e),this.search.width(Math.floor(i))},getVal:function(){var e;return this.select?null===(e=this.select.val())?[]:e:(e=this.opts.element.val(),s(e,this.opts.separator,this.opts.transformVal))},setVal:function(t){if(this.select)this.select.val(t);else{var n=[],i={};e(t).each(function(){this in i||(n.push(this),i[this]=0)}),this.opts.element.val(0===n.length?"":n.join(this.opts.separator))}},buildChangeDetails:function(e,t){for(var t=t.slice(0),e=e.slice(0),n=0;n<t.length;n++)for(var i=0;i<e.length;i++)if(r(this.opts.id(t[n]),this.opts.id(e[i]))){t.splice(n,1),n--,e.splice(i,1);break}return{added:t,removed:e}},val:function(n,i){var a,o=this;if(0===arguments.length)return this.getVal();if((a=this.data()).length||(a=[]),!n&&0!==n)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),void(i&&this.triggerChange({added:this.data(),removed:a}));if(this.setVal(n),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),i&&this.triggerChange(this.buildChangeDetails(a,this.data()));else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var n=e.map(t,o.id);o.setVal(n),o.updateSelection(t),o.clearSearch(),i&&o.triggerChange(o.buildChangeDetails(a,o.data()))})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],n=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(n.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t,n){var i,a,o=this;if(0===arguments.length)return this.selection.children(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get();a=this.data(),t||(t=[]),i=e.map(t,function(e){return o.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),n&&this.triggerChange(this.buildChangeDetails(a,this.data()))}}),e.fn.select2=function(){var n,i,o,r,s,l=Array.prototype.slice.call(arguments,0),c=["val","destroy","opened","open","close","focus","isFocused","container","dropdown","onSortStart","onSortEnd","enable","disable","readonly","positionDropdown","data","search"],d=["opened","isFocused","container","dropdown"],u=["val","data"],h={search:"externalSearch"};return this.each(function(){if(0===l.length||"object"==typeof l[0])(n=0===l.length?{}:e.extend({},l[0])).element=e(this),"select"===n.element.get(0).tagName.toLowerCase()?s=n.element.prop("multiple"):(s=n.multiple||!1,"tags"in n&&(n.multiple=s=!0)),(i=s?new window.Select2.class.multi:new window.Select2.class.single).init(n);else{if("string"!=typeof l[0])throw"Invalid arguments to select2 plugin: "+l;if(a(l[0],c)<0)throw"Unknown method: "+l[0];if(r=t,(i=e(this).data("select2"))===t)return;if("container"===(o=l[0])?r=i.container:"dropdown"===o?r=i.dropdown:(h[o]&&(o=h[o]),r=i[o].apply(i,l.slice(1))),a(l[0],d)>=0||a(l[0],u)>=0&&1==l.length)return!1}}),r===t?this:r},e.fn.select2.defaults={debug:!1,width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,n,i){var a=[];return b(this.text(e),n.term,a,i),a.join("")},transformVal:function(t){return e.trim(t)},formatSelection:function(e,n,i){return e?i(this.text(e)):t},sortResults:function(e,t,n){return e},formatResultCssClass:function(e){return e.css},formatSelectionCssClass:function(e,n){return t},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e==t?null:e.id},text:function(t){return t&&this.data&&this.data.text?e.isFunction(this.data.text)?this.data.text(t):t[this.data.text]:t.text},matcher:function(e,t){return i(""+t).toUpperCase().indexOf(i(""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:function(e,n,i,a){var o,s,l,c,d,u=e,h=!1;if(!a.createSearchChoice||!a.tokenSeparators||a.tokenSeparators.length<1)return t;for(;;){for(s=-1,l=0,c=a.tokenSeparators.length;l<c&&(d=a.tokenSeparators[l],!((s=e.indexOf(d))>=0));l++);if(s<0)break;if(o=e.substring(0,s),e=e.substring(s+d.length),o.length>0&&(o=a.createSearchChoice.call(this,o,n))!==t&&null!==o&&a.id(o)!==t&&null!==a.id(o)){for(h=!1,l=0,c=n.length;l<c;l++)if(r(a.id(o),a.id(n[l]))){h=!0;break}h||i(o)}}return u!==e?e:void 0},escapeMarkup:w,blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(e){return null},nextSearchTerm:function(e,n){return t},searchInputPlaceholder:"",createSearchChoicePosition:"top",shouldFocusInput:function(e){return!("ontouchstart"in window||navigator.msMaxTouchPoints>0)||!(e.opts.minimumResultsForSearch<0)}},e.fn.select2.locales=[],e.fn.select2.locales.en={formatMatches:function(e){return 1===e?"One result is available, press enter to select it.":e+" results are available, use up and down arrow keys to navigate."},formatNoMatches:function(){return"No matches found"},formatAjaxError:function(e,t,n){return"Loading failed"},formatInputTooShort:function(e,t){var n=t-e.length;return"Please enter "+n+" or more character"+(1==n?"":"s")},formatInputTooLong:function(e,t){var n=e.length-t;return"Please delete "+n+" character"+(1==n?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(e){return"Loading more results…"},formatSearching:function(){return"Searching…"}},e.extend(e.fn.select2.defaults,e.fn.select2.locales.en),e.fn.select2.ajaxDefaults={transport:e.ajax,params:{type:"GET",cache:!1,dataType:"json"}},window.Select2={query:{ajax:k,local:x,tags:T},util:{debounce:u,markMatch:b,escapeMarkup:w,stripDiacritics:i},class:{abstract:$,single:A,multi:I}}}}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery.event.drag",["jquery"],function(){return function(){!function(e){e.fn.drag=function(t,n,i){var a="string"==typeof t?t:"",o=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==a.indexOf("drag")&&(a="drag"+a),i=(t==o?n:i)||{},o?this.bind(a,i,o):this.trigger(a)};var t=e.event,n=t.special,i=n.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var n=e.data(this,i.datakey),a=t.data||{};n.related+=1,e.each(i.defaults,function(e,t){void 0!==a[e]&&(n[e]=a[e])})},remove:function(){e.data(this,i.datakey).related-=1},setup:function(){if(!e.data(this,i.datakey)){var n=e.extend({related:0},i.defaults);e.data(this,i.datakey,n),t.add(this,"touchstart mousedown",i.init,n),this.attachEvent&&this.attachEvent("ondragstart",i.dontstart)}},teardown:function(){(e.data(this,i.datakey)||{}).related||(e.removeData(this,i.datakey),t.remove(this,"touchstart mousedown",i.init),i.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",i.dontstart))},init:function(a){if(!i.touched){var o,r=a.data;if(!(0!=a.which&&r.which>0&&a.which!=r.which)&&!e(a.target).is(r.not)&&(!r.handle||e(a.target).closest(r.handle,a.currentTarget).length)&&(i.touched="touchstart"==a.type?this:null,r.propagates=1,r.mousedown=this,r.interactions=[i.interaction(this,r)],r.target=a.target,r.pageX=a.pageX,r.pageY=a.pageY,r.dragging=null,o=i.hijack(a,"draginit",r),r.propagates))return(o=i.flatten(o))&&o.length&&(r.interactions=[],e.each(o,function(){r.interactions.push(i.interaction(this,r))})),r.propagates=r.interactions.length,!1!==r.drop&&n.drop&&n.drop.handler(a,r),i.textselect(!1),i.touched?t.add(i.touched,"touchmove touchend",i.handler,r):t.add(document,"mousemove mouseup",i.handler,r),!(!i.touched||r.live)&&void 0}},interaction:function(t,n){var a=e(t)[n.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new i.callback,droppable:[],offset:a}},handler:function(a){var o=a.data;switch(a.type){case!o.dragging&&"touchmove":a.preventDefault();case!o.dragging&&"mousemove":if(Math.pow(a.pageX-o.pageX,2)+Math.pow(a.pageY-o.pageY,2)<Math.pow(o.distance,2))break;a.target=o.target,i.hijack(a,"dragstart",o),o.propagates&&(o.dragging=!0);case"touchmove":a.preventDefault();case"mousemove":if(o.dragging){if(i.hijack(a,"drag",o),o.propagates){!1!==o.drop&&n.drop&&n.drop.handler(a,o);break}a.type="mouseup"}case"touchend":case"mouseup":default:i.touched?t.remove(i.touched,"touchmove touchend",i.handler):t.remove(document,"mousemove mouseup",i.handler),o.dragging&&(!1!==o.drop&&n.drop&&n.drop.handler(a,o),i.hijack(a,"dragend",o)),i.textselect(!0),!1===o.click&&o.dragging&&e.data(o.mousedown,"suppress.click",(new Date).getTime()+5),o.dragging=i.touched=!1}},hijack:function(n,a,o,r,s){if(o){var l,c,d,u={event:n.originalEvent,type:n.type},h=a.indexOf("drop")?"drag":"drop",p=r||0,f=isNaN(r)?o.interactions.length:r;n.type=a,n.originalEvent=null,o.results=[];do{if(c=o.interactions[p]){if("dragend"!==a&&c.cancelled)continue;d=i.properties(n,o,c),c.results=[],e(s||c[h]||o.droppable).each(function(r,s){if(d.target=s,n.isPropagationStopped=function(){return!1},!1===(l=s?t.dispatch.call(s,n,d):null)?("drag"==h&&(c.cancelled=!0,o.propagates-=1),"drop"==a&&(c[h][r]=null)):"dropinit"==a&&c.droppable.push(i.element(l)||s),"dragstart"==a&&(c.proxy=e(i.element(l)||c.drag)[0]),c.results.push(l),delete n.result,"dropinit"!==a)return l}),o.results[p]=i.flatten(c.results),"dropinit"==a&&(c.droppable=i.flatten(c.droppable)),"dragstart"!=a||c.cancelled||d.update()}}while(++p<f);return n.type=u.type,n.originalEvent=u.event,i.flatten(o.results)}},properties:function(e,t,n){var a=n.callback;return a.drag=n.drag,a.proxy=n.proxy||n.drag,a.startX=t.pageX,a.startY=t.pageY,a.deltaX=e.pageX-t.pageX,a.deltaY=e.pageY-t.pageY,a.originalX=n.offset.left,a.originalY=n.offset.top,a.offsetX=a.originalX+a.deltaX,a.offsetY=a.originalY+a.deltaY,a.drop=i.flatten((n.drop||[]).slice()),a.available=i.flatten((n.droppable||[]).slice()),a},element:function(e){if(e&&(e.jquery||1==e.nodeType))return e},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?i.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",i.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};i.callback.prototype={update:function(){n.drop&&this.available.length&&e.each(this.available,function(e){n.drop.locate(this,e)})}};var a=t.dispatch;t.dispatch=function(t){if(!(e.data(this,"suppress."+t.type)-(new Date).getTime()>0))return a.apply(this,arguments);e.removeData(this,"suppress."+t.type)};var o=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,n){if(n){var i=n.touches&&n.touches[0]||n.changedTouches&&n.changedTouches[0]||null;i&&e.each(o.props,function(e,n){t[n]=i[n]})}return t}}}(jQuery)}.apply(e,arguments)})}(this),function(e){define("jquery.event.drop",["jquery"],function(){return function(){return function(e){e.fn.drop=function(t,n,i){var a="string"==typeof t?t:"",o=e.isFunction(t)?t:e.isFunction(n)?n:null;return 0!==a.indexOf("drop")&&(a="drop"+a),i=(t==o?n:i)||{},o?this.bind(a,i,o):this.trigger(a)},e.drop=function(t){t=t||{},n.multi=!0===t.multi?1/0:!1===t.multi?1:isNaN(t.multi)?n.multi:t.multi,n.delay=t.delay||n.delay,n.tolerance=e.isFunction(t.tolerance)?t.tolerance:null===t.tolerance?null:n.tolerance,n.mode=t.mode||n.mode||"intersect"};var t=e.event.special,n=e.event.special.drop={multi:1,delay:20,mode:"overlap",targets:[],datakey:"dropdata",noBubble:!0,add:function(t){e.data(this,n.datakey).related+=1},remove:function(){e.data(this,n.datakey).related-=1},setup:function(){if(!e.data(this,n.datakey)){var t={related:0,active:[],anyactive:0,winner:0,location:{}};e.data(this,n.datakey,t),n.targets.push(this)}},teardown:function(){if(!(e.data(this,n.datakey)||{}).related){e.removeData(this,n.datakey);var t=this;n.targets=e.grep(n.targets,function(e){return e!==t})}},handler:function(i,a){var o;if(a)switch(i.type){case"mousedown":case"touchstart":o=e(n.targets),"string"==typeof a.drop&&(o=o.filter(a.drop)),o.each(function(){var t=e.data(this,n.datakey);t.active=[],t.anyactive=0,t.winner=0}),a.droppable=o,t.drag.hijack(i,"dropinit",a);break;case"mousemove":case"touchmove":n.event=i,n.timer||n.tolerate(a);break;case"mouseup":case"touchend":n.timer=clearTimeout(n.timer),a.propagates&&(t.drag.hijack(i,"drop",a),t.drag.hijack(i,"dropend",a))}},locate:function(t,i){var a=e.data(t,n.datakey),o=e(t),r=o.offset()||{},s=o.outerHeight(),l=o.outerWidth(),c={elem:t,width:l,height:s,top:r.top,left:r.left,right:r.left+l,bottom:r.top+s};return a&&(a.location=c,a.index=i,a.elem=t),c},contains:function(e,t){return(t[0]||t.left)>=e.left&&(t[0]||t.right)<=e.right&&(t[1]||t.top)>=e.top&&(t[1]||t.bottom)<=e.bottom},modes:{intersect:function(e,t,n){return this.contains(n,[e.pageX,e.pageY])?1e9:this.modes.overlap.apply(this,arguments)},overlap:function(e,t,n){return Math.max(0,Math.min(n.bottom,t.bottom)-Math.max(n.top,t.top))*Math.max(0,Math.min(n.right,t.right)-Math.max(n.left,t.left))},fit:function(e,t,n){return this.contains(n,t)?1:0},middle:function(e,t,n){return this.contains(n,[t.left+.5*t.width,t.top+.5*t.height])?1:0}},sort:function(e,t){return t.winner-e.winner||e.index-t.index},tolerate:function(i){var a,o,r,s,l,c,d,u,h=0,p=i.interactions.length,f=[n.event.pageX,n.event.pageY],m=n.tolerance||n.modes[n.mode];do{if(u=i.interactions[h]){if(!u)return;u.drop=[],l=[],c=u.droppable.length,m&&(r=n.locate(u.proxy)),a=0;do{if(d=u.droppable[a]){if(s=e.data(d,n.datakey),!(o=s.location))continue;s.winner=m?m.call(n,n.event,r,o):n.contains(o,f)?1:0,l.push(s)}}while(++a<c);l.sort(n.sort),a=0;do{(s=l[a])&&(s.winner&&u.drop.length<n.multi?(s.active[h]||s.anyactive||(!1!==t.drag.hijack(n.event,"dropstart",i,h,s.elem)[0]?(s.active[h]=1,s.anyactive+=1):s.winner=0),s.winner&&u.drop.push(s.elem)):s.active[h]&&1==s.anyactive&&(t.drag.hijack(n.event,"dropend",i,h,s.elem),s.active[h]=0,s.anyactive-=1))}while(++a<c)}}while(++h<p);n.last&&f[0]==n.last.pageX&&f[1]==n.last.pageY?delete n.timer:n.timer=setTimeout(function(){n.tolerate(i)},n.delay),n.last=n.event}};t.dropinit=t.dropstart=t.dropend=n}(jQuery),$.drop}.apply(e,arguments)})}(this),define("mockup-patterns-select2",["jquery","pat-base","mockup-utils","select2","jquery.event.drag","jquery.event.drop"],function(e,t,n){"use strict";return t.extend({name:"select2",trigger:".pat-select2",parser:"mockup",defaults:{separator:","},initializeValues:function(){var t=this;t.options.initialValues&&(t.options.id=function(e){return e.id},t.options.initSelection=function(i,a){var o=[],r=i.val(),s=t.options.initialValues;"string"==typeof t.options.initialValues&&""!==t.options.initialValues&&("{"===t.options.initialValues[0]?s=JSON.parse(t.options.initialValues):(s={},e(t.options.initialValues.split(t.options.separator)).each(function(){var t=this.split(":"),n=e.trim(t[0]),i=e.trim(t[1]);s[n]=i}))),e(r.split(t.options.separator)).each(function(){var e=this;s[this]&&(e=s[this]),o.push({id:n.removeHTML(this),text:n.removeHTML(e)})}),a(o)})},initializeTags:function(){var t=this;t.options.tags&&"string"==typeof t.options.tags&&("["===t.options.tags.substr(0,1)?t.options.tags=JSON.parse(t.options.tags):t.options.tags=t.options.tags.split(t.options.separator)),t.options.tags&&!t.options.allowNewItems&&(t.options.data=e.map(t.options.tags,function(e,t){return{id:e,text:e}}),t.options.multiple=!0,delete t.options.tags)},initializeOrdering:function(){var t=this;if(t.options.orderable){var n=function(e,t){return e?e.text:void 0};t.options.formatSelection&&(n=t.options.formatSelection),t.options.formatSelection=function(i,a){return a.parents("li").drag("start",function(n,i){return e(this).addClass("select2-choice-dragging"),t.$el.select2("onSortStart"),e.drop({tolerance:function(t,n,i){var a=t.pageY>i.top+i.height/2;return e.data(i.elem,"drop+reorder",a?"insertAfter":"insertBefore"),this.contains(i,[t.pageX,t.pageY])}}),e(this).clone().addClass("dragging").css({opacity:.75,position:"absolute"}).appendTo(document.body)}).drag(function(t,n){e(n.proxy).css({top:n.offsetY,left:n.offsetX});var i=n.drop[0],a=e.data(i||{},"drop+reorder");!i||i==n.current&&a==n.method||(e(this)[a](i),n.current=i,n.method=a,n.update())}).drag("end",function(n,i){e(this).removeClass("select2-choice-dragging"),t.$el.select2("onSortEnd"),e(i.proxy).remove()}).drop("init",function(e,t){return this!=t.drag}),n(i,a)}}},initializeSelect2:function(){var e=this;e.options.formatResultCssClass=function(e){if(e.id)return"select2-option-"+e.id.toLowerCase().replace(/[ \:\)\(\[\]\{\}\_\+\=\&\*\%\#]/g,"-")},e.$el.select2(e.options),e.$select2=e.$el.parent().find(".select2-container"),e.$el.parent().off("close.plone-modal.patterns"),e.options.orderable&&e.$select2.addClass("select2-orderable")},opened:function(){return 1===e(".select2-dropdown-open",this.$el.parent()).length},init:function(){var t=this;if(t.options.allowNewItems=!t.options.hasOwnProperty("allowNewItems")||JSON.parse(t.options.allowNewItems),t.options.ajax||t.options.vocabularyUrl){t.options.vocabularyUrl&&(t.options.multiple=void 0===t.options.multiple||t.options.multiple,t.options.ajax=t.options.ajax||{},t.options.ajax.url=t.options.vocabularyUrl,t.options.initSelection=function(i,a){var o=[],r=i.val();e(r.split(t.options.separator)).each(function(){var e=n.removeHTML(this);o.push({id:e,text:e})}),a(o)});var i="";t.options.ajax=e.extend({quietMillis:300,data:function(e,t){return i=e,{query:e,page_limit:10,page:t}},results:function(a,o){var r=a.results;if(t.options.vocabularyUrl){var s=[];e.each(a.results,function(e,t){s.push(t.id)}),r=[];var l=""===i||e.inArray(i,s)>=0;t.options.allowNewItems&&!l&&(i=n.removeHTML(i),r.push({id:i,text:i})),e.each(a.results,function(e,t){r.push(t)})}return{results:r}}},t.options.ajax)}else if(t.options.multiple&&t.$el.is("select")){var a=t.$el.val()||[],o=e.map(t.$el.find("option"),function(t){return{text:e(t).html(),id:t.value}}),r=e('<input type="hidden" />');r.val(a.join(t.options.separator)),r.attr("class",t.$el.attr("class")),r.attr("name",t.$el.attr("name")),r.attr("id",t.$el.attr("id")),t.$orig=t.$el,t.$el.replaceWith(r),t.$el=r,t.options.data=o}t.initializeValues(),t.initializeTags(),t.initializeOrdering(),t.initializeSelect2()}})}),define("mockup-ui-url/views/base",["jquery","underscore","backbone","translate"],function(e,t,n,i){"use strict";return n.View.extend({isUIView:!0,eventPrefix:"ui",template:null,idPrefix:"base-",appendInContainer:!0,initialize:function(e){this.options=e;for(var t in this.options)this[t]=this.options[t];this.options._t=i},render:function(){return this.applyTemplate(),this.trigger("render",this),this.afterRender(),this.options.id&&this.$el.attr("id",this.idPrefix+this.options.id),this},afterRender:function(){},serializedModel:function(){return this.options},applyTemplate:function(){if(null!==this.template){var n=e.extend({_t:i},this.options,this.serializedModel()),a=this.template;"string"==typeof a&&(a=t.template(a)),this.$el.html(a(n))}},propagateEvent:function(e){if(e.indexOf(":")>0){var t=e.split(":")[0];if(""!==this.eventPrefix&&(t===this.eventPrefix||t===this.eventPrefix+"."+this.id))return!0}return!1},uiEventTrigger:function(e){var t=[].slice.call(arguments,0);""!==this.eventPrefix&&(t[0]=this.eventPrefix+":"+e,n.View.prototype.trigger.apply(this,t),this.id&&(t[0]=this.eventPrefix+"."+this.id+":"+e,n.View.prototype.trigger.apply(this,t)))}})}),define("mockup-patterns-tooltip",["jquery","pat-base"],function(e,t,n){"use strict";var i=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};return i.VERSION="3.2.0",i.DEFAULTS={animation:!0,placement:"auto",selector:!1,template:'<div class="tooltip mockup-tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!0,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(t,n,i){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(i),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var a=this.options.trigger.split(" "),o=a.length;o--;){var r=a[o];if("click"==r)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=r){var s="hover"==r?"mouseenter":"focusin",l="hover"==r?"mouseleave":"focusout";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(t){return(t=e.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},i.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,i){n[e]!=i&&(t[e]=i)}),t},i.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in",!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)},i.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out",!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)},i.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var n=e.contains(document.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!n)return;var i=this,a=this.tip(),o=this.getUID(this.type);this.setContent(),a.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&a.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,l=s.test(r);l&&(r=r.replace(s,"")||"top"),a.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?a.appendTo(this.options.container):a.insertAfter(this.$element);var c=this.getPosition(),d=a[0].offsetWidth,u=a[0].offsetHeight;if(l){var h=r,p=this.$element.parent(),f=this.getPosition(p);r="bottom"==r&&c.top+c.height+u-f.scroll>f.height?"top":"top"==r&&c.top-f.scroll-u<0?"bottom":"right"==r&&c.right+d>f.width?"left":"left"==r&&c.left-d<f.left?"right":r,a.removeClass(h).addClass(r)}var m=this.getCalculatedOffset(r,c,d,u);this.applyPlacement(m,r);var g=function(){i.$element.trigger("shown.bs."+i.type),i.hoverState=null};e.support.transition&&this.$tip.hasClass("fade")?a.one("bsTransitionEnd",g).emulateTransitionEnd(150):g()}},i.prototype.applyPlacement=function(t,n){var i=this.tip(),a=i[0].offsetWidth,o=i[0].offsetHeight,r=parseInt(i.css("margin-top"),10),s=parseInt(i.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(s)&&(s=0),t.top=t.top+r,t.left=t.left+s,e.offset.setOffset(i[0],e.extend({using:function(e){i.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),i.addClass("in");var l=i[0].offsetWidth,c=i[0].offsetHeight;"top"==n&&c!=o&&(t.top=t.top+o-c);var d=this.getViewportAdjustedDelta(n,t,l,c);d.left?t.left+=d.left:t.top+=d.top;var u=d.left?2*d.left-a+l:2*d.top-o+c,h=d.left?"left":"top",p=d.left?"offsetWidth":"offsetHeight";i.offset(t),this.replaceArrow(u,i[0][p],h)},i.prototype.replaceArrow=function(e,t,n){this.arrow().css(n,e?50*(1-e/t)+"%":"")},i.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},i.prototype.hide=function(){function t(){"in"!=n.hoverState&&i.detach(),n.$element.trigger("hidden.bs."+n.type)}var n=this,i=this.tip(),a=e.Event("hide.bs."+this.type);if(this.$element.removeAttr("aria-describedby"),this.$element.trigger(a),!a.isDefaultPrevented())return i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",t).emulateTransitionEnd(150):t(),this.hoverState=null,this},i.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(t){var n=(t=t||this.$element)[0],i="BODY"==n.tagName;return e.extend({},"function"==typeof n.getBoundingClientRect?n.getBoundingClientRect():null,{scroll:i?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop(),width:i?e(window).width():t.outerWidth(),height:i?e(window).height():t.outerHeight()},i?{top:0,left:0}:t.offset())},i.prototype.getCalculatedOffset=function(e,t,n,i){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-i,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-i/2,left:t.left-n}:{top:t.top+t.height/2-i/2,left:t.left+t.width}},i.prototype.getViewportAdjustedDelta=function(e,t,n,i){var a={top:0,left:0};if(!this.$viewport)return a;var o=this.options.viewport&&this.options.viewport.padding||0,r=this.getPosition(this.$viewport);if(/right|left/.test(e)){var s=t.top-o-r.scroll,l=t.top+o-r.scroll+i;s<r.top?a.top=r.top-s:l>r.top+r.height&&(a.top=r.top+r.height-l)}else{var c=t.left-o,d=t.left+o+n;c<r.left?a.left=r.left-c:d>r.width&&(a.left=r.left+r.width-d)}return a},i.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},i.prototype.getUID=function(e){do{e+=~~(1e6*Math.random())}while(document.getElementById(e));return e},i.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(t){var n=this;t&&((n=e(t.currentTarget).data("bs."+this.type))||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},i.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)},t.extend({name:"tooltip",trigger:".pat-tooltip",parser:"mockup",defaults:{html:!1,placement:"top"},init:function(){"true"===this.options.html?this.options.html=!0:this.options.html=!1,this.data=new i(this.$el[0],this.options)}})}),define("mockup-ui-url/views/button",["underscore","mockup-ui-url/views/base","mockup-patterns-tooltip"],function(e,t,n){"use strict";return t.extend({tagName:"a",className:"btn",eventPrefix:"button",context:"default",idPrefix:"btn-",attributes:{href:"#"},extraClasses:[],tooltip:null,template:'<% if (icon) { %><span class="glyphicon glyphicon-<%= icon %>"></span><% } %> <%= title %>',events:{click:"handleClick"},initialize:function(i){if(!i.id){var a=i.title||"";i.id=""!==a?a.toLowerCase().replace(" ","-"):this.cid}t.prototype.initialize.apply(this,[i]),this.on("render",function(){if(this.$el.attr("title",this.options.title||""),this.$el.attr("aria-label",this.options.title||this.options.tooltip||""),null!==this.context&&this.$el.addClass("btn-"+this.context),e.each(this.extraClasses,function(e){this.$el.addClass(e)}),null!==this.tooltip){this.$el.attr("title",this.tooltip);new n(this.$el);this.$el.on("hidden",function(e){"hidden"===e.type&&e.stopPropagation()})}},this)},handleClick:function(e){e.preventDefault(),this.$el.prop("disabled")||this.uiEventTrigger("click",this,e)},serializedModel:function(){return e.extend({icon:"",title:""},this.options)},disable:function(){this.$el.prop("disabled",!0)},enable:function(){this.$el.prop("disabled",!1)}})}),define("text",["module"],function(e){"use strict";function t(e,t){return void 0===e||""===e?t:e}function n(e,n,i,a){if(n===a)return!0;if(e===i){if("http"===e)return t(n,"80")===t(a,"80");if("https"===e)return t(n,"443")===t(a,"443")}return!1}var i,a,o,r,s,l=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],c=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,d=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,u="undefined"!=typeof location&&location.href,h=u&&location.protocol&&location.protocol.replace(/\:/,""),p=u&&location.hostname,f=u&&(location.port||void 0),m={},g=e.config&&e.config()||{};return i={version:"2.0.15",strip:function(e){if(e){var t=(e=e.replace(c,"")).match(d);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:g.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;t<3;t+=1){n=l[t];try{e=new ActiveXObject(n)}catch(e){}if(e){l=[n];break}}return e},parseName:function(e){var t,n,i,a=!1,o=e.lastIndexOf("."),r=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!r||o>1)?(t=e.substring(0,o),n=e.substring(o+1)):t=e,i=n||t,-1!==(o=i.indexOf("!"))&&(a="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:a}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,a,o){var r,s,l,c=i.xdRegExp.exec(e);return!c||(r=c[2],s=c[3],s=s.split(":"),l=s[1],s=s[0],(!r||r===t)&&(!s||s.toLowerCase()===a.toLowerCase())&&(!l&&!s||n(r,l,t,o)))},finishLoad:function(e,t,n,a){n=t?i.strip(n):n,g.isBuild&&(m[e]=n),a(n)},load:function(e,t,n,a){if(a&&a.isBuild&&!a.inlineText)n();else{g.isBuild=a&&a.isBuild;var o=i.parseName(e),r=o.moduleName+(o.ext?"."+o.ext:""),s=t.toUrl(r),l=g.useXhr||i.useXhr;0!==s.indexOf("empty:")?!u||l(s,h,p,f)?i.get(s,function(t){i.finishLoad(e,o.strip,t,n)},function(e){n.error&&n.error(e)}):t([r],function(e){i.finishLoad(o.moduleName+"."+o.ext,o.strip,e,n)}):n()}},write:function(e,t,n,a){if(m.hasOwnProperty(t)){var o=i.jsEscape(m[t]);n.asModule(e+"!"+t,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,t,n,a,o){var r=i.parseName(t),s=r.ext?"."+r.ext:"",l=r.moduleName+s,c=n.toUrl(r.moduleName+s)+".js";i.load(l,n,function(t){var n=function(e){return a(c,e)};n.asModule=function(e,t){return a.asModule(e,c,t)},i.write(e,l,n,o)},o)}},"node"===g.env||!g.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]&&!process.versions["atom-shell"]?(a=require.nodeRequire("fs"),i.get=function(e,t,n){try{var i=a.readFileSync(e,"utf8");"\ufeff"===i[0]&&(i=i.substring(1)),t(i)}catch(e){n&&n(e)}}):"xhr"===g.env||!g.env&&i.createXhr()?i.get=function(e,t,n,a){var o,r=i.createXhr();if(r.open("GET",e,!0),a)for(o in a)a.hasOwnProperty(o)&&r.setRequestHeader(o.toLowerCase(),a[o]);g.onXhr&&g.onXhr(r,e),r.onreadystatechange=function(i){var a,o;4===r.readyState&&((a=r.status||0)>399&&a<600?((o=new Error(e+" HTTP status: "+a)).xhr=r,n&&n(o)):t(r.responseText),g.onXhrComplete&&g.onXhrComplete(r,e))},r.send(null)}:"rhino"===g.env||!g.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?i.get=function(e,t){var n,i,a=new java.io.File(e),o=java.lang.System.getProperty("line.separator"),r=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(a),"utf-8")),s="";try{for(n=new java.lang.StringBuffer,(i=r.readLine())&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=r.readLine());)n.append(o),n.append(i);s=String(n.toString())}finally{r.close()}t(s)}:("xpconnect"===g.env||!g.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(o=Components.classes,r=Components.interfaces,Components.utils.import("resource://gre/modules/FileUtils.jsm"),s="@mozilla.org/windows-registry-key;1"in o,i.get=function(e,t){var n,i,a,l={};s&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{(n=o["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream)).init(a,1,0,!1),(i=o["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream)).init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),i.readString(n.available(),l),i.close(),n.close(),t(l.value)}catch(e){throw new Error((a&&a.path||"")+": "+e)}}),i}),define("text!mockup-patterns-relateditems-url/templates/breadcrumb.xml",[],function(){return'<span class="separator">/<span>\n<a href="<%- path %>" class="crumb"><%- text %></a>\n'}),define("text!mockup-patterns-relateditems-url/templates/favorite.xml",[],function(){return'<li><a href="<%- path %>" class="fav" aria-labelledby="blip"><%- title %></a></li>\n'}),define("text!mockup-patterns-relateditems-url/templates/recentlyused.xml",[],function(){return'<li class="pattern-relateditems-recentlyused">\n  <a class="pattern-relateditems-recentlyused-select" data-uid="<%- UID %>">\n    <div class="pattern-relateditems-recentlyused-info">\n      <span\n        class="pattern-relateditems-recentlyused-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n        title="<%- portal_type %>">\n        <%- Title %>\n      </span>\n      <span class="pattern-relateditems-recentlyused-path"><%- path %></span>\n    </div>\n    <% if (getURL && (getIcon || portal_type === "Image")) { %>\n      <div class="pattern-relateditems-recentlyused-image">\n        <img src="<%- getURL %>/@@images/image/tile" />\n      </div>\n    <% } %>\n  </a>\n</li>\n'}),define("text!mockup-patterns-relateditems-url/templates/result.xml",[],function(){return'<div class="pattern-relateditems-result <%- oneLevelUp ? \'one-level-up\' : \'\' %>">\n  <div class="pattern-relateditems-result-browse-wrapper">\n  <% if (!oneLevelUp) { %>\n    <a\n      class="pattern-relateditems-result-select<%- selectable ? \' selectable\' : \'\' %><%- oneLevelUp ? \' one-level-up\' : \'\' %>"\n      data-path="<%- path %>">\n  <% } %>\n      <div class="pattern-relateditems-result-info">\n        <span\n          class="pattern-relateditems-result-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n          title="<%- portal_type %>">\n          <%- Title %>\n        </span>\n        <span class="pattern-relateditems-result-path"><%- oneLevelUp ? currentPath : path %></span>\n      </div>\n      <% if (is_folderish) { %>\n        <a\n          class="pattern-relateditems-result-browse"\n          data-path="<%- path %>"\n          title="<%- oneLevelUp ? one_level_up : open_folder %>">\n          <span class="<%- oneLevelUp ? \'icon-left-circle\' : \'icon-right-circle\' %>"></span>\n        </a>\n      <% } %>\n  <% if (!oneLevelUp) { %>\n    </a>\n  <% } %>\n  </div>\n  <% if (getURL && (getIcon || portal_type === "Image")) { %>\n    <% if (!oneLevelUp) { %>\n    <a\n      class="pattern-relateditems-result-select<%- selectable ? \' selectable\' : \'\' %><%- oneLevelUp ? \' one-level-up\' : \'\' %>"\n      data-path="<%- path %>">\n    <% } %>\n    <div class="pattern-relateditems-result-image">\n      <img src="<%- getURL %>/@@images/image/thumb" />\n    </div>\n    <% if (!oneLevelUp) { %>\n    </a>\n    <% } %>\n  <% } %>\n</div>\n'}),define("text!mockup-patterns-relateditems-url/templates/selection.xml",[],function(){return'<div class="pattern-relateditems-item">\n  <div class="pattern-relateditems-result-info">\n    <span\n      class="pattern-relateditems-item-title <%- portal_type ? \'contenttype-\' + portal_type.toLowerCase() : \'\' %> <%- review_state ? \'state-\' + review_state : \'\' %>"\n      title="<%- portal_type %>">\n      <%- Title %>\n    </span>\n    <span class="pattern-relateditems-item-path"><%- path %></span>\n  </div>\n  <% if (getURL && (getIcon || portal_type === "Image")) { %>\n    <div class="pattern-relateditems-item-image">\n      <img src="<%- getURL %>/@@images/image/thumb" />\n    </div>\n  <% } %>\n</div>\n'}),define("text!mockup-patterns-relateditems-url/templates/toolbar.xml",[],function(){return'<% if (mode!==\'auto\') { %>\n<div class="btn-group mode-selector" role="group">\n  <button type="button" class="mode search btn <% if (mode==\'search\') { %>btn-primary<% } else {%>btn-default<% } %>"><%- searchModeText %></button>\n  <button type="button" class="mode browse btn <% if (mode==\'browse\') { %>btn-primary<% } else {%>btn-default<% } %>"><%- browseModeText %></button>\n</div>\n<% } %>\n<div class="path-wrapper">\n  <span class="pattern-relateditems-path-label"><%- searchText %></span>\n  <a class="crumb" href="/"><span class="glyphicon glyphicon-home"/></a>\n  <%= items %>\n</div>\n<div class="controls pull-right">\n\n  <% if (recentlyUsedItems) { %>\n  <div class="recentlyUsed dropdown pull-right">\n    <button type="button" class="recentlyUsed dropdown-toggle btn btn-primary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n      <span class="glyphicon glyphicon-time"/>\n      <%- recentlyUsedText %>\n      <span class="caret"/>\n    </button>\n    <ul class="dropdown-menu">\n      <%= recentlyUsedItems %>\n    </ul>\n  </div>\n  <% } %>\n\n  <% if (favorites.length > 0) { %>\n  <div class="favorites dropdown pull-right">\n    <button type="button" class="favorites dropdown-toggle btn btn-primary" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n      <span class="glyphicon glyphicon-star"/>\n      <%- favText %>\n      <span class="caret"/>\n    </button>\n    <ul class="dropdown-menu">\n      <%= favItems %>\n    </ul>\n  </div>\n  <% } %>\n</div>\n'}),define("mockup-patterns-relateditems",["jquery","underscore","pat-base","mockup-patterns-select2","mockup-ui-url/views/button","mockup-utils","pat-registry","translate","text!mockup-patterns-relateditems-url/templates/breadcrumb.xml","text!mockup-patterns-relateditems-url/templates/favorite.xml","text!mockup-patterns-relateditems-url/templates/recentlyused.xml","text!mockup-patterns-relateditems-url/templates/result.xml","text!mockup-patterns-relateditems-url/templates/selection.xml","text!mockup-patterns-relateditems-url/templates/toolbar.xml","bootstrap-dropdown"],function(e,t,n,i,a,o,r,s,l,c,d,u,h,p){"use strict";var f={LEFT:37,RIGHT:39};return n.extend({name:"relateditems",trigger:".pat-relateditems",parser:"mockup",currentPath:void 0,selectedUIDs:[],openAfterInit:void 0,defaults:{vocabularyUrl:null,attributes:["UID","Title","portal_type","path","getURL","getIcon","is_folderish","review_state"],basePath:"",pageSize:10,browsing:void 0,closeOnSelect:!0,contextPath:void 0,dropdownCssClass:"pattern-relateditems-dropdown",favorites:[],recentlyUsed:!1,recentlyUsedMaxItems:20,recentlyUsedKey:"relateditems_recentlyused",maximumSelectionSize:-1,minimumInputLength:0,mode:"auto",orderable:!0,pathOperator:"plone.app.querystring.operation.string.path",rootPath:"/",rootUrl:"",scanSelection:!1,selectableTypes:null,separator:",",sortOn:null,sortOrder:"ascending",tokenSeparators:[","," "],upload:!1,uploadAllowView:void 0,width:"100%",breadcrumbTemplate:l,breadcrumbTemplateSelector:null,favoriteTemplate:c,favoriteTemplateSelector:null,recentlyusedTemplate:d,recentlyusedTemplateSelector:null,resultTemplate:u,resultTemplateSelector:null,selectionTemplate:h,selectionTemplateSelector:null,toolbarTemplate:p,toolbarTemplateSelector:null,multiple:!0},recentlyUsed:function(e){var t=o.storage.get(this.options.recentlyUsedKey)||[];t=t.slice(t.length-1e3,t.length),e&&t.filter(this.isSelectable.bind(this));var n=parseInt(this.options.recentlyUsedMaxItems,10);return n&&(t=t.slice(t.length-n,t.length)),t},applyTemplate:function(n,i){var a,o=this;o.options[n+"TemplateSelector"]?(a=e(o.options[n+"TemplateSelector"]).html())||(a=o.options[n+"Template"]):a=o.options[n+"Template"];var r=e.extend(!0,{},o.options,i,{browsing:o.browsing,open_folder:s("Open folder"),current_directory:s("current directory:"),one_level_up:s("Go one level up")});return r._item=i,t.template(a)(r)},setAjax:function(){var e={url:this.options.vocabularyUrl,dataType:"JSON",quietMillis:500,data:function(e,t){var n=[];e&&(e="*"+e+"*",n.push({i:"SearchableText",o:"plone.app.querystring.operation.string.contains",v:e})),!this.browsing&&this.options.selectableTypes&&n.push({i:"portal_type",o:"plone.app.querystring.operation.selection.any",v:this.options.selectableTypes}),n.push({i:"path",o:this.options.pathOperator,v:this.options.rootPath+this.currentPath+(this.browsing?"::1":"")});var i=this.options.sortOn,a=i?this.options.sortOrder:null;return this.browsing&&null===i&&(i="getObjPositionInParent",a="ascending"),{query:JSON.stringify({criteria:n,sort_on:i,sort_order:a}),attributes:JSON.stringify(this.options.attributes),batch:JSON.stringify({page:t||1,size:this.options.pageSize})}}.bind(this),results:function(e,t){var n=t*this.options.pageSize<e.total,i=e.results;this.selectedUIDs=(this.$el.select2("data")||[]).map(function(e){return e.UID}),i=i.filter(function(e){return!!(this.browsing&&e.is_folderish||this.isSelectable(e)&&-1===this.selectedUIDs.indexOf(e.UID))}.bind(this));var a=this.currentPath.split("/");return 1===t&&this.browsing&&a.length>1&&"/"!==this.currentPath&&(i=[{oneLevelUp:!0,Title:s("One level up"),path:a.slice(0,a.length-1).join("/")||"/",currentPath:this.currentPath,is_folderish:!0,selectable:!1}].concat(i)),{results:i,more:n}}.bind(this)};this.options.ajax=e},renderToolbar:function(){function n(t,n){var i="upload-"+o.generateId(),l=new a({id:i,title:s("Upload"),tooltip:s("Upload files"),icon:"upload"});n&&l.disable(),e(".controls",r.$toolbar).prepend(l.render().el),r.uploadView=new t({triggerView:l,app:r}),e("#btn-"+i,r.$toolbar).append(r.uploadView.render().el)}var i,r=this,l=r.currentPath.split("/"),c="",d="";t.each(l,function(e){if(""!==e){var t={};t.path=c=c+"/"+e,t.text=e,d+=r.applyTemplate("breadcrumb",t)}});var u="";t.each(r.options.favorites,function(e){var n=t.clone(e);n.path=n.path.substr(r.options.rootPath.length)||"/",u+=r.applyTemplate("favorite",n)});var h="";if(r.options.recentlyUsed){var p=r.recentlyUsed(!0);t.each(p.reverse(),function(e){h+=r.applyTemplate("recentlyused",e)})}i=r.applyTemplate("toolbar",{items:d,favItems:u,favText:s("Favorites"),searchText:s("Current path:"),searchModeText:s("Search"),browseModeText:s("Browse"),recentlyUsedItems:h,recentlyUsedText:s("Recently Used")}),r.$toolbar.html(i),e(".dropdown-toggle",r.$toolbar).dropdown(),e(".pattern-relateditems-dropdown").unbind("mouseup"),e(".pattern-relateditems-dropdown").bind("mouseup",function(e){e.stopPropagation()}),e("button.mode.search",r.$toolbar).on("click",function(t){t.preventDefault(),r.browsing?(e("button.mode.search",r.$toolbar).toggleClass("btn-primary btn-default"),e("button.mode.browse",r.$toolbar).toggleClass("btn-primary btn-default"),r.browsing=!1,r.$el.select2("data").length>0&&(r.openAfterInit=!0),r.openAfterInit||(r.$el.select2("close"),r.$el.select2("open"))):(r.$el.select2("close"),r.$el.select2("open"))}),e("button.mode.browse",r.$toolbar).on("click",function(t){t.preventDefault(),r.browsing?(r.$el.select2("close"),r.$el.select2("open")):(e("button.mode.search",r.$toolbar).toggleClass("btn-primary btn-default"),e("button.mode.browse",r.$toolbar).toggleClass("btn-primary btn-default"),r.browsing=!0,r.$el.select2("data").length>0&&(r.openAfterInit=!0),r.openAfterInit||(r.$el.select2("close"),r.$el.select2("open")))}),e("a.crumb",r.$toolbar).on("click",function(t){t.preventDefault(),r.browseTo(e(this).attr("href"))}),e("a.fav",r.$toolbar).on("click",function(t){t.preventDefault(),r.browseTo(e(this).attr("href"))}),r.options.recentlyUsed&&e(".pattern-relateditems-recentlyused-select",r.$toolbar).on("click",function(t){t.preventDefault();var n=e(this).data("uid"),i=r.recentlyUsed().filter(function(e){return e.UID===n});i.length>0&&(i=i[0],r.selectItem(i),r.options.maximumSelectionSize>0&&(r.$el.select2("data").length,r.options.maximumSelectionSize))}),r.options.upload&&o.featureSupport.dragAndDrop()&&o.featureSupport.fileApi()&&require(["mockup-patterns-relateditems-upload"],function(t){r.options.uploadAllowView?e.ajax({url:r.options.uploadAllowView,dataType:"JSON",data:{path:r.options.rootPath+r.currentPath},type:"GET",success:function(e){n(t,!e.allowUpload)}}):n(t)})},browseTo:function(e){var t=this;t.emit("before-browse"),t.currentPath=e,t.$el.select2("close"),t.renderToolbar(),t.$el.select2("open"),t.emit("after-browse")},selectItem:function(e){var t=this;t.emit("selecting");var n=t.$el.select2("data");if(n.push(e),t.$el.select2("data",n,!0),t.options.recentlyUsed){var i=t.recentlyUsed(),a=i.filter(function(t){return t.UID===e.UID});a.length>0&&i.splice(i.indexOf(a[0]),1),i.push(e),o.storage.set(t.options.recentlyUsedKey,i)}t.emit("selected")},deselectItem:function(e){var n=this;n.emit("deselecting");var i=n.$el.select2("data");t.each(i,function(t,n){t.UID===e.UID&&i.splice(n,1)}),n.$el.select2("data",i,!0),n.emit("deselected")},isSelectable:function(e){var t=this;return!1!==e.selectable&&(null===t.options.selectableTypes||-1!==t.options.selectableTypes.indexOf(e.portal_type))},init:function(){var t=this;t.browsing="search"!==t.options.mode,t.options.rootPath=t.options.rootPath.replace(/\/$/,""),t.currentPath=t.options.basePath.substr(t.options.rootPath.length)||"/",t.setAjax(),t.$el.wrap('<div class="pattern-relateditems-container" />'),t.$container=t.$el.parents(".pattern-relateditems-container"),t.$container.width(t.options.width),i.prototype.initializeValues.call(t),i.prototype.initializeTags.call(t),t.options.formatSelection=function(n){n=e.extend(!0,{Title:"",getIcon:"",getURL:"",path:"",portal_type:"",review_state:""},n);var i=e(t.applyTemplate("selection",n));if(t.options.scanSelection&&r.scan(i),1==t.options.maximumSelectionSize){var a=n.path,o=a.split("/");a=(o=o.slice(0,-1)).join("/"),t.currentPath=a,t.renderToolbar()}return i},i.prototype.initializeOrdering.call(t),t.options.formatResult=function(n){n.selectable=t.isSelectable(n),n=e.extend(!0,{Title:"",getIcon:"",getURL:"",is_folderish:!1,oneLevelUp:!1,path:"",portal_type:"",review_state:"",selectable:!1},n),-1!==t.selectedUIDs.indexOf(n.UID)&&(n.selectable=!1);var i=e(t.applyTemplate("result",n));return e(".pattern-relateditems-result-select",i).on("click",function(i){if(i.preventDefault(),e(this).is(".selectable")){var a=e(this).parents(".pattern-relateditems-result");a.is(".pattern-relateditems-active")?(a.removeClass("pattern-relateditems-active"),t.deselectItem(n)):(t.options.maximumSelectionSize>0&&t.$el.select2("data").length>=t.options.maximumSelectionSize&&t.$el.select2("close"),t.selectItem(n),a.addClass("pattern-relateditems-active"),t.options.closeOnSelect&&t.$el.select2("close"))}}),e(".pattern-relateditems-result-browse",i).on("click",function(n){n.preventDefault(),n.stopPropagation();var i=e(this).data("path");t.browseTo(i)}),e(i)},t.options.initSelection=function(n,i){var a=e(n).val();if(""!==a){var r=a.split(t.options.separator);new o.QueryHelper(e.extend(!0,{},t.options,{pattern:t})).search("UID","plone.app.querystring.operation.list.contains",r,function(e){var n=e.results.reduce(function(e,t){return e[t.UID]=t,e},{});try{i(r.map(function(e){return n[e]}).filter(function(e){return void 0!==e}))}catch(e){}t.openAfterInit&&(t.$el.select2("open"),t.openAfterInit=void 0)},!1)}},t.options.tokenizer=function(e){"auto"===this.options.mode&&(this.browsing=!e)}.bind(this),t.options.id=function(e){return e.UID},i.prototype.initializeSelect2.call(t),t.$toolbar=e('<div class="toolbar ui-offset-parent" />'),t.$container.prepend(t.$toolbar),t.$el.on("select2-selecting",function(e){t.isSelectable(e.choice)||e.preventDefault()}),t.renderToolbar(),e(document).on("keyup",t.$el,function(n){if(i.prototype.opened.call(t)&&(n.which===f.LEFT||n.which===f.RIGHT)){n.stopPropagation();var a=n.which===f.LEFT?".pattern-relateditems-result.one-level-up":".select2-highlighted",o=e(".pattern-relateditems-result-browse",a);if(1!==o.length)return;var r=o.data("path");t.browseTo(r)}})}})}),function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):"object"==typeof window?window.Picker=e(jQuery):this.Picker=e(jQuery)}(function(e){function t(r,l,d,h){function p(){return t._.node("div",t._.node("div",t._.node("div",t._.node("div",D.component.nodes(x.open),S.box),S.wrap),S.frame),S.holder,'tabindex="-1"')}function f(){C.data(l,D).addClass(S.input).val(C.data("value")?D.get("select",T.format):r.value).on("focus."+x.id+" click."+x.id,function(e){e.preventDefault(),D.open()}).on("mousedown",function(){x.handlingOpen=!0;var t=function(){setTimeout(function(){e(document).off("mouseup",t),x.handlingOpen=!1},0)};e(document).on("mouseup",t)}),T.editable||C.on("keydown."+x.id,w),o(r,{haspopup:!0,expanded:!1,readonly:!1,owns:r.id+"_root"})}function m(){o(D.$root[0],"hidden",!0)}function g(){D.$holder.on({keydown:w,"focus.toOpen":b,blur:function(){C.removeClass(S.target)},focusin:function(e){D.$root.removeClass(S.focused),e.stopPropagation()},"mousedown click":function(t){var n=a(t,r);n!=D.$holder[0]&&(t.stopPropagation(),"mousedown"!=t.type||e(n).is("input, select, textarea, button, option")||(t.preventDefault(),D.$holder.eq(0).focus()))}}).on("click","[data-pick], [data-nav], [data-clear], [data-close]",function(){var t=e(this),n=t.data(),i=t.hasClass(S.navDisabled)||t.hasClass(S.disabled),a=s();a=a&&(a.type||a.href?a:null),(i||a&&!e.contains(D.$root[0],a))&&D.$holder.eq(0).focus(),!i&&n.nav?D.set("highlight",D.component.item.highlight,{nav:n.nav}):!i&&"pick"in n?(D.set("select",n.pick),T.closeOnSelect&&D.close(!0)):n.clear?(D.clear(),T.closeOnClear&&D.close(!0)):n.close&&D.close(!0)})}function v(){var t;!0===T.hiddenName?(t=r.name,r.name=""):t=(t=["string"==typeof T.hiddenPrefix?T.hiddenPrefix:"","string"==typeof T.hiddenSuffix?T.hiddenSuffix:"_submit"])[0]+r.name+t[1],D._hidden=e('<input type=hidden name="'+t+'"'+(C.data("value")||r.value?' value="'+D.get("select",T.formatSubmit)+'"':"")+">")[0],C.on("change."+x.id,function(){D._hidden.value=r.value?D.get("select",T.formatSubmit):""})}function y(){k&&u?D.$holder.find("."+S.frame).one("transitionend",function(){D.$holder.eq(0).focus()}):setTimeout(function(){D.$holder.eq(0).focus()},0)}function b(e){e.stopPropagation(),C.addClass(S.target),D.$root.addClass(S.focused),D.open()}function w(e){var t=e.keyCode,n=/^(8|46)$/.test(t);if(27==t)return D.close(!0),!1;(32==t||n||!x.open&&D.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?D.clear().close():D.open())}if(!r)return t;var k=!1,x={id:r.id||"P"+Math.abs(~~(Math.random()*new Date)),handlingOpen:!1},T=d?e.extend(!0,{},d.defaults,h):h||{},S=e.extend({},t.klasses(),T.klass),C=e(r),E=function(){return this.start()},D=E.prototype={constructor:E,$node:C,start:function(){return x&&x.start?D:(x.methods={},x.start=!0,x.open=!1,x.type=r.type,r.autofocus=r==s(),r.readOnly=!T.editable,r.id=r.id||x.id,"text"!=r.type&&(r.type="text"),D.component=new d(D,T),D.$root=e('<div class="'+S.picker+'" id="'+r.id+'_root" />'),m(),D.$holder=e(p()).appendTo(D.$root),g(),T.formatSubmit&&v(),f(),T.containerHidden?e(T.containerHidden).append(D._hidden):C.after(D._hidden),T.container?e(T.container).append(D.$root):C.after(D.$root),D.on({start:D.component.onStart,render:D.component.onRender,stop:D.component.onStop,open:D.component.onOpen,close:D.component.onClose,set:D.component.onSet}).on({start:T.onStart,render:T.onRender,stop:T.onStop,open:T.onOpen,close:T.onClose,set:T.onSet}),k=n(D.$holder[0]),r.autofocus&&D.open(),D.trigger("start").trigger("render"))},render:function(t){return t?(D.$holder=e(p()),g(),D.$root.html(D.$holder)):D.$root.find("."+S.box).html(D.component.nodes(x.open)),D.trigger("render")},stop:function(){return x.start?(D.close(),D._hidden&&D._hidden.parentNode.removeChild(D._hidden),D.$root.remove(),C.removeClass(S.input).removeData(l),setTimeout(function(){C.off("."+x.id)},0),r.type=x.type,r.readOnly=!1,D.trigger("stop"),x.methods={},x.start=!1,D):D},open:function(n){return x.open?D:(C.addClass(S.active),o(r,"expanded",!0),setTimeout(function(){D.$root.addClass(S.opened),o(D.$root[0],"hidden",!1)},0),!1!==n&&(x.open=!0,k&&e("body").css("overflow","hidden").css("padding-right","+="+i()),y(),c.on("click."+x.id+" focusin."+x.id,function(e){if(!x.handlingOpen){var t=a(e,r);e.isSimulated||t==r||t==document||3==e.which||D.close(t===D.$holder[0])}}).on("keydown."+x.id,function(n){var i=n.keyCode,o=D.component.key[i],s=a(n,r);27==i?D.close(!0):s!=D.$holder[0]||!o&&13!=i?e.contains(D.$root[0],s)&&13==i&&(n.preventDefault(),s.click()):(n.preventDefault(),o?t._.trigger(D.component.key.go,D,[t._.trigger(o)]):D.$root.find("."+S.highlighted).hasClass(S.disabled)||(D.set("select",D.component.item.highlight),T.closeOnSelect&&D.close(!0)))})),D.trigger("open"))},close:function(t){return t&&(T.editable?r.focus():(D.$holder.off("focus.toOpen").focus(),setTimeout(function(){D.$holder.on("focus.toOpen",b)},0))),C.removeClass(S.active),o(r,"expanded",!1),setTimeout(function(){D.$root.removeClass(S.opened+" "+S.focused),o(D.$root[0],"hidden",!0)},0),x.open?(x.open=!1,k&&e("body").css("overflow","").css("padding-right","-="+i()),c.off("."+x.id),D.trigger("close")):D},clear:function(e){return D.set("clear",null,e)},set:function(t,n,i){var a,o,r=e.isPlainObject(t),s=r?t:{};if(i=r&&e.isPlainObject(n)?n:i||{},t){r||(s[t]=n);for(a in s)o=s[a],a in D.component.item&&(void 0===o&&(o=null),D.component.set(a,o,i)),"select"!=a&&"clear"!=a||!T.updateInput||C.val("clear"==a?"":D.get(a,T.format)).trigger("change");D.render()}return i.muted?D:D.trigger("set",s)},get:function(e,n){if(e=e||"value",null!=x[e])return x[e];if("valueSubmit"==e){if(D._hidden)return D._hidden.value;e="value"}if("value"==e)return r.value;if(e in D.component.item){if("string"==typeof n){var i=D.component.get(e);return i?t._.trigger(D.component.formats.toString,D.component,[n,i]):""}return D.component.get(e)}},on:function(t,n,i){var a,o,r=e.isPlainObject(t),s=r?t:{};if(t){r||(s[t]=n);for(a in s)o=s[a],i&&(a="_"+a),x.methods[a]=x.methods[a]||[],x.methods[a].push(o)}return D},off:function(){var e,t,n=arguments;for(e=0,namesCount=n.length;e<namesCount;e+=1)(t=n[e])in x.methods&&delete x.methods[t];return D},trigger:function(e,n){var i=function(e){var i=x.methods[e];i&&i.map(function(e){t._.trigger(e,D,[n])})};return i("_"+e),i(e),D}};return new E}function n(e){var t;return e.currentStyle?t=e.currentStyle.position:window.getComputedStyle&&(t=getComputedStyle(e).position),"fixed"==t}function i(){if(d.height()<=l.height())return 0;var t=e('<div style="visibility:hidden;width:100px" />').appendTo("body"),n=t[0].offsetWidth;t.css("overflow","scroll");var i=e('<div style="width:100%" />').appendTo(t)[0].offsetWidth;return t.remove(),n-i}function a(e,t){var n=[];return e.path&&(n=e.path),e.originalEvent&&e.originalEvent.path&&(n=e.originalEvent.path),n&&n.length>0?t&&n.indexOf(t)>=0?t:n[0]:e.target}function o(t,n,i){if(e.isPlainObject(n))for(var a in n)r(t,a,n[a]);else r(t,n,i)}function r(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}function s(){try{return document.activeElement}catch(e){}}var l=e(window),c=e(document),d=e(document.documentElement),u=null!=document.documentElement.style.transition;return t.klasses=function(e){return e=e||"picker",{picker:e,opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",target:e+"__input--target",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},t._={group:function(e){for(var n,i="",a=t._.trigger(e.min,e);a<=t._.trigger(e.max,e,[a]);a+=e.i)n=t._.trigger(e.item,e,[a]),i+=t._.node(e.node,n[0],n[1],n[2]);return i},node:function(t,n,i,a){return n?(n=e.isArray(n)?n.join(""):n,i=i?' class="'+i+'"':"",a=a?" "+a:"","<"+t+i+a+">"+n+"</"+t+">"):""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1==0},ariaAttr:function(t,n){e.isPlainObject(t)||(t={attribute:n}),n="";for(var i in t){var a=("role"==i?"":"aria-")+i;n+=null==t[i]?"":a+'="'+t[i]+'"'}return n}},t.extend=function(n,i){e.fn[n]=function(a,o){var r=this.data(n);return"picker"==a?r:r&&"string"==typeof a?t._.trigger(r[a],r,[o]):this.each(function(){e(this).data(n)||new t(this,n,i,a)})},e.fn[n].defaults=i.defaults},t}),function(e){"function"==typeof define&&define.amd?define("picker.date",["./picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,t){function n(e,t){var n=this,i=e.$node[0],a=i.value,o=e.$node.data("value"),r=o||a,s=o?t.formatSubmit:t.format,l=function(){return i.currentStyle?"rtl"==i.currentStyle.direction:"rtl"==getComputedStyle(e.$root[0]).direction};n.settings=t,n.$node=e.$node,n.queue={min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse navigate create validate",view:"parse create validate viewset",disable:"deactivate",enable:"activate"},n.item={},n.item.clear=null,n.item.disable=(t.disable||[]).slice(0),n.item.enable=-function(e){return!0===e[0]?e.shift():-1}(n.item.disable),n.set("min",t.min).set("max",t.max).set("now"),r?n.set("select",r,{format:s,defaultValue:!0}):n.set("select",null).set("highlight",n.item.now),n.key={40:7,38:-7,39:function(){return l()?-1:1},37:function(){return l()?1:-1},go:function(e){var t=n.item.highlight,i=new Date(t.year,t.month,t.date+e);n.set("highlight",i,{interval:e}),this.render()}},e.on("render",function(){e.$root.find("."+t.klass.selectMonth).on("change",function(){var n=this.value;n&&(e.set("highlight",[e.get("view").year,n,e.get("highlight").date]),e.$root.find("."+t.klass.selectMonth).trigger("focus"))}),e.$root.find("."+t.klass.selectYear).on("change",function(){var n=this.value;n&&(e.set("highlight",[n,e.get("view").month,e.get("highlight").date]),e.$root.find("."+t.klass.selectYear).trigger("focus"))})},1).on("open",function(){var i="";n.disabled(n.get("now"))&&(i=":not(."+t.klass.buttonToday+")"),e.$root.find("button"+i+", select").attr("disabled",!1)},1).on("close",function(){e.$root.find("button, select").attr("disabled",!0)},1)}var i=e._;n.prototype.set=function(e,t,n){var i=this,a=i.item;return null===t?("clear"==e&&(e="select"),a[e]=t,i):(a["enable"==e?"disable":"flip"==e?"enable":e]=i.queue[e].split(" ").map(function(a){return t=i[a](e,t,n)}).pop(),"select"==e?i.set("highlight",a.select,n):"highlight"==e?i.set("view",a.highlight,n):e.match(/^(flip|min|max|disable|enable)$/)&&(a.select&&i.disabled(a.select)&&i.set("select",a.select,n),a.highlight&&i.disabled(a.highlight)&&i.set("highlight",a.highlight,n)),i)},n.prototype.get=function(e){return this.item[e]},n.prototype.create=function(e,n,a){var o,r=this;return(n=void 0===n?e:n)==-1/0||n==1/0?o=n:t.isPlainObject(n)&&i.isInteger(n.pick)?n=n.obj:t.isArray(n)?(n=new Date(n[0],n[1],n[2]),n=i.isDate(n)?n:r.create().obj):n=i.isInteger(n)||i.isDate(n)?r.normalize(new Date(n),a):r.now(e,n,a),{year:o||n.getFullYear(),month:o||n.getMonth(),date:o||n.getDate(),day:o||n.getDay(),obj:o||n,pick:o||n.getTime()}},n.prototype.createRange=function(e,n){var a=this,o=function(e){return!0===e||t.isArray(e)||i.isDate(e)?a.create(e):e};return i.isInteger(e)||(e=o(e)),i.isInteger(n)||(n=o(n)),i.isInteger(e)&&t.isPlainObject(n)?e=[n.year,n.month,n.date+e]:i.isInteger(n)&&t.isPlainObject(e)&&(n=[e.year,e.month,e.date+n]),{from:o(e),to:o(n)}},n.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},n.prototype.overlapRanges=function(e,t){var n=this;return e=n.createRange(e.from,e.to),t=n.createRange(t.from,t.to),n.withinRange(e,t.from)||n.withinRange(e,t.to)||n.withinRange(t,e.from)||n.withinRange(t,e.to)},n.prototype.now=function(e,t,n){return t=new Date,n&&n.rel&&t.setDate(t.getDate()+n.rel),this.normalize(t,n)},n.prototype.navigate=function(e,n,i){var a,o,r,s,l=t.isArray(n),c=t.isPlainObject(n),d=this.item.view;if(l||c){for(c?(o=n.year,r=n.month,s=n.date):(o=+n[0],r=+n[1],s=+n[2]),i&&i.nav&&d&&d.month!==r&&(o=d.year,r=d.month),o=(a=new Date(o,r+(i&&i.nav?i.nav:0),1)).getFullYear(),r=a.getMonth();new Date(o,r,s).getMonth()!==r;)s-=1;n=[o,r,s]}return n},n.prototype.normalize=function(e){return e.setHours(0,0,0,0),e},n.prototype.measure=function(e,t){var n=this;return i.isInteger(t)?t=n.now(e,t,{rel:t}):t?"string"==typeof t&&(t=n.parse(e,t)):t="min"==e?-1/0:1/0,t},n.prototype.viewset=function(e,t){return this.create([t.year,t.month,1])},n.prototype.validate=function(e,n,a){var o,r,s,l,c=this,d=n,u=a&&a.interval?a.interval:1,h=-1===c.item.enable,p=c.item.min,f=c.item.max,m=h&&c.item.disable.filter(function(e){if(t.isArray(e)){var a=c.create(e).pick;a<n.pick?o=!0:a>n.pick&&(r=!0)}return i.isInteger(e)}).length;if((!a||!a.nav&&!a.defaultValue)&&(!h&&c.disabled(n)||h&&c.disabled(n)&&(m||o||r)||!h&&(n.pick<=p.pick||n.pick>=f.pick)))for(h&&!m&&(!r&&u>0||!o&&u<0)&&(u*=-1);c.disabled(n)&&(Math.abs(u)>1&&(n.month<d.month||n.month>d.month)&&(n=d,u=u>0?1:-1),n.pick<=p.pick?(s=!0,u=1,n=c.create([p.year,p.month,p.date+(n.pick===p.pick?0:-1)])):n.pick>=f.pick&&(l=!0,u=-1,n=c.create([f.year,f.month,f.date+(n.pick===f.pick?0:1)])),!s||!l);)n=c.create([n.year,n.month,n.date+u]);return n},n.prototype.disabled=function(e){var n=this,a=n.item.disable.filter(function(a){return i.isInteger(a)?e.day===(n.settings.firstDay?a:a-1)%7:t.isArray(a)||i.isDate(a)?e.pick===n.create(a).pick:t.isPlainObject(a)?n.withinRange(a,e):void 0});return a=a.length&&!a.filter(function(e){return t.isArray(e)&&"inverted"==e[3]||t.isPlainObject(e)&&e.inverted}).length,-1===n.item.enable?!a:a||e.pick<n.item.min.pick||e.pick>n.item.max.pick},n.prototype.parse=function(e,t,n){var a=this,o={};return t&&"string"==typeof t?(n&&n.format||((n=n||{}).format=a.settings.format),a.formats.toArray(n.format).map(function(e){var n=a.formats[e],r=n?i.trigger(n,a,[t,o]):e.replace(/^!/,"").length;n&&(o[e]=t.substr(0,r)),t=t.substr(r)}),[o.yyyy||o.yy,+(o.mm||o.m)-1,o.dd||o.d]):t},n.prototype.formats=function(){function e(e,t,n){var i=e.match(/[^\x00-\x7F]+|\w+/)[0];return n.mm||n.m||(n.m=t.indexOf(i)+1),i.length}function t(e){return e.match(/\w+/)[0].length}return{d:function(e,t){return e?i.digits(e):t.date},dd:function(e,t){return e?2:i.lead(t.date)},ddd:function(e,n){return e?t(e):this.settings.weekdaysShort[n.day]},dddd:function(e,n){return e?t(e):this.settings.weekdaysFull[n.day]},m:function(e,t){return e?i.digits(e):t.month+1},mm:function(e,t){return e?2:i.lead(t.month+1)},mmm:function(t,n){var i=this.settings.monthsShort;return t?e(t,i,n):i[n.month]},mmmm:function(t,n){var i=this.settings.monthsFull;return t?e(t,i,n):i[n.month]},yy:function(e,t){return e?2:(""+t.year).slice(2)},yyyy:function(e,t){return e?4:t.year},toArray:function(e){return e.split(/(d{1,4}|m{1,4}|y{4}|yy|!.)/g)},toString:function(e,t){var n=this;return n.formats.toArray(e).map(function(e){return i.trigger(n.formats[e],n,[0,t])||e.replace(/^!/,"")}).join("")}}}(),n.prototype.isDateExact=function(e,n){var a=this;return i.isInteger(e)&&i.isInteger(n)||"boolean"==typeof e&&"boolean"==typeof n?e===n:(i.isDate(e)||t.isArray(e))&&(i.isDate(n)||t.isArray(n))?a.create(e).pick===a.create(n).pick:!(!t.isPlainObject(e)||!t.isPlainObject(n))&&(a.isDateExact(e.from,n.from)&&a.isDateExact(e.to,n.to))},n.prototype.isDateOverlap=function(e,n){var a=this,o=a.settings.firstDay?1:0;return i.isInteger(e)&&(i.isDate(n)||t.isArray(n))?(e=e%7+o)===a.create(n).day+1:i.isInteger(n)&&(i.isDate(e)||t.isArray(e))?(n=n%7+o)===a.create(e).day+1:!(!t.isPlainObject(e)||!t.isPlainObject(n))&&a.overlapRanges(e,n)},n.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},n.prototype.deactivate=function(e,n){var a=this,o=a.item.disable.slice(0);return"flip"==n?a.flipEnable():!1===n?(a.flipEnable(1),o=[]):!0===n?(a.flipEnable(-1),o=[]):n.map(function(e){for(var n,r=0;r<o.length;r+=1)if(a.isDateExact(e,o[r])){n=!0;break}n||(i.isInteger(e)||i.isDate(e)||t.isArray(e)||t.isPlainObject(e)&&e.from&&e.to)&&o.push(e)}),o},n.prototype.activate=function(e,n){var a=this,o=a.item.disable,r=o.length;return"flip"==n?a.flipEnable():!0===n?(a.flipEnable(1),o=[]):!1===n?(a.flipEnable(-1),o=[]):n.map(function(e){var n,s,l,c;for(l=0;l<r;l+=1){if(s=o[l],a.isDateExact(s,e)){n=o[l]=null,c=!0;break}if(a.isDateOverlap(s,e)){t.isPlainObject(e)?(e.inverted=!0,n=e):t.isArray(e)?(n=e)[3]||n.push("inverted"):i.isDate(e)&&(n=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(n)for(l=0;l<r;l+=1)if(a.isDateExact(o[l],e)){o[l]=null;break}if(c)for(l=0;l<r;l+=1)if(a.isDateOverlap(o[l],e)){o[l]=null;break}n&&o.push(n)}),o.filter(function(e){return null!=e})},n.prototype.nodes=function(e){var t=this,n=t.settings,a=t.item,o=a.now,r=a.select,s=a.highlight,l=a.view,c=a.disable,d=a.min,u=a.max,h=function(e,t){return n.firstDay&&(e.push(e.shift()),t.push(t.shift())),i.node("thead",i.node("tr",i.group({min:0,max:6,i:1,node:"th",item:function(i){return[e[i],n.klass.weekdays,'scope=col title="'+t[i]+'"']}})))}((n.showWeekdaysFull?n.weekdaysFull:n.weekdaysShort).slice(0),n.weekdaysFull.slice(0)),p=function(e){return i.node("div"," ",n.klass["nav"+(e?"Next":"Prev")]+(e&&l.year>=u.year&&l.month>=u.month||!e&&l.year<=d.year&&l.month<=d.month?" "+n.klass.navDisabled:""),"data-nav="+(e||-1)+" "+i.ariaAttr({role:"button",controls:t.$node[0].id+"_table"})+' title="'+(e?n.labelMonthNext:n.labelMonthPrev)+'"')},f=function(){var a=n.showMonthsShort?n.monthsShort:n.monthsFull;return n.selectMonths?i.node("select",i.group({min:0,max:11,i:1,node:"option",item:function(e){return[a[e],0,"value="+e+(l.month==e?" selected":"")+(l.year==d.year&&e<d.month||l.year==u.year&&e>u.month?" disabled":"")]}}),n.klass.selectMonth,(e?"":"disabled")+" "+i.ariaAttr({controls:t.$node[0].id+"_table"})+' title="'+n.labelMonthSelect+'"'):i.node("div",a[l.month],n.klass.month)},m=function(){var a=l.year,o=!0===n.selectYears?5:~~(n.selectYears/2);if(o){var r=d.year,s=u.year,c=a-o,h=a+o;if(r>c&&(h+=r-c,c=r),s<h){var p=c-r,f=h-s;c-=p>f?f:p,h=s}return i.node("select",i.group({min:c,max:h,i:1,node:"option",item:function(e){return[e,0,"value="+e+(a==e?" selected":"")]}}),n.klass.selectYear,(e?"":"disabled")+" "+i.ariaAttr({controls:t.$node[0].id+"_table"})+' title="'+n.labelYearSelect+'"')}return i.node("div",a,n.klass.year)};return i.node("div",(n.selectYears?m()+f():f()+m())+p()+p(1),n.klass.header)+i.node("table",h+i.node("tbody",i.group({min:0,max:5,i:1,node:"tr",item:function(e){var a=n.firstDay&&0===t.create([l.year,l.month,1]).day?-7:0;return[i.group({min:7*e-l.day+a+1,max:function(){return this.min+7-1},i:1,node:"td",item:function(e){e=t.create([l.year,l.month,e+(n.firstDay?1:0)]);var a=r&&r.pick==e.pick,h=s&&s.pick==e.pick,p=c&&t.disabled(e)||e.pick<d.pick||e.pick>u.pick,f=i.trigger(t.formats.toString,t,[n.format,e]);return[i.node("div",e.date,function(t){return t.push(l.month==e.month?n.klass.infocus:n.klass.outfocus),o.pick==e.pick&&t.push(n.klass.now),a&&t.push(n.klass.selected),h&&t.push(n.klass.highlighted),p&&t.push(n.klass.disabled),t.join(" ")}([n.klass.day]),"data-pick="+e.pick+" "+i.ariaAttr({role:"gridcell",label:f,selected:!(!a||t.$node.val()!==f)||null,activedescendant:!!h||null,disabled:!!p||null})),"",i.ariaAttr({role:"presentation"})]}})]}})),n.klass.table,'id="'+t.$node[0].id+'_table" '+i.ariaAttr({role:"grid",controls:t.$node[0].id,readonly:!0}))+i.node("div",i.node("button",n.today,n.klass.buttonToday,"type=button data-pick="+o.pick+(e&&!t.disabled(o)?"":" disabled")+" "+i.ariaAttr({controls:t.$node[0].id}))+i.node("button",n.clear,n.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+i.ariaAttr({controls:t.$node[0].id}))+i.node("button",n.close,n.klass.buttonClose,"type=button data-close=true "+(e?"":" disabled")+" "+i.ariaAttr({controls:t.$node[0].id})),n.klass.footer)},n.defaults=function(e){return{labelMonthNext:"Next month",labelMonthPrev:"Previous month",labelMonthSelect:"Select a month",labelYearSelect:"Select a year",monthsFull:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdaysFull:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",clear:"Clear",close:"Close",closeOnSelect:!0,closeOnClear:!0,updateInput:!0,format:"d mmmm, yyyy",klass:{table:e+"table",header:e+"header",navPrev:e+"nav--prev",navNext:e+"nav--next",navDisabled:e+"nav--disabled",month:e+"month",year:e+"year",selectMonth:e+"select--month",selectYear:e+"select--year",weekdays:e+"weekday",day:e+"day",disabled:e+"day--disabled",selected:e+"day--selected",highlighted:e+"day--highlighted",now:e+"day--today",infocus:e+"day--infocus",outfocus:e+"day--outfocus",footer:e+"footer",buttonClear:e+"button--clear",buttonToday:e+"button--today",buttonClose:e+"button--close"}}}(e.klasses().picker+"__"),e.extend("pickadate",n)}),function(e){"function"==typeof define&&define.amd?define("picker.time",["./picker","jquery"],e):"object"==typeof exports?module.exports=e(require("./picker.js"),require("jquery")):e(Picker,jQuery)}(function(e,t){function n(e,t){var n=this,i=e.$node[0].value,a=e.$node.data("value"),o=a||i,r=a?t.formatSubmit:t.format;n.settings=t,n.$node=e.$node,n.queue={interval:"i",min:"measure create",max:"measure create",now:"now create",select:"parse create validate",highlight:"parse create validate",view:"parse create validate",disable:"deactivate",enable:"activate"},n.item={},n.item.clear=null,n.item.interval=t.interval||30,n.item.disable=(t.disable||[]).slice(0),n.item.enable=-function(e){return!0===e[0]?e.shift():-1}(n.item.disable),n.set("min",t.min).set("max",t.max).set("now"),o?n.set("select",o,{format:r}):n.set("select",null).set("highlight",n.item.now),n.key={40:1,38:-1,39:1,37:-1,go:function(e){n.set("highlight",n.item.highlight.pick+e*n.item.interval,{interval:e*n.item.interval}),this.render()}},e.on("render",function(){var n=e.$root.children(),i=n.find("."+t.klass.viewset),a=function(e){return["webkit","moz","ms","o",""].map(function(t){return(t?"-"+t+"-":"")+e})},o=function(e,t){a("transform").map(function(n){e.css(n,t)}),a("transition").map(function(n){e.css(n,t)})};i.length&&(o(n,"none"),n[0].scrollTop=~~i.position().top-2*i[0].clientHeight,o(n,""))},1).on("open",function(){e.$root.find("button").attr("disabled",!1)},1).on("close",function(){e.$root.find("button").attr("disabled",!0)},1)}var i=e._;n.prototype.set=function(e,t,n){var i=this,a=i.item;return null===t?("clear"==e&&(e="select"),a[e]=t,i):(a["enable"==e?"disable":"flip"==e?"enable":e]=i.queue[e].split(" ").map(function(a){return t=i[a](e,t,n)}).pop(),"select"==e?i.set("highlight",a.select,n):"highlight"==e?i.set("view",a.highlight,n):"interval"==e?i.set("min",a.min,n).set("max",a.max,n):e.match(/^(flip|min|max|disable|enable)$/)&&(a.select&&i.disabled(a.select)&&i.set("select",t,n),a.highlight&&i.disabled(a.highlight)&&i.set("highlight",t,n),"min"==e&&i.set("max",a.max,n)),i)},n.prototype.get=function(e){return this.item[e]},n.prototype.create=function(e,n,a){var o=this;return n=void 0===n?e:n,i.isDate(n)&&(n=[n.getHours(),n.getMinutes()]),t.isPlainObject(n)&&i.isInteger(n.pick)?n=n.pick:t.isArray(n)?n=60*+n[0]+ +n[1]:i.isInteger(n)||(n=o.now(e,n,a)),"max"==e&&n<o.item.min.pick&&(n+=1440),"min"!=e&&"max"!=e&&(n-o.item.min.pick)%o.item.interval!=0&&(n+=o.item.interval),n=o.normalize(e,n,a),{hour:~~(24+n/60)%24,mins:(60+n%60)%60,time:(1440+n)%1440,pick:n%1440}},n.prototype.createRange=function(e,n){var a=this,o=function(e){return!0===e||t.isArray(e)||i.isDate(e)?a.create(e):e};return i.isInteger(e)||(e=o(e)),i.isInteger(n)||(n=o(n)),i.isInteger(e)&&t.isPlainObject(n)?e=[n.hour,n.mins+e*a.settings.interval]:i.isInteger(n)&&t.isPlainObject(e)&&(n=[e.hour,e.mins+n*a.settings.interval]),{from:o(e),to:o(n)}},n.prototype.withinRange=function(e,t){return e=this.createRange(e.from,e.to),t.pick>=e.from.pick&&t.pick<=e.to.pick},n.prototype.overlapRanges=function(e,t){var n=this;return e=n.createRange(e.from,e.to),t=n.createRange(t.from,t.to),n.withinRange(e,t.from)||n.withinRange(e,t.to)||n.withinRange(t,e.from)||n.withinRange(t,e.to)},n.prototype.now=function(e,t){var n,a=this.item.interval,o=new Date,r=60*o.getHours()+o.getMinutes(),s=i.isInteger(t);return r-=r%a,n=t<0&&a*t+r<=-a,r+="min"==e&&n?0:a,s&&(r+=a*(n&&"max"!=e?t+1:t)),r},n.prototype.normalize=function(e,t){var n=this.item.interval,i=this.item.min&&this.item.min.pick||0;return t-="min"==e?0:(t-i)%n},n.prototype.measure=function(e,n,a){var o=this;return n||(n="min"==e?[0,0]:[23,59]),"string"==typeof n?n=o.parse(e,n):!0===n||i.isInteger(n)?n=o.now(e,n,a):t.isPlainObject(n)&&i.isInteger(n.pick)&&(n=o.normalize(e,n.pick,a)),n},n.prototype.validate=function(e,t,n){var i=this,a=n&&n.interval?n.interval:i.item.interval;return i.disabled(t)&&(t=i.shift(t,a)),t=i.scope(t),i.disabled(t)&&(t=i.shift(t,-1*a)),t},n.prototype.disabled=function(e){var n=this,a=n.item.disable.filter(function(a){return i.isInteger(a)?e.hour==a:t.isArray(a)||i.isDate(a)?e.pick==n.create(a).pick:t.isPlainObject(a)?n.withinRange(a,e):void 0});return a=a.length&&!a.filter(function(e){return t.isArray(e)&&"inverted"==e[2]||t.isPlainObject(e)&&e.inverted}).length,-1===n.item.enable?!a:a||e.pick<n.item.min.pick||e.pick>n.item.max.pick},n.prototype.shift=function(e,t){var n=this,i=n.item.min.pick,a=n.item.max.pick;for(t=t||n.item.interval;n.disabled(e)&&!((e=n.create(e.pick+=t)).pick<=i||e.pick>=a););return e},n.prototype.scope=function(e){var t=this.item.min.pick,n=this.item.max.pick;return this.create(e.pick>n?n:e.pick<t?t:e)},n.prototype.parse=function(e,t,n){var a,o,r,s,l,c=this,d={};if(!t||"string"!=typeof t)return t;n&&n.format||((n=n||{}).format=c.settings.format),c.formats.toArray(n.format).map(function(e){var n,a=c.formats[e],o=a?i.trigger(a,c,[t,d]):e.replace(/^!/,"").length;a&&(n=t.substr(0,o),d[e]=n.match(/^\d+$/)?+n:n),t=t.substr(o)});for(s in d)l=d[s],i.isInteger(l)?s.match(/^(h|hh)$/i)?(a=l,"h"!=s&&"hh"!=s||(a%=12)):"i"==s&&(o=l):s.match(/^a$/i)&&l.match(/^p/i)&&("h"in d||"hh"in d)&&(r=!0);return 60*(r?a+12:a)+o},n.prototype.formats={h:function(e,t){return e?i.digits(e):t.hour%12||12},hh:function(e,t){return e?2:i.lead(t.hour%12||12)},H:function(e,t){return e?i.digits(e):""+t.hour%24},HH:function(e,t){return e?i.digits(e):i.lead(t.hour%24)},i:function(e,t){return e?2:i.lead(t.mins)},a:function(e,t){return e?4:720>t.time%1440?"a.m.":"p.m."},A:function(e,t){return e?2:720>t.time%1440?"AM":"PM"},toArray:function(e){return e.split(/(h{1,2}|H{1,2}|i|a|A|!.)/g)},toString:function(e,t){var n=this;return n.formats.toArray(e).map(function(e){return i.trigger(n.formats[e],n,[0,t])||e.replace(/^!/,"")}).join("")}},n.prototype.isTimeExact=function(e,n){var a=this;return i.isInteger(e)&&i.isInteger(n)||"boolean"==typeof e&&"boolean"==typeof n?e===n:(i.isDate(e)||t.isArray(e))&&(i.isDate(n)||t.isArray(n))?a.create(e).pick===a.create(n).pick:!(!t.isPlainObject(e)||!t.isPlainObject(n))&&(a.isTimeExact(e.from,n.from)&&a.isTimeExact(e.to,n.to))},n.prototype.isTimeOverlap=function(e,n){var a=this;return i.isInteger(e)&&(i.isDate(n)||t.isArray(n))?e===a.create(n).hour:i.isInteger(n)&&(i.isDate(e)||t.isArray(e))?n===a.create(e).hour:!(!t.isPlainObject(e)||!t.isPlainObject(n))&&a.overlapRanges(e,n)},n.prototype.flipEnable=function(e){var t=this.item;t.enable=e||(-1==t.enable?1:-1)},n.prototype.deactivate=function(e,n){var a=this,o=a.item.disable.slice(0);return"flip"==n?a.flipEnable():!1===n?(a.flipEnable(1),o=[]):!0===n?(a.flipEnable(-1),o=[]):n.map(function(e){for(var n,r=0;r<o.length;r+=1)if(a.isTimeExact(e,o[r])){n=!0;break}n||(i.isInteger(e)||i.isDate(e)||t.isArray(e)||t.isPlainObject(e)&&e.from&&e.to)&&o.push(e)}),o},n.prototype.activate=function(e,n){var a=this,o=a.item.disable,r=o.length;return"flip"==n?a.flipEnable():!0===n?(a.flipEnable(1),o=[]):!1===n?(a.flipEnable(-1),o=[]):n.map(function(e){var n,s,l,c;for(l=0;l<r;l+=1){if(s=o[l],a.isTimeExact(s,e)){n=o[l]=null,c=!0;break}if(a.isTimeOverlap(s,e)){t.isPlainObject(e)?(e.inverted=!0,n=e):t.isArray(e)?(n=e)[2]||n.push("inverted"):i.isDate(e)&&(n=[e.getFullYear(),e.getMonth(),e.getDate(),"inverted"]);break}}if(n)for(l=0;l<r;l+=1)if(a.isTimeExact(o[l],e)){o[l]=null;break}if(c)for(l=0;l<r;l+=1)if(a.isTimeOverlap(o[l],e)){o[l]=null;break}n&&o.push(n)}),o.filter(function(e){return null!=e})},n.prototype.i=function(e,t){return i.isInteger(t)&&t>0?t:this.item.interval},n.prototype.nodes=function(e){var t=this,n=t.settings,a=t.item.select,o=t.item.highlight,r=t.item.view,s=t.item.disable;return i.node("ul",i.group({min:t.item.min.pick,max:t.item.max.pick,i:t.item.interval,node:"li",item:function(e){var l=(e=t.create(e)).pick,c=a&&a.pick==l,d=o&&o.pick==l,u=s&&t.disabled(e),h=i.trigger(t.formats.toString,t,[n.format,e]);return[i.trigger(t.formats.toString,t,[i.trigger(n.formatLabel,t,[e])||n.format,e]),function(e){return c&&e.push(n.klass.selected),d&&e.push(n.klass.highlighted),r&&r.pick==l&&e.push(n.klass.viewset),u&&e.push(n.klass.disabled),e.join(" ")}([n.klass.listItem]),"data-pick="+e.pick+" "+i.ariaAttr({role:"option",label:h,selected:!(!c||t.$node.val()!==h)||null,activedescendant:!!d||null,disabled:!!u||null})]}})+i.node("li",i.node("button",n.clear,n.klass.buttonClear,"type=button data-clear=1"+(e?"":" disabled")+" "+i.ariaAttr({controls:t.$node[0].id})),"",i.ariaAttr({role:"presentation"})),n.klass.list,i.ariaAttr({role:"listbox",controls:t.$node[0].id}))},n.defaults=function(e){return{clear:"Clear",format:"h:i A",interval:30,closeOnSelect:!0,closeOnClear:!0,updateInput:!0,klass:{picker:e+" "+e+"--time",holder:e+"__holder",list:e+"__list",listItem:e+"__list-item",disabled:e+"__list-item--disabled",selected:e+"__list-item--selected",highlighted:e+"__list-item--highlighted",viewset:e+"__list-item--viewset",now:e+"__list-item--now",buttonClear:e+"__button--clear"}}}(e.klasses().picker),e.extend("pickatime",n)}),define("mockup-patterns-pickadate",["jquery","pat-base","mockup-utils","translate","picker","picker.date","picker.time","mockup-patterns-select2"],function(e,t,n,i){"use strict";return t.extend({name:"pickadate",trigger:".pat-pickadate",parser:"mockup",defaults:{separator:" ",date:{selectYears:!0,selectMonths:!0,formatSubmit:"yyyy-mm-dd",format:"yyyy-mm-dd",labelMonthNext:i("Next month"),labelMonthPrev:i("Previous month"),labelMonthSelect:i("Select a month"),labelYearSelect:i("Select a year"),clear:!1,close:!1,today:!1},time:{clear:!1},today:i("Today"),clear:i("Clear"),timezone:null,autoSetTimeOnDateChange:"+[0,0]",classWrapperName:"pattern-pickadate-wrapper",classSeparatorName:"pattern-pickadate-separator",classDateName:"pattern-pickadate-date",classDateWrapperName:"pattern-pickadate-date-wrapper",classTimeName:"pattern-pickadate-time",classTimeWrapperName:"pattern-pickadate-time-wrapper",classTimezoneName:"pattern-pickadate-timezone",classTimezoneWrapperName:"pattern-pickadate-timezone-wrapper",classClearName:"pattern-pickadate-clear",classNowName:"pattern-pickadate-now",placeholderDate:i("Enter date..."),placeholderTime:i("Enter time..."),placeholderTimezone:i("Enter timezone...")},parseTimeOffset:function(e){var t=void 0;0===e.indexOf("+")?(t="+",e=e.split("+")[1]):0===e.indexOf("-")&&(t="-",e=e.split("-")[1]);try{e=JSON.parse(e)}catch(t){e=void 0}if(!1===e)return!1;if(!0===e||!0!==Array.isArray(e))return[0,0];var n=parseInt(e[0],10)||0,i=parseInt(e[1],10)||0;if("+"===t||"-"===t){var a=new Date,o=a.getHours(),r=a.getMinutes();"+"===t?((n=o+n)>23&&(n=23),(i=r+i)>59&&(i=59)):"-"===t&&((n=o-n)<0&&(n=0),(i=r-i)<0&&(i=0))}return[n,i]},init:function(){var t=this,i=t.$el.val().split(" "),a=i[0]||"",o=i[1]||"";if(!1===n.bool(t.options.date)&&(t.options.date=!1),!1===n.bool(t.options.time)&&(t.options.time=!1),t.options.autoSetTimeOnDateChange=t.parseTimeOffset(t.options.autoSetTimeOnDateChange),!1===t.options.date&&(o=i[0]),t.$el.hide(),t.$wrapper=e("<div/>").addClass(t.options.classWrapperName).insertAfter(t.$el),!1!==t.options.date&&(t.$date=e('<input type="text"/>').attr("placeholder",t.options.placeholderDate).attr("data-value",a).addClass(t.options.classDateName).appendTo(e("<div/>").addClass(t.options.classDateWrapperName).appendTo(t.$wrapper)).pickadate(e.extend(!0,{},t.options.date,{onSet:function(e){void 0!==e.select&&(t.$date.attr("data-value",e.select),!1!==t.options.autoSetTimeOnDateChange&&t.$time&&(t.$time.pickatime("picker").get("select")||t.$time.pickatime("picker").set("select",t.options.autoSetTimeOnDateChange)),!1!==t.options.time&&""===t.$time.attr("data-value")||t.updateValue.call(t)),e.hasOwnProperty("clear")&&(t.$el.val(""),t.$date.attr("data-value",""))}}))),!1!==t.options.time&&(t.options.time.formatSubmit="HH:i",t.$time=e('<input type="text"/>').attr("placeholder",t.options.placeholderTime).attr("data-value",o).addClass(t.options.classTimeName).appendTo(e("<div/>").addClass(t.options.classTimeWrapperName).appendTo(t.$wrapper)).pickatime(e.extend(!0,{},t.options.time,{onSet:function(e){void 0!==e.select&&(t.$time.attr("data-value",e.select),!1!==t.options.date&&""===t.$date.attr("data-value")||t.updateValue.call(t)),e.hasOwnProperty("clear")&&(t.$el.val(""),t.$time.attr("data-value",""))}})),"string"==typeof o&&"00"===o.substring(0,2)&&(t.$time.pickatime("picker").set("select",o.split(":")),t.$time.attr("data-value",o))),!1!==t.options.date&&!1!==t.options.time&&t.options.timezone&&(t.$separator=e("<span/>").addClass(t.options.classSeparatorName).html(" "===t.options.separator?"&nbsp;":t.options.separator).appendTo(t.$wrapper)),null!==t.options.timezone){t.$timezone=e('<input type="text"/>').addClass(t.options.classTimezoneName).appendTo(e("<div/>").addClass(t.options.classTimezoneWrapperName).appendTo(t.$wrapper)).patternSelect2(e.extend(!0,{placeholder:t.options.placeholderTimezone,width:"10em"},t.options.timezone,{multiple:!1})).on("change",function(e){void 0!==e.val&&(t.$timezone.attr("data-value",e.val),!1!==t.options.date&&""===t.$date.attr("data-value")||!1!==t.options.time&&""===t.$time.attr("data-value")||t.updateValue.call(t))});var r=t.options.timezone.default;if(r){var s;t.options.timezone.data.some(function(e){return s=e.text===t.options.timezone.default}),s&&(t.$timezone.attr("data-value",r),t.$timezone.parent().find(".select2-chosen").text(r))}1===t.options.timezone.data.length&&(t.$timezone.attr("data-value",t.options.timezone.data[0].text),t.$timezone.parent().find(".select2-chosen").text(t.options.timezone.data[0].text),t.$timezone.select2("enable",!1))}n.bool(t.options.today)&&(t.$now=e('<button type="button" class="btn btn-xs btn-info" title="'+t.options.today+'"><span class="glyphicon glyphicon-time"></span></button>').addClass(t.options.classNowName).on("click",function(e){e.preventDefault();var n=new Date;t.$date&&t.$date.data("pickadate").set("select",n),t.$time&&t.$time.data("pickatime").set("select",n),t.emit("updated")}).appendTo(t.$wrapper)),n.bool(t.options.clear)&&(t.$clear=e('<button type="button" class="btn btn-xs btn-danger" title="'+t.options.clear+'"><span class="glyphicon glyphicon-trash"></span></button>').addClass(t.options.classClearName).on("click",function(e){e.preventDefault(),t.$date&&t.$date.data("pickadate").clear(),t.$time&&t.$time.data("pickatime").clear(),t.emit("updated")}).appendTo(t.$wrapper))},updateValue:function(){var e=this,t="";if(!1!==e.options.date){var n=e.$date.data("pickadate").component,i=e.$date.data("pickadate").get("select"),a=n.formats.toString;i&&(t+=a.apply(n,[e.options.date.formatSubmit,i]))}if(!1!==e.options.date&&!1!==e.options.time&&(t+=" "),!1!==e.options.time){var o=e.$time.data("pickatime").component,r=e.$time.data("pickatime").get("select"),s=o.formats.toString;r&&(t+=s.apply(o,["HH:i",r]))}if(null!==e.options.timezone){var l=" "+e.$timezone.attr("data-value");l&&(t+=l)}e.$el.val(t),e.emit("updated")}})}),require(["mockup-patterns-inlinevalidation","mockup-patterns-recurrence","mockup-patterns-relateditems","mockup-patterns-pickadate","mockup-patterns-select2"],function(){"use strict"}),define("/Users/peter/workspace/buildout.coredev/src/plone.staticresources/src/plone/staticresources/static/plone-logged-in.js",function(){});
//# sourceMappingURL=plone-logged-in-compiled.min.js.map